% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/models.R
\name{precision_matrix_multivariate_spde}
\alias{precision_matrix_multivariate_spde}
\title{Compute the precision matrix for multivariate spde Matern model}
\usage{
precision_matrix_multivariate_spde(
  p,
  mesh,
  cor_mat,
  alpha = 2,
  theta_K_list = NULL,
  B_K_list = NULL,
  theta = NULL,
  Q = NULL
)
}
\arguments{
\item{p}{dimension, should be integer and greater than 1}

\item{mesh}{an inla.mesh.2d object, mesh for build the SPDE model}

\item{cor_mat}{matrix of dim p*p, controls the correlation (only look at upper.tri part)}

\item{alpha}{2 or 4, SPDE smoothness parameter}

\item{theta_K_list}{a list (length is p) of theta_K}

\item{B_K_list}{a list (length is p) of B_K (non-stationary case)}

\item{theta}{parameter for Q matrix (length of 1 when p=2, length of 3 when p=3)}

\item{Q}{orthogonal matrix of dim p*p (provide when p > 3)}
}
\value{
the precision matrix of the multivariate model
}
\description{
Compute the precision matrix for multivariate spde Matern model
}
\details{
The general model is defined as $D diag(L_1, ..., L_p) x = M$. D is the dependence matrix, it is paramterized by $D = Q(theta) * D_l(cor_mat)$, where $Q$ is the orthogonal matrix, and $D_l$ is matrix controls the cross-correlation.
See the section 2.2 of Bolin and Wallin (2020) for exact parameterization of Dependence matrix.
}
\examples{
rho_mat <- matrix(0, nrow = 3, ncol = 3)
rho_mat[1, 2] <- 0.4; rho_mat[1, 3] <- -0.5; rho_mat[2,3] <- 0.8
pl01 <- cbind(c(0, 1, 1, 0, 0) * 10, c(0, 0, 1, 1, 0) * 5)
mesh <- INLA::inla.mesh.2d(
  loc.domain = pl01, cutoff = 2,
  max.edge = c(0.5, 10)
)
precision_matrix_multivariate_spde(
  3,
  mesh = INLA::inla.mesh.1d(1:10),
  cor_mat = rho_mat,
  alpha = 2,
  theta_K_list = list(0,1,2),
  theta = c(1,2,3)
)
}
\references{
Bolin, D. and Wallin, J. (2020), Multivariate type G MatÃ©rn stochastic partial differential equation random fields. J. R. Stat. Soc. B, 82: 215-239. https://doi.org/10.1111/rssb.12351
}
