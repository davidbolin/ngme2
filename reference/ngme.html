<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Fit an additive linear mixed effect model over replicates — ngme • ngme2</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Fit an additive linear mixed effect model over replicates — ngme"><meta property="og:description" content="ngme function performs an analysis of non-gaussian additive models.
 It does the maximum likelihood estimation via stochastic gradient descent.
 The prediction of unknown location can be performed by leaving the response
 variable to be NA. The likelihood is specified by family.
The model estimation control can be setted in control using
 control_opt() function, see ?control_opt for details.
See ngme_model_types() for available models."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">ngme2</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.6.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../articles/ngme2.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Functions</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Vignettes
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/Installation_and_configuration.html">Installation and configuration</a>
    </li>
    <li>
      <a href="../articles/inla_compare.html">Comparison with R-INLA</a>
    </li>
    <li>
      <a href="../articles/AR1-model.html">AR(1) model</a>
    </li>
    <li>
      <a href="../articles/RW-model.html">Random walk model</a>
    </li>
    <li>
      <a href="../articles/SPDE-model.html">SPDE Matern model</a>
    </li>
    <li>
      <a href="../articles/replicate.html">Ngme replicate feature</a>
    </li>
    <li>
      <a href="../articles/pred_and_est.html">Model estimation and prediction</a>
    </li>
    <li>
      <a href="../articles/bivariate.html">Bivariate models in Ngme2</a>
    </li>
    <li>
      <a href="../articles/random-effect.html">Random effects model in Ngme2</a>
    </li>
    <li>
      <a href="../articles/tensor_product.html">Space-time (tensor product) model in Ngme2</a>
    </li>
    <li>
      <a href="../articles/matern-on-graph.html">Matern SPDE model on Metric Graph</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/davidbolin/ngme2" class="external-link">
    <span class="fa fa-github"></span>
     
  </a>
</li>
<li>
  <a href="https://twitter.com/jdavidbolin" class="external-link">
    <span class="fa fa-twitter"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Fit an additive linear mixed effect model over replicates</h1>
    <small class="dont-index">Source: <a href="https://github.com/davidbolin/ngme2/blob/HEAD/R/ngme.R" class="external-link"><code>R/ngme.R</code></a></small>
    <div class="hidden name"><code>ngme.Rd</code></div>
    </div>

    <div class="ref-description">
    <p><code>ngme</code> function performs an analysis of non-gaussian additive models.
 It does the maximum likelihood estimation via stochastic gradient descent.
 The prediction of unknown location can be performed by leaving the response
 variable to be <code>NA</code>. The likelihood is specified by <code>family</code>.
The model estimation control can be setted in <code>control</code> using
 <code><a href="control_opt.html">control_opt()</a></code> function, see <code><a href="control_opt.html">?control_opt</a></code> for details.
See <code><a href="ngme_model_types.html">ngme_model_types()</a></code> for available models.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">ngme</span><span class="op">(</span></span>
<span>  <span class="va">formula</span>,</span>
<span>  <span class="va">data</span>,</span>
<span>  family <span class="op">=</span> <span class="st">"normal"</span>,</span>
<span>  control_opt <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  control_ngme <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  group <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  replicate <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  start <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  debug <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>formula</dt>
<dd><p>formula</p></dd>


<dt>data</dt>
<dd><p>a dataframe or a list providing data
(Only response variable can contain <code>NA</code> value,
 <code>NA</code> value in other columns will cause problem)</p></dd>


<dt>family</dt>
<dd><p>likelihood type, same as measurement noise specification, 1. string 2. ngme noise obejct</p></dd>


<dt>control_opt</dt>
<dd><p>control for optimizer. by default it is <code><a href="control_opt.html">control_opt()</a></code>. See <code><a href="control_opt.html">?control_opt</a></code> for details.</p></dd>


<dt>control_ngme</dt>
<dd><p>control for ngme model. by default it is <code><a href="control_ngme.html">control_ngme()</a></code>. See <code><a href="control_ngme.html">?control_ngme</a></code> for details.</p></dd>


<dt>group</dt>
<dd><p>factor, used for bivariate model, indicating which group the observation belongs to</p></dd>


<dt>replicate</dt>
<dd><p>factor, used for divide data into different replicates</p></dd>


<dt>start</dt>
<dd><p>starting ngme object (usually object from last fit)</p></dd>


<dt>debug</dt>
<dd><p>toggle debug mode</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>random effects (for different replicate) + models(fixed effects, measuremnt noise, and latent process)</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu">ngme</span><span class="op">(</span></span></span>
<span class="r-in"><span> formula <span class="op">=</span> <span class="va">Y</span> <span class="op">~</span> <span class="va">x1</span> <span class="op">+</span> <span class="fu"><a href="f.html">f</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>   <span class="va">x2</span>,</span></span>
<span class="r-in"><span>   model <span class="op">=</span> <span class="st">"ar1"</span>,</span></span>
<span class="r-in"><span>   noise <span class="op">=</span> <span class="fu"><a href="ngme_noise.html">noise_nig</a></span><span class="op">(</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>   rho <span class="op">=</span> <span class="fl">0.5</span></span></span>
<span class="r-in"><span> <span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="f.html">f</a></span><span class="op">(</span><span class="va">x1</span>,</span></span>
<span class="r-in"><span>   model <span class="op">=</span> <span class="st">"rw1"</span>,</span></span>
<span class="r-in"><span>   noise <span class="op">=</span> <span class="fu"><a href="ngme_noise.html">noise_normal</a></span><span class="op">(</span><span class="op">)</span>,</span></span>
<span class="r-in"><span> <span class="op">)</span>,</span></span>
<span class="r-in"><span> family <span class="op">=</span> <span class="fu"><a href="ngme_noise.html">noise_normal</a></span><span class="op">(</span>sd <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span>,</span></span>
<span class="r-in"><span> data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>Y <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">5</span>, x1 <span class="op">=</span> <span class="fl">2</span><span class="op">:</span><span class="fl">6</span>, x2 <span class="op">=</span> <span class="fl">3</span><span class="op">:</span><span class="fl">7</span><span class="op">)</span>,</span></span>
<span class="r-in"><span> control_opt <span class="op">=</span> <span class="fu"><a href="control_opt.html">control_opt</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>   estimation <span class="op">=</span> <span class="cn">FALSE</span></span></span>
<span class="r-in"><span> <span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> *** Ngme object ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Fixed effects: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Intercept)          x1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          -1           1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Models: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $field1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Model type: AR(1)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       rho = 0.5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Noise type: NIG</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Noise parameters: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       mu = 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       sigma = 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       nu = 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $field2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Model type: Random walk (order 1)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       No parameter.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Noise type: NORMAL</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Noise parameters: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       sigma = 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Measurement noise: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Noise type: NORMAL</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Noise parameters: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       sigma = 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of replicates is  1 </span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by David Bolin, Xiaotian Jin, Alexandre Simas, Jonas Wallin.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

