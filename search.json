[{"path":"https://davidbolin.github.io/ngme2/articles/Installation_and_configuration.html","id":"install-a-openmp-supported-clang-as-default-cc-compiler-","dir":"Articles","previous_headings":"","what":"1. Install a OpenMP supported clang as default C/C++ compiler.","title":"Installation and configuration","text":"’s need install another compiler supports OpenMP. use homebrew installing llvm clang compiler using following scripts. (Check homebrew can just run following command install homebrew.) successful, able see following prompt. make llvm clang default compiler, need update PATH variable, reopen terminal make work: Now able use llvm clang OpenMP support. Let’s test : case, llvm lib include folder already added default clang search path. (can check search path run commands like clang hello.cpp -v, otherwise may need include mannually -L -, can also export system variable suggested, use makefile compile).","code":"/bin/bash -c \"$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/HEAD/install.sh)\" ➜ brew install llvm  ... To use the bundled libc++ please add the following LDFLAGS:   LDFLAGS=\"-L/usr/local/opt/llvm/lib/c++ -Wl,-rpath,/usr/local/opt/llvm/lib/c++\"  llvm is keg-only, which means it was not symlinked into /usr/local, because macOS already provides this software and installing another version in parallel can cause all kinds of trouble.  If you need to have llvm first in your PATH, run:   echo 'export PATH=\"/usr/local/opt/llvm/bin:$PATH\"' >> ~/.zshrc  For compilers to find llvm you may need to set:   export LDFLAGS=\"-L/usr/local/opt/llvm/lib\"   export CPPFLAGS=\"-I/usr/local/opt/llvm/include\" ➜ echo 'export PATH=\"/usr/local/opt/llvm/bin:$PATH\"' >> ~/.zshrc ➜ clang -fopenmp hello.cpp"},{"path":"https://davidbolin.github.io/ngme2/articles/Installation_and_configuration.html","id":"configure-the-r-environment-to-make-use-of-the-new-compiler-","dir":"Articles","previous_headings":"","what":"2. Configure the R environment to make use of the new compiler.","title":"Installation and configuration","text":"Next want use OpenMP R code (maybe exported R function using Rcpp package), make sure R call new compiler, original one. , can mannually set Makeconf file (makefile configuration R) $R_HOME/etc/Makeconf. can check R_HOME address using R.home() R termnial. case, R called compiler still default clang, explicitly replace . Replace configuration lines following (llvm clang installed): Now able export OpenMP function R using Rcpp.","code":"R.home() ## [1] \"/Library/Frameworks/R.framework/Resources\" CC = /usr/local/opt/llvm/bin/clang CXX = /usr/local/opt/llvm/bin/clang++ CXX11 = $(CXX) CXX14 = $(CXX) CXX17 = $(CXX) CXX20 = $(CXX)"},{"path":"https://davidbolin.github.io/ngme2/articles/Installation_and_configuration.html","id":"configure-the-r-package-environment-","dir":"Articles","previous_headings":"","what":"3. Configure the R package environment.","title":"Installation and configuration","text":"developing R package using Rcpp, still need make efforts R package environment. Set OpenMP flags R Makeconf directly setting -fopenmp flag Makevar file, portable system OpenMP support. ’s better include R Makeconf file. can find following two flags Makeconf file. Set package flags package Makevar Next can include flag Makevar following: Set symbols package Namespace One important thing next indicate useDynLib(yourPackage) Namespace. can either , using devtools package . Edit NAMESPACE file create R objects registered symbols: add #' @useDynLib yourPackage, .registration = TRUE yourPackage.R file, run able see update NAMESPACE file. Now can OpenMP facility C++ code!","code":"SHLIB_OPENMP_CFLAGS = -fopenmp SHLIB_OPENMP_CXXFLAGS = -fopenmp PKG_CXXFLAGS = $(SHLIB_OPENMP_CXXFLAGS) PKG_LIBS = $(SHLIB_OPENMP_CXXFLAGS) useDynLib(yourPackage, .registration = TRUE) devtools::document()"},{"path":"https://davidbolin.github.io/ngme2/articles/ngme2.html","id":"introduction","dir":"Articles","previous_headings":"","what":"Introduction","title":"Ngme2 - A new Flexible R Package for Latent non-Gaussian Models","text":"vignette provide brief introduction ngme2 package. ngme2 updated version ngme (https://github.com/davidbolin/ngme), package estimating latent non-Gaussian models. follows 3-layer structure design (general block model, latent process models, noises) specifying whole statistical model. latent process defines different operator structure, block model collects together fixed effects measurement noise.","code":""},{"path":"https://davidbolin.github.io/ngme2/articles/ngme2.html","id":"features","dir":"Articles","previous_headings":"Introduction","what":"1 Features","title":"Ngme2 - A new Flexible R Package for Latent non-Gaussian Models","text":"Support spatial models like Matern model non-Gaussian noise. Support models temporal data like AR1 random walk order 1 2. Support replicates locations. Support prediction unknown locations. Comparing previous version, now supports multiple stochastic processes latent model.","code":""},{"path":"https://davidbolin.github.io/ngme2/articles/ngme2.html","id":"model-framework","dir":"Articles","previous_headings":"Introduction","what":"2 Model Framework","title":"Ngme2 - A new Flexible R Package for Latent non-Gaussian Models","text":"package ngme2 provides methods mixed effect models single response variable case multivariate response case (yet). 1.single response case, following form: \\[ \\begin{aligned} Y = {\\bf X}^{\\top} {\\bf \\beta} + \\sum_j {\\bf }_j W_j({\\bf t}) + \\epsilon. \\end{aligned} \\] , \\(Y\\) response variable, \\({\\bf X}\\) matrix fixed effects explanatory variables, \\({\\bf \\beta}\\) matrix fixed effects coefficients, \\({\\bf }_j\\) observation matrix process, \\(W_j(t_j)\\) specified stochastic process, \\(\\epsilon\\) measurement error. , process \\(W\\) follows \\({\\bf K} W = z\\), \\(z\\) either Gaussian non-Gaussian noise. \\({\\bf K}\\) operator matrix. simple template using core function ngme model single response: , function f modeling stochastic process W Gaussian non-Gaussian noise, discuss later. noise stands measurement noise distribution. case, model Gaussian likelihood. multivariate response case, following form: another template using core function ngme model bivariate response:","code":"ngme(   formula=Y ~ x1 + x2 + f(index, model=\"ar\", noise=\"nig\"),   data=data.frame(Y=Y, x1=x1, x2=x2, index=index),   noise = noise_normal() ) ngme(   formula=Y1 | Y2 ~ x1 + x2 + f(index, model=\"ar\", noise=\"nig\") | f(time, model=\"matern\"),   data=data.frame(Y=Y, x1=x1, x2=x2, index=index, time=time),   family=\"normal\" )"},{"path":"https://davidbolin.github.io/ngme2/articles/ngme2.html","id":"non-gaussian-model","dir":"Articles","previous_headings":"Introduction","what":"3 Non-Gaussian Model","title":"Ngme2 - A new Flexible R Package for Latent non-Gaussian Models","text":"assume non-Gaussian process type-G Lévy process, whose increments can represented location-scale mixtures: \\[\\gamma + \\mu V + \\sigma \\sqrt{V}Z,\\] \\(\\gamma, \\mu, \\sigma\\) parameters, \\(Z\\sim N(0,1)\\) independent \\(V\\), \\(V\\) positive infinitely divisible random variable. results following form, \\(K\\) operator part: \\[ KW|V \\sim N(\\gamma + \\mu V, \\sigma^2 \\, diag(V)), \\] also, \\(\\mu\\) \\(\\sigma\\) can non-stationary. Ngme2, focus mainly normal inverse Gaussian (NIG) model.","code":""},{"path":"https://davidbolin.github.io/ngme2/articles/ngme2.html","id":"the-nig-model","dir":"Articles","previous_headings":"Introduction > 3 Non-Gaussian Model","what":"The NIG model","title":"Ngme2 - A new Flexible R Package for Latent non-Gaussian Models","text":"First, say random variable \\(V\\) follows inverse Gaussian distribution parameters \\(\\eta_1\\) \\(\\eta_2\\), denoted \\(V\\sim IG(\\eta_1,\\eta_2)\\) pdf given \\[\\pi(v) = \\frac{\\sqrt{\\eta_2}}{\\sqrt{2\\pi v^3}} \\exp\\left\\{-\\frac{\\eta_1}{2}v - \\frac{\\eta_2}{2v} + \\sqrt{\\eta_1\\eta_2}\\right\\},\\quad \\eta_1,\\eta_2>0.\\] can generate samples inverse Gaussian distributions parameters \\(\\eta_1\\) \\(\\eta_2\\) generating samples generalized inverse Gaussian distribution parameters \\(p=-1/2\\), \\(=\\eta_1\\) \\(b=\\eta_2\\). can use rGIG function generate samples generalized inverse Gaussian distribution. \\(V\\sim IG(\\eta_1,\\eta_2)\\), \\(X = \\gamma +\\mu V + \\sigma \\sqrt{V}Z\\), \\(Z\\sim N(0,1)\\), independent \\(V\\), \\(X\\) follows normal inverse Gaussian (NIG) distribution pdf \\[\\pi(x) = \\frac{e^{\\sqrt{\\eta_1\\eta_2}+\\mu(x-\\gamma)/\\sigma^2}\\sqrt{\\eta_2\\mu^2/\\sigma^2+\\eta_1\\eta_2}}{\\pi\\sqrt{\\eta_2\\sigma^2+(x-\\gamma)^2}} K_1\\left(\\sqrt{(\\eta_2\\sigma^2+(x-\\gamma)^2)(\\mu^2/\\sigma^4+\\eta_1/\\sigma^2)}\\right),\\] \\(K_1\\) modified Bessel function third kind. form, NIG density overparameterized, therefore set \\(\\eta_1=\\eta_2=\\eta\\), results \\(E(V)=1\\). Thus, one parameters, \\(\\mu, \\gamma\\) \\(\\eta\\). NIG model thus assumes stochastic variance \\(V_i\\) follows inverse Gaussian parameters \\(\\eta\\) \\(\\eta h_i^2\\), \\(h_i = \\int_{\\mathcal{D}} \\varphi_i(\\mathbf{s}) d\\mathbf{s}.\\) , see plot densities NIG distribution several choices parameters (fix \\(\\gamma=0\\) \\(\\eta=1\\)):","code":""},{"path":"https://davidbolin.github.io/ngme2/articles/ngme2.html","id":"parameter-estimation","dir":"Articles","previous_headings":"Introduction","what":"4 Parameter Estimation","title":"Ngme2 - A new Flexible R Package for Latent non-Gaussian Models","text":"Ngme2 maximum likelihood estimation preconditioned stochastic gradient descent. Multiple chains run parallel better convergence checks.","code":""},{"path":[]},{"path":"https://davidbolin.github.io/ngme2/articles/ngme2.html","id":"specify-noise-with-ngme_noise-object","dir":"Articles","previous_headings":"Ngme Model Structure - 3-Layer structure","what":"Specify noise with ngme_noise object","title":"Ngme2 - A new Flexible R Package for Latent non-Gaussian Models","text":"ngme_noise object fundamental structure ngme2. object used specify driving noise stochastic process measurement noise. now support two noises, one normal noise, NIG noise. R class ngme_noise following interface: 3rd example non-stationary NIG noise, \\(\\mu = \\bf B_{\\mu} \\bf \\theta_{\\mu}\\), \\(\\sigma = \\exp(\\bf B_{\\sigma} \\bf \\theta_{\\sigma})\\). construct following noise structure: \\[   - \\mathbf{\\mu} + \\mathbf{\\mu} V + \\mathbf{\\sigma} \\sqrt{V} Z \\] \\(\\mu = \\bf B_{\\mu} \\bf \\theta_{\\mu}\\), \\(\\sigma = \\exp(\\bf B_{\\sigma} \\bf \\theta_{\\sigma})\\). case, can recover gaussian noise setting type=“normal ignoring theta_mu theta_V. can simply use helper function noise_normal(sd=1)","code":"library(ngme2)  noise_normal(sd = 1)                 # normal noise #> Noise type - normal #> Noise parameters:  #>     sigma = 1 noise_nig(mu = 1, sigma = 2, nu = 1) # nig noise #> Noise type - nig #> Noise parameters:  #>     mu = 1 #>     sigma = 2 #>     nu = 1 noise_nig(            # non-stationary nig noise   B_mu=matrix(c(1:10), ncol=2),   theta_mu = c(1, 2),   B_sigma=matrix(c(1:10), ncol=2),   theta_sigma = c(1,2),   nu = 1) #> Noise type - nig #> Noise parameters:  #>     theta_mu = 1, 2 #>     theta_sigma = 1, 2 #>     nu = 1 ngme_noise(   type,           # the type of noise   theta_mu,       # mu parameter   theta_sigma,    # sigma parameter   theta_V,        # nu parameter   B_mu,           # basis matrix for non-stationary mu   B_sigma         # basis matrix for non-stationary sigma )"},{"path":"https://davidbolin.github.io/ngme2/articles/ngme2.html","id":"specify-stochastic-process-with-f-function","dir":"Articles","previous_headings":"Ngme Model Structure - 3-Layer structure","what":"Specify stochastic process with f function","title":"Ngme2 - A new Flexible R Package for Latent non-Gaussian Models","text":"middle layer stochastic process, R interface, represented f function. process can specified different noise structure. examples using f function specify ngme_model:","code":"f(index = 1:10, model = \"ar1\",   noise = noise_nig(), theta_K = 0.5) #> as(<dgTMatrix>, \"dgCMatrix\") is deprecated since Matrix 1.5-0; do as(., \"CsparseMatrix\") instead #> Ngme model: ar1 #> Model parameters:  #>     alpha = 0.5 #>  #> Noise type - nig #> Noise parameters:  #>     mu = 0 #>     sigma = 1 #>     nu = 1"},{"path":"https://davidbolin.github.io/ngme2/articles/ngme2.html","id":"specify-latent-model-with-formula-in-ngme","dir":"Articles","previous_headings":"Ngme Model Structure - 3-Layer structure","what":"Specify latent model with formula in ngme","title":"Ngme2 - A new Flexible R Package for Latent non-Gaussian Models","text":"latent model can specified additively formula argument ngme function together fixed effects. can specified following: gives ngme object, three parts: Fixed effects (intercept x1) Measurement noise (normal noise) Latent models (contains 2 models, ar1 rw1) can turn estimation = TRUE start estimating model.","code":"ngme(   formula = Y ~ x1 + f(     index = x2,     model = \"ar1\",     noise = noise_nig(),     theta_K = 0.5   ) + f(     model = model_rw(1:5, order=1, circular = TRUE),     noise = noise_normal(),   ),   family = noise_normal(sd = 0.5),   data = data.frame(Y = 1:5, x1 = 2:6, x2 = 3:7),   control = ngme_control(     estimation = FALSE   ) ) #> *** Ngme object *** #>  #> Fixed effects:  #>    beta = -1,  1 #>  #> Measurement noise:  #>   Noise type - normal #>   Noise parameters:  #>       sigma = 0.5 #>  #>  #> Latent models:  #> [[1]] #>   Ngme model: ar1 #>   Model parameters:  #>       alpha = 0.5 #>  #>   Noise type - nig #>   Noise parameters:  #>       mu = 0 #>       sigma = 1 #>       nu = 1 #> [[2]] #>   Ngme model: rw1 #>   Model parameters:  #>       No parameter needed. #>  #>   Noise type - normal #>   Noise parameters:  #>       sigma = 1"},{"path":"https://davidbolin.github.io/ngme2/articles/ngme2.html","id":"the-spde-approach-with-gaussian-noise","dir":"Articles","previous_headings":"","what":"The SPDE approach with Gaussian noise","title":"Ngme2 - A new Flexible R Package for Latent non-Gaussian Models","text":"well-known (Whittle, 1963) Gaussian process \\(u(\\mathbf{s})\\) Matérn covariance function solves stochastic partial differential equation (SPDE) \\[\\begin{equation}\\label{spde} (\\kappa^2 -\\Delta)^\\beta u = \\mathcal{W}\\quad \\hbox{} \\mathcal{D}, \\end{equation}\\] \\(\\Delta = \\sum_{=1}^d \\frac{\\partial^2}{\\partial_{x_i^2}}\\) Laplacian operator, \\(\\mathcal{W}\\) Gaussian spatial white noise \\(\\mathcal{D}=\\mathbb{R}^d\\), \\(4\\beta = 2\\nu + d\\). Inspired relation Gaussian processes Matérn covariance functions solutions SPDE, Lindgren et al. (2011) constructed computationally efficient Gaussian Markov random field approximations \\(u(\\mathbf{s})\\), domain \\(\\mathcal{D}\\subsetneq \\mathbb{R}^d\\) bounded \\(2\\beta\\\\mathbb{N}\\). motivation handling non-Gaussian noise comes fact many features handled Gaussian noise. reasons : Skewness; Heavier tails; Jumps sample paths; Asymmetries sample paths.","code":""},{"path":"https://davidbolin.github.io/ngme2/articles/ngme2.html","id":"non-gaussian-matérn-fields","dir":"Articles","previous_headings":"The SPDE approach with Gaussian noise","what":"Non-Gaussian Matérn fields","title":"Ngme2 - A new Flexible R Package for Latent non-Gaussian Models","text":"idea replace Gaussian white noise \\(\\mathcal{W}\\) SPDE non-Gaussian white noise \\(\\dot{\\mathcal{M}}\\): \\[(\\kappa^2 - \\Delta)^\\beta u = \\dot{\\mathcal{M}}.\\] solution \\(u\\) Matérn covariance function, marginal distributions non-Gaussian. want apply idea non-Gaussian case, .e., want consider SPDE bounded domain \\(\\mathcal{D}\\subset\\mathbb{R}^d\\) apply finite element method. Notice left-hand side equation change. Therefore, take care right-hand side. consider setup. precisely, consider \\(V_n = {\\rm span}\\{\\varphi_1,\\ldots,\\varphi_n\\}\\), \\(\\varphi_i(\\mathbf{s}), =1,\\ldots, n\\) piecewise linear basis functions obtained triangulation \\(\\mathcal{D}\\) approximate solution \\(u\\) \\(u_n\\), \\(u_n\\) written terms basis functions \\[u_n(\\mathbf{s}) = \\sum_{=1}^n w_i \\varphi_i(\\mathbf{s}).\\] right-hand side obtain random vector \\[\\mathbf{f} = (\\dot{\\mathcal{M}}(\\varphi_1),\\ldots, \\dot{\\mathcal{M}}(\\varphi_n)),\\] functional \\(\\dot{\\mathcal{M}}\\) given \\[\\dot{\\mathcal{M}}(\\varphi_j) = \\int_{\\mathcal{D}} \\varphi_j(\\mathbf{s}) d\\mathcal{M}(\\mathbf{s}).\\] considering \\(\\mathcal{M}\\) type-G Lévy process, obtain \\(\\mathbf{f}\\) joint distribution easy handle. say Lévy process type G increments can represented location-scale mixtures: \\[\\gamma + \\mu V + \\sigma \\sqrt{V}Z,\\] \\(\\gamma, \\mu\\) parameters, \\(Z\\sim N(0,1)\\) independent \\(V\\), \\(V\\) positive infinitely divisible random variable. Therefore, given vector \\(\\mathbf{V} = (V_1,\\ldots,V_n)\\) independent stochastic variances (case, positive infinitely divisible random variables), obtain \\[\\mathbf{f}|\\mathbf{V} \\sim N(\\gamma + \\mu\\mathbf{V}, \\sigma^2{\\rm diag}(\\mathbf{V})).\\] , consider, instance, non-fractional non-Gaussian SPDE \\[(\\kappa^2 - \\Delta) u = \\dot{\\mathcal{M}},\\] obtain FEM weights \\(\\mathbf{w} = (w_1,\\ldots,w_n)\\) satisfy \\[\\mathbf{w}|\\mathbf{V} \\sim N(\\mathbf{K}^{-1}(\\gamma+\\mu\\mathbf{V}), \\sigma^2\\mathbf{K}^{-1}{\\rm diag}(\\mathbf{V})\\mathbf{K}^{-1}),\\] \\(\\mathbf{K} = \\kappa^2\\mathbf{C}+\\mathbf{G}\\) discretization differential operator.","code":""},{"path":"https://davidbolin.github.io/ngme2/articles/ngme2.html","id":"computational-advantages-of-the-spde-approach","dir":"Articles","previous_headings":"The SPDE approach with Gaussian noise","what":"Computational advantages of the SPDE approach","title":"Ngme2 - A new Flexible R Package for Latent non-Gaussian Models","text":"spatial problems, computational cost usually scales \\(\\mathcal{O}(n^{3/2})\\), \\(n\\) number basis functions. compared \\(\\mathcal{O}(N^3)\\) Gaussian random field approach. implies accurate approximations drastically reduces computational cost sampling inference.","code":""},{"path":"https://davidbolin.github.io/ngme2/articles/ngme2.html","id":"a-simple-example---ar1-process-with-nig-noise","dir":"Articles","previous_headings":"","what":"A simple example - AR1 process with nig noise","title":"Ngme2 - A new Flexible R Package for Latent non-Gaussian Models","text":"Now let’s see example AR1 process nig noise. process defined \\[ W_i = \\alpha W_{-1} + \\epsilon_i, \\] , \\(\\epsilon_1, ..,\\epsilon_n\\) iid NIG noise. , easy verify \\[ K{\\bf W} = \\boldsymbol\\epsilon,\\] \\[ K =   \\begin{bmatrix}     \\alpha \\\\     -1 &  \\alpha \\\\     & \\ddots & \\ddots \\\\     & & -1 &  \\alpha   \\end{bmatrix} \\] Now let’s fit model using ngme. can use ngme_control modify control variables ngme. See ?ngme_control optioins. Next can read result directly object. can see, model converges 350 iterations. estimation results close real parameter. can also use traceplot function see estimation traceplot. Parameters AR1 model can also density comparison estimated noise true NIG noise:","code":"n_obs <- 500 sigma_eps <- 0.5 alpha <- 0.5 mu = 2; delta = -mu sigma <- 3 nu <- 1  # First we generate V. V_i follows inverse Gaussian distribution trueV <- ngme2::rig(n_obs, nu, nu, seed = 10)  # Then generate the nig noise noise <- delta + mu*trueV + sigma * sqrt(trueV) * rnorm(n_obs) trueW <- Reduce(function(x,y){y + alpha*x}, noise, accumulate = T) Y = trueW + rnorm(n_obs, mean=0, sd=sigma_eps)  # Add some fixed effects x1 = runif(n_obs) x2 = rexp(n_obs) beta <- c(-3, -1, 2) X <- (model.matrix(Y ~ x1 + x2))  # design matrix Y = as.numeric(Y + X %*% beta) # # Fit the model with the AR1 model ngme_out <- ngme(   Y ~ x1 + x2 + f(     1:n_obs,     model = \"ar1\",     noise = noise_nig(),     theta_K = 0.9  # starting point for the alpha (parameter of K)   ),   data=data.frame(x1=x1, x2=x2, Y=Y),   control = ngme_control(     burnin = 100,     iterations = 1000,     std_lim = 0.4,     gibbs_sample = 5,     n_parallel_chain = 4,     stop_points = 10,     print_check_info = FALSE   ),   seed = 3 ) #> Starting estimation...  #> Total time is (ms): 3965 #> Estimation done! ngme_out #> *** Ngme object *** #>  #> Fixed effects:  #>    beta = -2.91, -1.44,  1.99 #>  #> Measurement noise:  #>   Noise type - normal #>   Noise parameters:  #>       sigma = 0.788 #>  #>  #> Latent models:  #> [[1]] #>   Ngme model: ar1 #>   Model parameters:  #>       alpha = 0.564 #>  #>   Noise type - nig #>   Noise parameters:  #>       mu = 1.86 #>       sigma = 2.82 #>       nu = 0.831 library(ggplot2) library(grid) library(gridExtra) pl <- lapply(c(\"alpha\", \"mu\", \"sigma\", \"nu\"), function(.x)   traceplot(ngme_out, parameter = .x, f_index = 1)); marrangeGrob(pl, nrow=2, ncol=2) plot(   ngme_out$latents[[1]]$noise,   noise_nig(mu = mu, sigma = sigma, nu = nu) )"},{"path":"https://davidbolin.github.io/ngme2/articles/ngme2.html","id":"paraná-dataset","dir":"Articles","previous_headings":"","what":"Paraná dataset","title":"Ngme2 - A new Flexible R Package for Latent non-Gaussian Models","text":"rainfall data Paraná (Brazil) collected National Water Agency Brazil (Agencia Nacional de Águas, ANA, Portuguese). ANA collects data many locations Brazil, data freely available ANA website (http://www3.ana.gov.br/portal/ANA). briefly illustrate command use, result estimation. Plot data: Mean rainfall Octobor 2012 Paraná  Model estimation: Estimations model Result optimization trajectory parameters Matern model: Traceplot Matern parameters","code":"library(INLA) #> Loading required package: Matrix #> Loading required package: foreach #> Loading required package: parallel #> Loading required package: sp #> This is INLA_22.11.08 built 2022-11-08 17:53:54 UTC. #>  - See www.r-inla.org/contact-us for how to get help. #>  - To enable PARDISO sparse library; see inla.pardiso() #>  #> Attaching package: 'INLA' #> The following object is masked from 'package:ngme2': #>  #>     f library(splancs) #>  #> Spatial Point Pattern Analysis Code in S-Plus #>   #>  Version 2 - Spatial and Space-Time analysis library(lattice) data(PRprec) data(PRborder)  # Create INLA mesh coords <- as.matrix(PRprec[, 1:2]) prdomain <- inla.nonconvex.hull(coords, -0.03, -0.05, resolution = c(100, 100)) prmesh <- inla.mesh.2d(boundary = prdomain, max.edge = c(0.45, 1), cutoff = 0.2)  # monthly mean at each location Y <- rowMeans(PRprec[, 12 + 1:31]) # 2 + Octobor  ind <- !is.na(Y) # non-NA index Y <- Y_mean <- Y[ind] coords <- as.matrix(PRprec[ind, 1:2]) seaDist <- apply(spDists(coords, PRborder[1034:1078, ],   longlat = TRUE ), 1, min) # leave 0.1 Y as prediction area n <- length(Y) ind_pred <- sample(1:n, size = 0.1 * n)  Y_pred <- Y[ind_pred] Y[ind_pred] <- NA  mesh.index <- inla.spde.make.index(   name = \"field\",   mesh = prmesh,   n.spde = prmesh$n )  matern_spde <- model_matern(   loc = coords,   mesh = prmesh,   index_NA = is.na(Y) )  out <- ngme(   formula = Y ~ 1 +     f(inla.group(seaDist), model = \"rw1\", noise = noise_normal()) +     f(model = matern_spde, noise = noise_nig()) +     f(model = matern_spde, noise = noise_normal()),   data = list(     Y = Y   ),   family = noise_nig(),   control = ngme_control(     estimation = T,     iterations = 1000,     n_slope_check = 4,     stop_points = 10,     std_lim = 0.1,     n_parallel_chain = 8,     print_check_info = TRUE   ),   seed = 416 ) #> Starting estimation...  #> begin Constructor of Matern  #> finish Constructor of Matern  #> begin Constructor of Matern  #> finish Constructor of Matern  #> Total time is (ms): 33850 #> Estimation done!  out #> *** Ngme object *** #>  #> Fixed effects:  #>    beta = 9.2 #>  #> Measurement noise:  #>   Noise type - nig #>   Noise parameters:  #>       mu = 0.462 #>       sigma = 2.07 #>       nu = 2.04 #>  #>  #> Latent models:  #> [[1]] #>   Ngme model: rw1 #>   Model parameters:  #>       No parameter needed. #>  #>   Noise type - normal #>   Noise parameters:  #>       sigma = 0.24 #> [[2]] #>   Ngme model: matern #>   Model parameters:  #>       kappa = 3.75 #>  #>   Noise type - nig #>   Noise parameters:  #>       mu = 3.55 #>       sigma = 9.1 #>       nu = 0.171 #> [[3]] #>   Ngme model: matern #>   Model parameters:  #>       kappa = 4.27 #>  #>   Noise type - normal #>   Noise parameters:  #>       sigma = 0.567 # Comparing our prediction lp <- attr(out, \"prediction\")$lp # Compute mean absolute error (MAE) mean(abs(lp - Y_mean)) #> [1] 1.577088 ggplot() + geom_point(aes(   x = coords[, 1], y = coords[, 2],   colour =  Y_mean - lp ), size = 2, alpha = 1) + scale_color_gradientn(colours = tim.colors(100)) + geom_path(aes(x = PRborder[, 1], y = PRborder[, 2])) + geom_path(aes(x = PRborder[1034:1078, 1], y = PRborder[   1034:1078,   2 ]), colour = \"red\")"},{"path":[]},{"path":"https://davidbolin.github.io/ngme2/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"David Bolin. Maintainer.","code":""},{"path":"https://davidbolin.github.io/ngme2/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"c), person), person)) (2022). ngme2: Latent Mixed Effects Models Flexible Distributions. R package version 0.1.0, https://davidbolin.github.io/ngme2/.","code":"@Manual{,   title = {ngme2: Latent Mixed Effects Models With Flexible Distributions},   author = {{c)} and {person)} and {person))}},   year = {2022},   note = {R package version 0.1.0},   url = {https://davidbolin.github.io/ngme2/}, }"},{"path":"https://davidbolin.github.io/ngme2/index.html","id":"the-ngme2-package","dir":"","previous_headings":"","what":"Latent Mixed Effects Models With Flexible Distributions","title":"Latent Mixed Effects Models With Flexible Distributions","text":"ngme2 R package used fitting non-gaussian mixed effects models. models fitted efficient manner. Basic statistical operations likelihood evaluations kriging predictions also implemented.","code":""},{"path":"https://davidbolin.github.io/ngme2/index.html","id":"installation-instructions","dir":"","previous_headings":"","what":"Installation instructions","title":"Latent Mixed Effects Models With Flexible Distributions","text":"development version can installed using command See also Installation Configuration vignette.","code":"remotes::install_github(\"davidbolin/ngme2\", ref = \"devel\")"},{"path":"https://davidbolin.github.io/ngme2/reference/argo_float.html","id":null,"dir":"Reference","previous_headings":"","what":"Argo float dataset — argo_float","title":"Argo float dataset — argo_float","text":"Argo floats measurements.","code":""},{"path":"https://davidbolin.github.io/ngme2/reference/argo_float.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Argo float dataset — argo_float","text":"","code":"data(\"argo_float\")"},{"path":"https://davidbolin.github.io/ngme2/reference/argo_float.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Argo float dataset — argo_float","text":"Data frame containing 274 observations 4 variables. lat Latitude. lon Longitude. sal Salinity. temp Temperature.","code":""},{"path":"https://davidbolin.github.io/ngme2/reference/argo_float.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Argo float dataset — argo_float","text":"Data can obtained Argo float website.","code":""},{"path":"https://davidbolin.github.io/ngme2/reference/argo_float.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Argo float dataset — argo_float","text":"floats pressure case made aluminium 1.3m long 20cm diameter. weigh 40kg. top antenna communicate satellites fix float's position receive data. Also top temperature, salinity pressure sensors.","code":""},{"path":"https://davidbolin.github.io/ngme2/reference/create_noise.html","id":null,"dir":"Reference","previous_headings":"","what":"Create ngme noise with a list — create_noise","title":"Create ngme noise with a list — create_noise","text":"Create ngme noise list","code":""},{"path":"https://davidbolin.github.io/ngme2/reference/create_noise.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create ngme noise with a list — create_noise","text":"","code":"create_noise(x)"},{"path":"https://davidbolin.github.io/ngme2/reference/create_noise.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Create ngme noise with a list — create_noise","text":"x list","code":""},{"path":"https://davidbolin.github.io/ngme2/reference/create_noise.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Create ngme noise with a list — create_noise","text":"list specification ngme","code":""},{"path":"https://davidbolin.github.io/ngme2/reference/f.html","id":null,"dir":"Reference","previous_headings":"","what":"Specifying a latent process model (wrapper function for each model) — f","title":"Specifying a latent process model (wrapper function for each model) — f","text":"Function used defining smooth spatial terms within ngme model formulae. function wrapper function specific submodels. (see ngme_models_types() available models).","code":""},{"path":"https://davidbolin.github.io/ngme2/reference/f.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Specifying a latent process model (wrapper function for each model) — f","text":"","code":"f(   index = NULL,   model = \"ar1\",   replicates = NULL,   noise = noise_normal(),   control = ngme_control_f(),   data = NULL,   A = NULL,   A_pred = NULL,   theta_K = NULL,   W = NULL,   fix_W = NULL,   fix_theta_K = NULL,   index_pred = NULL,   debug = NULL,   index_NA = NULL,   ... )"},{"path":"https://davidbolin.github.io/ngme2/reference/f.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Specifying a latent process model (wrapper function for each model) — f","text":"index symbol numerical value: index covariates build index model 1. string: type model, 2. ngme.spde object replicates Representing replicates noise 1. string: type model, 2. ngme.noise object (can also specified ngme model) control control variables f model data specifed inherit ngme formula Matrix connecting observation mesh A_pred Matrix connecting NA location mesh theta_K Unbounded parameter K W starting value process fix_W stop sampling W fix_theta_K fix estimation theta_K. index_pred index prediction debug Debug mode index_NA Logical vector, .na(response var.) ... additional arguments inherit data ngme function","code":""},{"path":"https://davidbolin.github.io/ngme2/reference/f.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Specifying a latent process model (wrapper function for each model) — f","text":"list latent_in constructing latent model, e.g. , h, C, G, also 1. Information K matrix 2. Information noise 3. Control variables","code":""},{"path":"https://davidbolin.github.io/ngme2/reference/gig.html","id":null,"dir":"Reference","previous_headings":"","what":"The Generalised Inverse-Gaussian (GIG) Distribution — gig","title":"The Generalised Inverse-Gaussian (GIG) Distribution — gig","text":"Density, distribution function, quantile function random generation generalised inverse-Gaussian distribution  parameters p, b.","code":""},{"path":"https://davidbolin.github.io/ngme2/reference/gig.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"The Generalised Inverse-Gaussian (GIG) Distribution — gig","text":"","code":"dgig(x, p, a, b, log = FALSE)  rgig(n, p, a, b, seed = 0)  pgig(q, p, a, b, lower.tail = TRUE, log.p = FALSE)  qgig(prob, p, a, b, lower.tail = TRUE, log.p = FALSE)"},{"path":"https://davidbolin.github.io/ngme2/reference/gig.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"The Generalised Inverse-Gaussian (GIG) Distribution — gig","text":"x, q vector quantiles. p parameter p. , b parameters b. Must positive. log, log.p logical; TRUE, probabilities/densities \\(p\\) returned \\(log(p)\\). n, number observations. seed Seed random generation. lower.tail logical; TRUE, probabilities \\(P[X\\leq x]\\), otherwise, \\(P[X>x]\\). prob vector probabilities.","code":""},{"path":"https://davidbolin.github.io/ngme2/reference/gig.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"The Generalised Inverse-Gaussian (GIG) Distribution — gig","text":"dgig gives density, pgig gives distribution function, qgig gives quantile function, rgig generates random deviates. Invalid arguments result return value NaN, warning. length result determined n rgig.","code":""},{"path":"https://davidbolin.github.io/ngme2/reference/gig.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"The Generalised Inverse-Gaussian (GIG) Distribution — gig","text":"generalised inverse-Gaussian distribution density given  $$f(x; p, , b) = ((/b)^{p/2})/(2K_p(\\sqrt{ab})) x^{p-1} \\exp\\{-(/2)x - (b/2)/x\\},$$  \\(K_p\\) modified Bessel function second kind order \\(p\\),  \\(x>0\\), \\(,b>0\\) \\(p\\\\mathbb{R}\\).  See Jørgensen (1982) details.","code":""},{"path":"https://davidbolin.github.io/ngme2/reference/gig.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"The Generalised Inverse-Gaussian (GIG) Distribution — gig","text":"Jørgensen, Bent (1982). Statistical Properties Generalized Inverse Gaussian Distribution. Lecture Notes Statistics. 9. New York–Berlin: Springer-Verlag. doi:10.1007/978-1-4612-5698-4","code":""},{"path":[]},{"path":"https://davidbolin.github.io/ngme2/reference/gig.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"The Generalised Inverse-Gaussian (GIG) Distribution — gig","text":"","code":"rgig(100, p = 1, a = 1, b = 1) #>   [1] 1.0158293 0.1792828 3.3220169 1.0249237 3.3245646 8.3461489 3.1715542 #>   [8] 1.1730993 4.4236857 5.1274657 7.8520861 2.8703523 4.7406235 2.6078787 #>  [15] 2.9579823 0.7240041 4.6020478 1.7375326 2.9949921 2.2702698 0.6271633 #>  [22] 2.5708816 2.3124126 2.4841857 2.7617561 0.3508521 1.9499829 1.7185853 #>  [29] 2.1538177 3.1766257 1.7578319 4.2483085 2.2411205 4.7604510 2.1593328 #>  [36] 4.7175504 0.7867970 9.2657634 7.2884010 0.5240867 3.2686410 8.3496558 #>  [43] 1.5118673 5.3179339 2.5260361 2.7943157 2.2848606 2.0274330 1.2631777 #>  [50] 0.5675271 0.6367959 5.3566219 5.6013956 5.0772224 3.7152684 3.6734970 #>  [57] 2.0296841 0.9970273 2.1737163 0.7893349 3.0920019 0.8203030 0.4850674 #>  [64] 3.6898476 1.1277560 0.8862547 3.5994708 3.3602283 1.3354358 1.9648001 #>  [71] 1.1884436 2.6358753 1.1087239 1.1015592 3.1324225 9.9579402 6.3009397 #>  [78] 1.2606379 1.9094530 0.5381401 0.7031207 3.2906706 2.7519240 3.0981911 #>  [85] 6.2471830 5.4965167 1.7707691 1.3695949 0.5590128 1.5281892 6.5821995 #>  [92] 0.3597366 3.0502809 1.6902233 8.8846132 2.4553810 2.7254194 4.0485994 #>  [99] 1.4992988 0.8946995 pgig(0.4, p = 1, a = 1, b = 1) #> [1] 0.02956016 qgig(0.8, p = 1, a = 1, b = 1) #> [1] 4.055929 plot(function(x){dgig(x, p = 1, a = 1, b = 1)}, main = \"Generalised inverse-Gaussian density\", ylab = \"Probability density\", xlim = c(0,10))"},{"path":"https://davidbolin.github.io/ngme2/reference/ig.html","id":null,"dir":"Reference","previous_headings":"","what":"The Inverse-Gaussian (IG) Distribution — ig","title":"The Inverse-Gaussian (IG) Distribution — ig","text":"Density, distribution function, quantile function random generation inverse-Gaussian distribution  parameters b.","code":""},{"path":"https://davidbolin.github.io/ngme2/reference/ig.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"The Inverse-Gaussian (IG) Distribution — ig","text":"","code":"dig(x, a, b, log = FALSE)  rig(n, a, b, seed = 0)  pig(q, a, b, lower.tail = TRUE, log.p = FALSE)  qig(p, a, b, lower.tail = TRUE, log.p = FALSE)"},{"path":"https://davidbolin.github.io/ngme2/reference/ig.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"The Inverse-Gaussian (IG) Distribution — ig","text":"x, q vector quantiles. , b parameters b. Must positive. log, log.p logical; TRUE, probabilities/densities \\(p\\) returned \\(log(p)\\). n, number observations. seed Seed random generation. lower.tail logical; TRUE, probabilities \\(P[X\\leq x]\\), otherwise, \\(P[X>x]\\). p vector probabilities.","code":""},{"path":"https://davidbolin.github.io/ngme2/reference/ig.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"The Inverse-Gaussian (IG) Distribution — ig","text":"dig gives density, pig gives distribution function, qig gives quantile function, rig generates random deviates. Invalid arguments result return value NaN, warning. length result determined n rig.","code":""},{"path":"https://davidbolin.github.io/ngme2/reference/ig.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"The Inverse-Gaussian (IG) Distribution — ig","text":"inverse-Gaussian distribution density given  $$f(x; , b) = \\frac{\\sqrt{b}}{\\sqrt{2\\pi x^3}}\\exp(  -\\frac{}{2}x -\\frac{b}{2x} + \\sqrt{ab}),$$  \\(x>0\\) \\(,b>0\\). parameterization,  \\(E(X) = \\sqrt{b}/\\sqrt{}\\). See Tweedie (1957a, 1957b)  details.","code":""},{"path":"https://davidbolin.github.io/ngme2/reference/ig.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"The Inverse-Gaussian (IG) Distribution — ig","text":"Tweedie, M. C. K. (1957a). \"Statistical Properties Inverse Gaussian Distributions \". Annals Mathematical Statistics. 28 (2): 362–377. doi:10.1214/aoms/1177706964 Tweedie, M. C. K. (1957b). \"Statistical Properties Inverse Gaussian Distributions II\". Annals Mathematical Statistics. 28 (3): 696–705. doi:10.1214/aoms/1177706881","code":""},{"path":[]},{"path":"https://davidbolin.github.io/ngme2/reference/ig.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"The Inverse-Gaussian (IG) Distribution — ig","text":"","code":"rig(100, a = 1, b = 1) #>   [1] 1.72114705 1.64643308 0.46160229 1.58397231 0.30212463 0.40373446 #>   [7] 0.90908818 2.82365822 1.76671894 1.37241326 1.23609311 0.33167896 #>  [13] 0.24942429 1.45123177 1.08249971 0.80674000 0.42848502 2.03879065 #>  [19] 0.96653691 0.29880547 0.21622118 0.59754639 3.21924243 0.26870639 #>  [25] 0.90077087 0.54722568 1.06995572 0.23410085 1.50406287 0.20857307 #>  [31] 0.46764898 1.79406392 0.53687005 1.12261014 2.18803078 0.92016185 #>  [37] 0.24449493 0.92349687 0.41873637 1.01442897 1.88310282 0.29412352 #>  [43] 0.45392596 1.56837578 0.34079166 2.11514247 0.20820153 0.46079636 #>  [49] 0.23527776 2.11069361 1.16887695 4.37593786 0.21913562 1.05473190 #>  [55] 0.50644537 0.47932907 0.18003038 0.46635229 0.60597551 0.71271399 #>  [61] 0.23461818 0.80184892 0.62859370 0.51006053 1.03580339 0.74669576 #>  [67] 1.14564111 0.38049771 0.46662768 1.12620279 1.33430769 2.19178873 #>  [73] 4.89188520 1.07978594 0.39297220 0.95227648 0.18520453 0.17339031 #>  [79] 0.27378579 0.81430126 0.48628990 0.63816310 0.70524373 0.34297667 #>  [85] 1.32981159 0.22434163 1.02140788 0.08919148 0.50777110 1.82811826 #>  [91] 1.17490432 0.25008887 1.91004434 0.87497964 1.53964703 0.29611878 #>  [97] 1.93583903 0.38988612 0.21892441 0.29365546 pig(0.4, a = 1, b = 1) #> [1] 0.2706137 qig(0.8, a = 1, b = 1) #> [1] 1.447891 plot(function(x){dig(x, a = 1, b = 1)}, main = \"Inverse-Gaussian density\", ylab = \"Probability density\", xlim = c(0,10))"},{"path":"https://davidbolin.github.io/ngme2/reference/igam.html","id":null,"dir":"Reference","previous_headings":"","what":"The Inverse-Gamma (IGam) Distribution — igam","title":"The Inverse-Gamma (IGam) Distribution — igam","text":"Density, distribution function, quantile function random generation inverse-Gamma distribution  parameters b.","code":""},{"path":"https://davidbolin.github.io/ngme2/reference/igam.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"The Inverse-Gamma (IGam) Distribution — igam","text":"","code":"digam(x, a, b, log = FALSE)  rigam(n, a, b)  pigam(q, a, b, lower.tail = TRUE, log.p = FALSE)  qigam(p, a, b, lower.tail = TRUE, log.p = FALSE)"},{"path":"https://davidbolin.github.io/ngme2/reference/igam.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"The Inverse-Gamma (IGam) Distribution — igam","text":"x, q vector quantiles. , b parameters b. Must positive. log, log.p logical; TRUE, probabilities/densities \\(p\\) returned \\(log(p)\\). n, number observations. lower.tail logical; TRUE, probabilities \\(P[X\\leq x]\\), otherwise, \\(P[X>x]\\). p vector probabilities.","code":""},{"path":"https://davidbolin.github.io/ngme2/reference/igam.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"The Inverse-Gamma (IGam) Distribution — igam","text":"digam gives density, pigam gives distribution function, qigam gives quantile function, rigam generates random deviates. Invalid arguments result return value NaN, warning. length result determined n rig.","code":""},{"path":"https://davidbolin.github.io/ngme2/reference/igam.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"The Inverse-Gamma (IGam) Distribution — igam","text":"inverse-Gamma distribution density given  $$f(x; , b) = \\frac{b^}{\\Gamma()}x^{-1}\\exp(  -\\frac{b}{x}),$$  \\(x>0\\) \\(,b>0\\).","code":""},{"path":[]},{"path":"https://davidbolin.github.io/ngme2/reference/igam.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"The Inverse-Gamma (IGam) Distribution — igam","text":"","code":"rigam(100, a = 1, b = 1) #>   [1]  5.3916576  0.5784808  0.8014483  1.2565425  1.1035157  2.4431390 #>   [7]  0.7291864  1.2125389  0.9812048  0.9513574  0.9197921  3.2239456 #>  [13]  1.1070023  1.9686924  8.7779769  1.8317565  0.7387087  0.5539500 #>  [19]  5.6420562  1.0626334  1.7237437  0.6198423  1.3205655  1.0591355 #>  [25]  0.6317995  0.6269156  3.7881554  5.0478164  0.6594687  7.9171367 #>  [31]  0.5836045  0.8734288  2.0225440  0.2349775  2.8983718  1.5010720 #>  [37]  0.9160087  0.4061871  0.4890659  1.0964794  1.3429740  5.2626691 #>  [43]  1.4019860  7.6849778  2.2960961  0.6941808  2.1381237  0.8344917 #>  [49]  0.5357413  3.1623499  1.6497282  2.1630359  0.5941378  1.0653264 #>  [55]  5.9517635  0.3376944  1.0027177  0.6247265  0.8976694  2.8024179 #>  [61]  2.5402345  2.1206772  0.4449580  0.5931174  0.5176385  0.6804874 #>  [67]  1.0779238  2.1293837  9.4085801  1.6704371  2.1984504  3.7464259 #>  [73]  0.9864948  1.0513527  3.3768471 13.8104590  0.6178733 12.8573294 #>  [79]  0.4689974  0.4839553  1.5729959  6.4947471 18.6104399  0.8325612 #>  [85] 15.7362172  0.5362417  1.7905333  1.5743146  0.6920630  0.5568819 #>  [91]  0.7441488  0.6286211  2.1291745  0.3364307  0.4341769  0.5558452 #>  [97]  2.0944398  1.4326788  1.0813091  1.3129628 pigam(0.4, a = 1, b = 1) #> [1] 0.082085 qigam(0.8, a = 1, b = 1) #> [1] 4.48142 plot(function(x){digam(x, a = 1, b = 1)}, main = \"Inverse-Gamma density\", ylab = \"Probability density\", xlim = c(0,10))"},{"path":"https://davidbolin.github.io/ngme2/reference/mean_list.html","id":null,"dir":"Reference","previous_headings":"","what":"taking mean over a list of nested lists — mean_list","title":"taking mean over a list of nested lists — mean_list","text":"taking mean list nested lists","code":""},{"path":"https://davidbolin.github.io/ngme2/reference/mean_list.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"taking mean over a list of nested lists — mean_list","text":"","code":"mean_list(lls)"},{"path":"https://davidbolin.github.io/ngme2/reference/mean_list.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"taking mean over a list of nested lists — mean_list","text":"lls list","code":""},{"path":"https://davidbolin.github.io/ngme2/reference/mean_list.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"taking mean over a list of nested lists — mean_list","text":"list nested lists","code":""},{"path":"https://davidbolin.github.io/ngme2/reference/mean_list.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"taking mean over a list of nested lists — mean_list","text":"","code":"ls <- list(   list(a=1, b=2, t=\"nig\", ll=list(a=1,b=2, w=\"ab\")),   list(a=3, b=5, t=\"nig\", ll=list(a=1,b=6, w=\"ab\")),   list(a=5, b=5, t=\"nig\", ll=list(a=4,b=2, w=\"ab\")) ) mean_list(ls) #> $a #> [1] 3 #>  #> $b #> [1] 4 #>  #> $t #> [1] \"nig\" #>  #> $ll #> $ll$a #> [1] 2 #>  #> $ll$b #> [1] 3.333333 #>  #> $ll$w #> [1] \"ab\" #>  #>"},{"path":"https://davidbolin.github.io/ngme2/reference/model_ar1.html","id":null,"dir":"Reference","previous_headings":"","what":"ngme ar1 model specification — model_ar1","title":"ngme ar1 model specification — model_ar1","text":"Generating C, G given index replicates","code":""},{"path":"https://davidbolin.github.io/ngme2/reference/model_ar1.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"ngme ar1 model specification — model_ar1","text":"","code":"model_ar1(   index,   replicates = NULL,   index_NA = NULL,   data = NULL,   noise = noise_normal(),   alpha = 0.5,   range = c(1, max(index)),   ... )"},{"path":"https://davidbolin.github.io/ngme2/reference/model_ar1.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"ngme ar1 model specification — model_ar1","text":"index index process replicates replicates process index_NA Logical vector, .na(response var.) data data, can specified f(), ngme() noise noise, can specified f() alpha initial value alpha range range mesh ... extra arguments f()","code":""},{"path":"https://davidbolin.github.io/ngme2/reference/model_ar1.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"ngme ar1 model specification — model_ar1","text":"list specification model","code":""},{"path":"https://davidbolin.github.io/ngme2/reference/model_ar1.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"ngme ar1 model specification — model_ar1","text":"","code":"model_ar1(index = c(1:3, 1:3), replicates = c(1,1,1,2,2,2)) #> as(<dgTMatrix>, \"dgCMatrix\") is deprecated since Matrix 1.5-0; do as(., \"CsparseMatrix\") instead #> Ngme model: ar1 #> Model parameters:  #>     alpha = 0.5 #>  #> Noise type - normal #> Noise parameters:  #>     sigma = 1 f(index = xx, model = \"ar1\", data=list(xx = c(2,4,5)), noise=noise_nig()) #> Ngme model: ar1 #> Model parameters:  #>     alpha = 0.5 #>  #> Noise type - nig #> Noise parameters:  #>     mu = 0 #>     sigma = 1 #>     nu = 1"},{"path":"https://davidbolin.github.io/ngme2/reference/model_matern.html","id":null,"dir":"Reference","previous_headings":"","what":"Create a Matern SPDE model — model_matern","title":"Create a Matern SPDE model — model_matern","text":"Create Matern SPDE model","code":""},{"path":"https://davidbolin.github.io/ngme2/reference/model_matern.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create a Matern SPDE model — model_matern","text":"","code":"model_matern(   loc = NULL,   replicates = NULL,   alpha = 2,   kappa = 1,   theta_kappa = NULL,   B_kappa = NULL,   mesh = NULL,   fem.mesh.matrices = NULL,   d = NULL,   index_NA = NULL,   A = NULL,   A_pred = NULL,   noise = noise_normal(),   ... )"},{"path":"https://davidbolin.github.io/ngme2/reference/model_matern.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Create a Matern SPDE model — model_matern","text":"loc numeric vector matrix column 2,location make index replicates replicates process alpha 2 4, SPDE smoothness parameter kappa parameterization kappa^2 C + G, stationary theta_kappa parameterization non-stationary B_kappa bases kappa mesh mesh argument fem.mesh.matrices specify FEM matrices d indicating dimension mesh (together fem.mesh.matrices) index_NA Logical vector, .na(response var.) Matrix connecting observation mesh A_pred Matrix connecting NA location mesh noise 1. string: type model, 2. ngme.noise object ... extra arguments f()","code":""},{"path":"https://davidbolin.github.io/ngme2/reference/model_matern.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Create a Matern SPDE model — model_matern","text":"list (n, C (diagonal), G, B.kappa) constructing operator","code":""},{"path":"https://davidbolin.github.io/ngme2/reference/model_rw.html","id":null,"dir":"Reference","previous_headings":"","what":"ngme model - random walk of order 1 — model_rw","title":"ngme model - random walk of order 1 — model_rw","text":"Generating C, G given index replicates size C G (n-1) * n, size V n-1","code":""},{"path":"https://davidbolin.github.io/ngme2/reference/model_rw.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"ngme model - random walk of order 1 — model_rw","text":"","code":"model_rw(   index,   order = 1,   replicates = NULL,   data = NULL,   circular = FALSE,   index_NA = NULL,   noise = noise_normal(),   ... )"},{"path":"https://davidbolin.github.io/ngme2/reference/model_rw.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"ngme model - random walk of order 1 — model_rw","text":"index numerical vector, index process order 1 2, order random walk model replicates replicates process data specifed inherit ngme formula circular whether mesh circular, .e. first one connected last index_NA Logical vector, .na(response variable) noise 1. string: type model, 2. ngme.noise object (can also specified ngme model) ... additional arguments","code":""},{"path":"https://davidbolin.github.io/ngme2/reference/model_rw.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"ngme model - random walk of order 1 — model_rw","text":"list","code":""},{"path":"https://davidbolin.github.io/ngme2/reference/model_rw.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"ngme model - random walk of order 1 — model_rw","text":"","code":"r1 <- model_rw(1:7, order = 1, circular = TRUE); r1$C + r1$G #> 6 x 6 sparse Matrix of class \"dgCMatrix\" #>                        #> [1,]  1 -1  .  .  .  . #> [2,]  .  1 -1  .  .  . #> [3,]  .  .  1 -1  .  . #> [4,]  .  .  .  1 -1  . #> [5,]  .  .  .  .  1 -1 #> [6,] -1  .  .  .  .  1 r2 <- model_rw(1:7, order = 1); r2$C + r2$G #> 6 x 7 sparse Matrix of class \"dgCMatrix\" #>                          #> [1,] 1 -1  .  .  .  .  . #> [2,] .  1 -1  .  .  .  . #> [3,] .  .  1 -1  .  .  . #> [4,] .  .  .  1 -1  .  . #> [5,] .  .  .  .  1 -1  . #> [6,] .  .  .  .  .  1 -1"},{"path":"https://davidbolin.github.io/ngme2/reference/ngme.html","id":null,"dir":"Reference","previous_headings":"","what":"Additive non-guassian model fitting — ngme","title":"Additive non-guassian model fitting — ngme","text":"ngme function performs analysis non-gaussian additive models.","code":""},{"path":"https://davidbolin.github.io/ngme2/reference/ngme.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Additive non-guassian model fitting — ngme","text":"","code":"ngme(   formula,   data,   control = ngme_control(),   family = \"normal\",   last_fit = NULL,   beta = NULL,   seed = NULL,   start = NULL,   debug = FALSE )"},{"path":"https://davidbolin.github.io/ngme2/reference/ngme.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Additive non-guassian model fitting — ngme","text":"formula formula data dataframe list providing data (response variable can contain NA value,  NA value columns cause problem) control control variables, see ?ngme.control family likelihood type, measurement noise specification, 1. string 2. ngme noise obejct last_fit can ngme object last fitting beta starting value fixed effects seed set seed pesudo random number generator start starting ngme object (usually object last fitting) debug toggle debug mode","code":""},{"path":"https://davidbolin.github.io/ngme2/reference/ngme.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Additive non-guassian model fitting — ngme","text":"list outputs contains estimation operator paramters, noise parameters","code":""},{"path":"https://davidbolin.github.io/ngme2/reference/ngme.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Additive non-guassian model fitting — ngme","text":"","code":"ngme(  formula = Y ~ x1 + f(    index = x2,    model = \"ar1\",    noise = noise_nig(),    theta_K = 0.5  ) + f(    model = model_rw(1:5, order=1, circular = TRUE),    noise = noise_normal(),  ),  family = noise_normal(sd = 0.5),  data = data.frame(Y = 1:5, x1 = 2:6, x2 = 3:7),  control = ngme_control(    estimation = FALSE  ) ) #> *** Ngme object *** #>  #> Fixed effects:  #>    beta = -1,  1 #>  #> Measurement noise:  #>   Noise type - normal #>   Noise parameters:  #>       sigma = 0.5 #>  #>  #> Latent models:  #> [[1]] #>   Ngme model: ar1 #>   Model parameters:  #>       alpha = 0.5 #>  #>   Noise type - nig #>   Noise parameters:  #>       mu = 0 #>       sigma = 1 #>       nu = 1 #> [[2]] #>   Ngme model: rw1 #>   Model parameters:  #>       No parameter needed. #>  #>   Noise type - normal #>   Noise parameters:  #>       sigma = 1"},{"path":"https://davidbolin.github.io/ngme2/reference/ngme2.html","id":null,"dir":"Reference","previous_headings":"","what":"ngme2 — ngme2","title":"ngme2 — ngme2","text":"Inference prediction mixed effects models flexible non-Gaussian Gaussian distributions.","code":""},{"path":"https://davidbolin.github.io/ngme2/reference/ngme2.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"ngme2 — ngme2","text":"David Bolin <davidbolin@gmail.com>","code":""},{"path":"https://davidbolin.github.io/ngme2/reference/ngme_as_sparse.html","id":null,"dir":"Reference","previous_headings":"","what":"Convert sparse matrix into sparse dgCMatrix — ngme_as_sparse","title":"Convert sparse matrix into sparse dgCMatrix — ngme_as_sparse","text":"Convert sparse matrix sparse dgCMatrix","code":""},{"path":"https://davidbolin.github.io/ngme2/reference/ngme_as_sparse.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Convert sparse matrix into sparse dgCMatrix — ngme_as_sparse","text":"","code":"ngme_as_sparse(G)"},{"path":"https://davidbolin.github.io/ngme2/reference/ngme_as_sparse.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Convert sparse matrix into sparse dgCMatrix — ngme_as_sparse","text":"G matrix","code":""},{"path":"https://davidbolin.github.io/ngme2/reference/ngme_as_sparse.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Convert sparse matrix into sparse dgCMatrix — ngme_as_sparse","text":"sparse dgCMatrix","code":""},{"path":"https://davidbolin.github.io/ngme2/reference/ngme_control.html","id":null,"dir":"Reference","previous_headings":"","what":"Generate control specifications for ngme — ngme_control","title":"Generate control specifications for ngme — ngme_control","text":"Generate control specifications ngme","code":""},{"path":"https://davidbolin.github.io/ngme2/reference/ngme_control.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Generate control specifications for ngme — ngme_control","text":"","code":"ngme_control(   burnin = 100,   iterations = 100,   gibbs_sample = 5,   stepsize = 1,   estimation = TRUE,   n_parallel_chain = 2,   stop_points = 10,   exchange_VW = TRUE,   n_slope_check = 3,   std_lim = 0.1,   trend_lim = 0.05,   print_check_info = TRUE,   opt_beta = TRUE,   fix_beta = FALSE,   max_relative_step = 0.1,   max_absolute_step = 0.5,   reduce_var = FALSE,   reduce_power = 0.75,   threshold = 1e-05,   window_size = 1 )"},{"path":"https://davidbolin.github.io/ngme2/reference/ngme_control.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Generate control specifications for ngme — ngme_control","text":"burnin burn-iterations iterations optimizing terations gibbs_sample number gibbs sampels stepsize stepsize estimation estimating parameters n_parallel_chain number parallel chains stop_points number stop points convergence check exchange_VW exchange last V W chian n_slope_check number stop points regression std_lim maximum allowed standard deviation trend_lim maximum allowed slope print_check_info print convergence information opt_beta logical, optimize fixed effect fix_beta logical, fix fixed effect max_relative_step max relative step allowed 1 iteration max_absolute_step max absolute step allowed 1 iteration reduce_var logical, reduce variace reduce_power numerical power reduce level threshold till start reduce variance window_size numerical, length window final estimates","code":""},{"path":"https://davidbolin.github.io/ngme2/reference/ngme_control.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Generate control specifications for ngme — ngme_control","text":"list control variables","code":""},{"path":"https://davidbolin.github.io/ngme2/reference/ngme_control_f.html","id":null,"dir":"Reference","previous_headings":"","what":"Generate control specifications for f function — ngme_control_f","title":"Generate control specifications for f function — ngme_control_f","text":"Generate control specifications f function","code":""},{"path":"https://davidbolin.github.io/ngme2/reference/ngme_control_f.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Generate control specifications for f function — ngme_control_f","text":"","code":"ngme_control_f(   numer_grad = FALSE,   use_precond = FALSE,   use_num_hess = TRUE,   eps = 0.01 )"},{"path":"https://davidbolin.github.io/ngme2/reference/ngme_control_f.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Generate control specifications for f function — ngme_control_f","text":"numer_grad whether use numerical gradient use_precond whether use preconditioner use_num_hess whether use numerical hessian eps eps numerical gradient","code":""},{"path":"https://davidbolin.github.io/ngme2/reference/ngme_control_f.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Generate control specifications for f function — ngme_control_f","text":"list control variables","code":""},{"path":"https://davidbolin.github.io/ngme2/reference/ngme_model_types.html","id":null,"dir":"Reference","previous_headings":"","what":"Show ngme model types — ngme_model_types","title":"Show ngme model types — ngme_model_types","text":"Show ngme mdoel types","code":""},{"path":"https://davidbolin.github.io/ngme2/reference/ngme_model_types.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Show ngme model types — ngme_model_types","text":"","code":"ngme_model_types()"},{"path":"https://davidbolin.github.io/ngme2/reference/ngme_model_types.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Show ngme model types — ngme_model_types","text":"available types models","code":""},{"path":"https://davidbolin.github.io/ngme2/reference/ngme_noise.html","id":null,"dir":"Reference","previous_headings":"","what":"ngme noise specification — ngme_noise","title":"ngme noise specification — ngme_noise","text":"Function specifying ngme noise. Please use noise_type simpler specification. Use ngme_noise_types() check available types.","code":""},{"path":"https://davidbolin.github.io/ngme2/reference/ngme_noise.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"ngme noise specification — ngme_noise","text":"","code":"ngme_noise(   noise_type,   theta_mu = 0,   theta_sigma = 0,   theta_V = 1,   n = 1,   V = NULL,   B_mu = NULL,   B_sigma = NULL,   fix_theta_mu = FALSE,   fix_theta_sigma = FALSE,   fix_theta_V = FALSE,   fix_V = FALSE,   ... )"},{"path":"https://davidbolin.github.io/ngme2/reference/ngme_noise.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"ngme noise specification — ngme_noise","text":"noise_type type noise, \"nig\", \"normal\" theta_mu specify non-stationary noise using theta_mu theta_sigma specify non-stationary noise using theta_sigma theta_V value theta_V, theta_V = nu > 0 n number noise (= nrow(B_mu) = nrow(B_sigma)) V value V B_mu Basis matrix mu (non-stationary) B_sigma Basis matrix sigma (non-stationary) fix_theta_mu fix parameter theta_mu fix_theta_sigma fix parameter theta_sigma fix_theta_V fix parameter theta_V fix_V fix sampling V ... additional arguments","code":""},{"path":"https://davidbolin.github.io/ngme2/reference/ngme_noise.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"ngme noise specification — ngme_noise","text":"list specification noise","code":""},{"path":"https://davidbolin.github.io/ngme2/reference/ngme_noise_types.html","id":null,"dir":"Reference","previous_headings":"","what":"show ngme noise types — ngme_noise_types","title":"show ngme noise types — ngme_noise_types","text":"show ngme noise types","code":""},{"path":"https://davidbolin.github.io/ngme2/reference/ngme_noise_types.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"show ngme noise types — ngme_noise_types","text":"","code":"ngme_noise_types()"},{"path":"https://davidbolin.github.io/ngme2/reference/ngme_noise_types.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"show ngme noise types — ngme_noise_types","text":"available types noise","code":""},{"path":"https://davidbolin.github.io/ngme2/reference/ngme_parse_formula.html","id":null,"dir":"Reference","previous_headings":"","what":"Parse the formula for ngme function — ngme_parse_formula","title":"Parse the formula for ngme function — ngme_parse_formula","text":"Parse formula ngme function","code":""},{"path":"https://davidbolin.github.io/ngme2/reference/ngme_parse_formula.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Parse the formula for ngme function — ngme_parse_formula","text":"","code":"ngme_parse_formula(gf, data)"},{"path":"https://davidbolin.github.io/ngme2/reference/ngme_parse_formula.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Parse the formula for ngme function — ngme_parse_formula","text":"gf formula data data.frame","code":""},{"path":"https://davidbolin.github.io/ngme2/reference/ngme_parse_formula.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Parse the formula for ngme function — ngme_parse_formula","text":"1. plain formula without f function  2. latents_in - f function","code":""},{"path":"https://davidbolin.github.io/ngme2/reference/ngme_ts_make_A.html","id":null,"dir":"Reference","previous_headings":"","what":"Make observation matrix for time series — ngme_ts_make_A","title":"Make observation matrix for time series — ngme_ts_make_A","text":"Make observation matrix time series","code":""},{"path":"https://davidbolin.github.io/ngme2/reference/ngme_ts_make_A.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Make observation matrix for time series — ngme_ts_make_A","text":"","code":"ngme_ts_make_A(loc, replicates = NULL, range = c(1, max(loc)))"},{"path":"https://davidbolin.github.io/ngme2/reference/ngme_ts_make_A.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Make observation matrix for time series — ngme_ts_make_A","text":"loc integers (sorting, gaps > 1) replicates indicating replicate measure location range range mesh default range=(min(loc), max(loc))","code":""},{"path":"https://davidbolin.github.io/ngme2/reference/ngme_ts_make_A.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Make observation matrix for time series — ngme_ts_make_A","text":"matrix (length(loc) * length(unique(loc)))","code":""},{"path":"https://davidbolin.github.io/ngme2/reference/ngme_ts_make_A.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Make observation matrix for time series — ngme_ts_make_A","text":"","code":"ngme_ts_make_A(c(1, 2, 2), replicates = c(1, 1, 2)) #> 3 x 4 sparse Matrix of class \"dgCMatrix\" #>              #> [1,] 1 . . . #> [2,] . 1 . . #> [3,] . . . 1 ngme_ts_make_A(c(1, 2, 2), range = c(1, 5)) #> 3 x 5 sparse Matrix of class \"dgCMatrix\" #>                #> [1,] 1 . . . . #> [2,] . 1 . . . #> [3,] . 1 . . ."},{"path":"https://davidbolin.github.io/ngme2/reference/nig.html","id":null,"dir":"Reference","previous_headings":"","what":"The Normal Inverse-Gaussian (GIG) Distribution — nig","title":"The Normal Inverse-Gaussian (GIG) Distribution — nig","text":"Density, distribution function, quantile function random generation normal inverse-Gaussian distribution  parameters p, b.","code":""},{"path":"https://davidbolin.github.io/ngme2/reference/nig.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"The Normal Inverse-Gaussian (GIG) Distribution — nig","text":"","code":"dnig(x, delta, mu, nu, sigma, log = FALSE)  rnig(n, delta, mu, nu, sigma, seed = 0)  pnig(q, delta, mu, nu, sigma, lower.tail = TRUE, log.p = FALSE)  qnig(p, delta, mu, nu, sigma, lower.tail = TRUE, log.p = FALSE)"},{"path":"https://davidbolin.github.io/ngme2/reference/nig.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"The Normal Inverse-Gaussian (GIG) Distribution — nig","text":"x, q vector quantiles. delta numeric value location parameter. mu numeric value shift parameter. nu numeric value shape parameter. sigma numeric value scaling parameter. log, log.p logical; TRUE, probabilities/densities \\(p\\) returned \\(log(p)\\). n, number observations. seed Seed random generation. lower.tail logical; TRUE, probabilities \\(P[X\\leq x]\\), otherwise, \\(P[X>x]\\). p vector probabilities.","code":""},{"path":"https://davidbolin.github.io/ngme2/reference/nig.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"The Normal Inverse-Gaussian (GIG) Distribution — nig","text":"dnig gives density, pnig gives distribution function, qnig gives quantile function, rnig generates random deviates. Invalid arguments result return value NaN, warning. length result determined n rnig.","code":""},{"path":"https://davidbolin.github.io/ngme2/reference/nig.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"The Normal Inverse-Gaussian (GIG) Distribution — nig","text":"normal inverse-Gaussian distribution density given  $$f(x; p, , b) =  \\frac{e^{\\nu+\\mu(x-\\delta)/\\sigma^2}\\sqrt{\\nu\\mu^2/\\sigma^2+\\nu^2}}{\\pi\\sqrt{\\nu\\sigma^2+(x-\\delta)^2}}  K_1(\\sqrt{(\\nu\\sigma^2+(x-\\delta)^2)(\\mu^2/\\sigma^4+\\nu/\\sigma^2)}),$$  \\(K_p\\) modified Bessel function second kind order \\(p\\),  \\(x>0\\), \\(\\nu>0\\) \\(\\mu,\\delta, \\sigma\\\\mathbb{R}\\).  See Barndorff-Nielsen (1977, 1978 1997) details.","code":""},{"path":"https://davidbolin.github.io/ngme2/reference/nig.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"The Normal Inverse-Gaussian (GIG) Distribution — nig","text":"Barndorff-Nielsen, O. (1977) Exponentially decreasing distributions logarithm particle size. Proceedings Royal Society London. Series , Mathematical Physical Sciences. Royal Society. 353, 401–409. doi:10.1098/rspa.1977.0041 Barndorff-Nielsen, O. (1978) Hyperbolic Distributions Distributions Hyperbolae, Scandinavian Journal Statistics. 5, 151–157. Barndorff-Nielsen, O. (1997) Normal Inverse Gaussian Distributions Stochastic Volatility Modelling, Scandinavian Journal Statistics. 24, 1-13. doi:10.1111/1467-9469.00045","code":""},{"path":[]},{"path":"https://davidbolin.github.io/ngme2/reference/nig.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"The Normal Inverse-Gaussian (GIG) Distribution — nig","text":"","code":"rnig(100, delta = 0, mu = 5, sigma = 1, nu = 1) #>   [1]  0.5367500  0.9242911  0.7605213  8.7614864  3.7923963  8.2756382 #>   [7]  3.4092379  0.6619569  1.1740675  0.7251288  5.4405594  9.3835501 #>  [13]  7.5535393  5.2151042  7.0938998  6.8275346 12.0712401  4.6657208 #>  [19] 10.4217770  1.7072381  5.1543174 11.5095263  2.7494490  5.3198739 #>  [25]  0.8925560  2.0923130  2.6271177  0.8871688 13.8171761 10.5476529 #>  [31]  2.1820215  0.6448328  0.9775926  5.8337877  7.3526123  6.3873047 #>  [37]  2.8585157  4.1073839  3.7663855  1.8336059  3.9791657  1.0822109 #>  [43]  2.7597417 11.6169848  1.8798070  1.6792713  5.4499648 10.5688577 #>  [49]  1.9606478  5.4595744  2.0673143  3.0049291  1.7002267  3.4922898 #>  [55]  0.3329601  9.4453984  7.4601615  6.3106886  4.3028357  0.9117058 #>  [61]  2.8002874  4.3002465  1.9771237  5.6071109  5.9013504  3.4375428 #>  [67]  3.6846761  3.4797008  4.8368501  4.5443805  5.1344158  2.3362461 #>  [73]  1.2247420  3.3470635  1.1633101  4.3091229 13.2288230  6.5486812 #>  [79]  3.0241720  1.7447270 26.0818026  2.5757201  7.9843771  4.5568759 #>  [85]  3.0629376  1.5622792  3.3086033  3.5119337  1.0234458  8.6264228 #>  [91] 10.2532583  1.7929075  1.7584808  3.6392334  3.1990708  6.2999482 #>  [97]  3.6558572  1.0844184  7.0546931  5.2798093 pnig(0.4, delta = 0, mu = 5, sigma = 1, nu = 1) #> [1] 0.01597497 qnig(0.8, delta = 0, mu = 5, sigma = 1, nu = 1) #> [1] 7.390234 plot(function(x){dnig(x, delta = 0, mu = 5, sigma = 1, nu = 1)}, main = \"Normal inverse-Gaussian density\", ylab = \"Probability density\", xlim = c(0,10))"},{"path":"https://davidbolin.github.io/ngme2/reference/noise_nig.html","id":null,"dir":"Reference","previous_headings":"","what":"Specify a nig noise (normal inverse Gaussian) — noise_nig","title":"Specify a nig noise (normal inverse Gaussian) — noise_nig","text":"parameterization can found ...","code":""},{"path":"https://davidbolin.github.io/ngme2/reference/noise_nig.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Specify a nig noise (normal inverse Gaussian) — noise_nig","text":"","code":"noise_nig(   mu = NULL,   sigma = NULL,   nu = NULL,   n = 1,   V = NULL,   theta_mu = NULL,   theta_sigma = NULL,   B_mu = matrix(1),   B_sigma = matrix(1),   ... )"},{"path":"https://davidbolin.github.io/ngme2/reference/noise_nig.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Specify a nig noise (normal inverse Gaussian) — noise_nig","text":"mu mu parameter (stationary) sigma sigma parameter (stationary) nu nu n number noise (= nrow(B_mu) = nrow(B_sigma)) V value V theta_mu specify non-stationary noise using theta_mu theta_sigma specify non-stationary noise using theta_sigma B_mu Basis matrix mu (non-stationary) B_sigma Basis matrix sigma (non-stationary) ... additional arguments","code":""},{"path":"https://davidbolin.github.io/ngme2/reference/noise_nig.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Specify a nig noise (normal inverse Gaussian) — noise_nig","text":"ngme_noise object","code":""},{"path":"https://davidbolin.github.io/ngme2/reference/noise_nig.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Specify a nig noise (normal inverse Gaussian) — noise_nig","text":"","code":"noise_nig(mu = 1, sigma = 2, nu = 1, n=10) #> Noise type - nig #> Noise parameters:  #>     mu = 1 #>     sigma = 2 #>     nu = 1"},{"path":"https://davidbolin.github.io/ngme2/reference/noise_normal.html","id":null,"dir":"Reference","previous_headings":"","what":"Specify a normal noise — noise_normal","title":"Specify a normal noise — noise_normal","text":"Specify normal noise","code":""},{"path":"https://davidbolin.github.io/ngme2/reference/noise_normal.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Specify a normal noise — noise_normal","text":"","code":"noise_normal(   sd = NULL,   theta_sigma = NULL,   B_sigma = matrix(1, 1, 1),   n = nrow(B_sigma),   ... )"},{"path":"https://davidbolin.github.io/ngme2/reference/noise_normal.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Specify a normal noise — noise_normal","text":"sd standard deviation theta_sigma specify non-stationary noise using theta_sigma B_sigma Basis matrix sigma (non-stationary) n number noise (= nrow(B_mu) = nrow(B_sigma)) ... additional arguments","code":""},{"path":"https://davidbolin.github.io/ngme2/reference/noise_normal.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Specify a normal noise — noise_normal","text":"ngme_noise object","code":""},{"path":"https://davidbolin.github.io/ngme2/reference/noise_normal.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Specify a normal noise — noise_normal","text":"","code":"noise_normal(n = 10, sd = 2) #> Noise type - normal #> Noise parameters:  #>     sigma = 2"},{"path":"https://davidbolin.github.io/ngme2/reference/plot.ngme_noise.html","id":null,"dir":"Reference","previous_headings":"","what":"plot the density of noise (for stationary) — plot.ngme_noise","title":"plot the density of noise (for stationary) — plot.ngme_noise","text":"plot density noise (stationary)","code":""},{"path":"https://davidbolin.github.io/ngme2/reference/plot.ngme_noise.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"plot the density of noise (for stationary) — plot.ngme_noise","text":"","code":"# S3 method for ngme_noise plot(x, y = NULL, ...)"},{"path":"https://davidbolin.github.io/ngme2/reference/plot.ngme_noise.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"plot the density of noise (for stationary) — plot.ngme_noise","text":"x ngme_noise y another ngme_noise ... ...","code":""},{"path":"https://davidbolin.github.io/ngme2/reference/plot.ngme_noise.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"plot the density of noise (for stationary) — plot.ngme_noise","text":"plot","code":""},{"path":"https://davidbolin.github.io/ngme2/reference/plot.ngme_noise.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"plot the density of noise (for stationary) — plot.ngme_noise","text":"","code":"plot(noise_nig(mu=1, sigma=2, nu=1))"},{"path":"https://davidbolin.github.io/ngme2/reference/print.ngme.html","id":null,"dir":"Reference","previous_headings":"","what":"Print ngme object — print.ngme","title":"Print ngme object — print.ngme","text":"Print ngme object","code":""},{"path":"https://davidbolin.github.io/ngme2/reference/print.ngme.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Print ngme object — print.ngme","text":"","code":"# S3 method for ngme print(x, ...)"},{"path":"https://davidbolin.github.io/ngme2/reference/print.ngme.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Print ngme object — print.ngme","text":"x ngme object ... ignored","code":""},{"path":"https://davidbolin.github.io/ngme2/reference/print.ngme.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Print ngme object — print.ngme","text":"list (noise specifications)","code":""},{"path":"https://davidbolin.github.io/ngme2/reference/print.ngme_model.html","id":null,"dir":"Reference","previous_headings":"","what":"Print ngme model — print.ngme_model","title":"Print ngme model — print.ngme_model","text":"Print ngme model","code":""},{"path":"https://davidbolin.github.io/ngme2/reference/print.ngme_model.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Print ngme model — print.ngme_model","text":"","code":"# S3 method for ngme_model print(x, padding = 0, ...)"},{"path":"https://davidbolin.github.io/ngme2/reference/print.ngme_model.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Print ngme model — print.ngme_model","text":"x ngme model object padding number white space padding front ... ...","code":""},{"path":"https://davidbolin.github.io/ngme2/reference/print.ngme_model.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Print ngme model — print.ngme_model","text":"list (model specifications)","code":""},{"path":"https://davidbolin.github.io/ngme2/reference/print.ngme_noise.html","id":null,"dir":"Reference","previous_headings":"","what":"Print ngme noise — print.ngme_noise","title":"Print ngme noise — print.ngme_noise","text":"Print ngme noise","code":""},{"path":"https://davidbolin.github.io/ngme2/reference/print.ngme_noise.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Print ngme noise — print.ngme_noise","text":"","code":"# S3 method for ngme_noise print(x, padding = 0, ...)"},{"path":"https://davidbolin.github.io/ngme2/reference/print.ngme_noise.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Print ngme noise — print.ngme_noise","text":"x noise object padding number white space padding front ... ...","code":""},{"path":"https://davidbolin.github.io/ngme2/reference/print.ngme_noise.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Print ngme noise — print.ngme_noise","text":"list (noise specifications)","code":""},{"path":"https://davidbolin.github.io/ngme2/reference/simulate.ngme_model.html","id":null,"dir":"Reference","previous_headings":"","what":"Simulate latent process with noise — simulate.ngme_model","title":"Simulate latent process with noise — simulate.ngme_model","text":"Simulate latent process noise","code":""},{"path":"https://davidbolin.github.io/ngme2/reference/simulate.ngme_model.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Simulate latent process with noise — simulate.ngme_model","text":"","code":"# S3 method for ngme_model simulate(object, nsim = 1, seed = NULL, ...)"},{"path":"https://davidbolin.github.io/ngme2/reference/simulate.ngme_model.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Simulate latent process with noise — simulate.ngme_model","text":"object ngme model specified f() function nsim ignored seed seed ... ignored","code":""},{"path":"https://davidbolin.github.io/ngme2/reference/simulate.ngme_model.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Simulate latent process with noise — simulate.ngme_model","text":"realization latent model","code":""},{"path":"https://davidbolin.github.io/ngme2/reference/simulate.ngme_model.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Simulate latent process with noise — simulate.ngme_model","text":"","code":"B_sigma <- matrix(1:10 / 10, nrow=10) simulate(noise_nig(n = 10, B_sigma =  B_sigma)) #>  [1] -0.47134717  0.41616759 -2.24037074  0.54555204  1.55801595 -2.27653745 #>  [7]  0.03691396 -0.43067938 -0.07639631  1.77538987 #> attr(,\"noise\") #> Noise type - nig #> Noise parameters:  #>     mu = 0 #>     sigma = 1 #>     nu = 1 simulate(noise_normal(theta_sigma = 1.5, B_sigma = B_sigma)) #>  [1] -1.37054135 -0.33509480 -0.93027045  0.63274999 -0.79386299  1.74796754 #>  [7]  0.09055596  1.97281974 -4.07561030 -3.56718057 #> attr(,\"noise\") #> Noise type - normal #> Noise parameters:  #>     sigma = 4.48 simulate(f(1:10, model = \"ar1\", theta_K = 0.4, noise = noise_nig())) #>  [1] -0.1764355  0.5716391  0.5871423 -2.4705154 -3.2366572 -2.3110962 #>  [7] -0.6105095  0.6896104  0.8315281  0.9843390 #> attr(,\"noise\") #> Noise type - nig #> Noise parameters:  #>     mu = 0 #>     sigma = 1 #>     nu = 1"},{"path":"https://davidbolin.github.io/ngme2/reference/simulate.ngme_noise.html","id":null,"dir":"Reference","previous_headings":"","what":"Simulate ngme noise — simulate.ngme_noise","title":"Simulate ngme noise — simulate.ngme_noise","text":"Simulate ngme noise","code":""},{"path":"https://davidbolin.github.io/ngme2/reference/simulate.ngme_noise.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Simulate ngme noise — simulate.ngme_noise","text":"","code":"# S3 method for ngme_noise simulate(object, nsim = 1, seed = NULL, ...)"},{"path":"https://davidbolin.github.io/ngme2/reference/simulate.ngme_noise.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Simulate ngme noise — simulate.ngme_noise","text":"object ngme noise object nsim ignored seed seed ... ignored","code":""},{"path":"https://davidbolin.github.io/ngme2/reference/simulate.ngme_noise.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Simulate ngme noise — simulate.ngme_noise","text":"realization ngme noise","code":""},{"path":"https://davidbolin.github.io/ngme2/reference/simulate.ngme_noise.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Simulate ngme noise — simulate.ngme_noise","text":"","code":"simulate(noise_normal(sd = 5, n = 10)) #>  [1]  4.0958617  0.2847888  0.3336808 -5.1646230 -3.9838734 -3.0657534 #>  [7] -2.9793269  8.4302881 -6.3098904 -2.0689616 #> attr(,\"noise\") #> Noise type - normal #> Noise parameters:  #>     sigma = 5"},{"path":"https://davidbolin.github.io/ngme2/reference/traceplot.html","id":null,"dir":"Reference","previous_headings":"","what":"Trace plot of ngme fitting — traceplot","title":"Trace plot of ngme fitting — traceplot","text":"Trace plot ngme fitting","code":""},{"path":"https://davidbolin.github.io/ngme2/reference/traceplot.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Trace plot of ngme fitting — traceplot","text":"","code":"traceplot(ngme, parameter, f_index = 0, param_index = 1, transform = identity)"},{"path":"https://davidbolin.github.io/ngme2/reference/traceplot.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Trace plot of ngme fitting — traceplot","text":"ngme ngme object parameter parameter name f_index index process, 0 stands fixed effects measurement noise param_index paramter index non-stationary transform transformation","code":""},{"path":"https://davidbolin.github.io/ngme2/reference/traceplot.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Trace plot of ngme fitting — traceplot","text":"traceplot","code":""},{"path":"https://davidbolin.github.io/ngme2/news/index.html","id":"ngme2-development-version","dir":"Changelog","previous_headings":"","what":"ngme2 (development version)","title":"ngme2 (development version)","text":"First version package","code":""}]
