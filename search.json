[{"path":"https://davidbolin.github.io/ngme2/articles/Installation_and_configuration.html","id":"mac-os-x","dir":"Articles","previous_headings":"","what":"Mac OS X","title":"Installation and configuration","text":"Mac OS X system, default C++ compiler OS X support OpenMP. order make use OpenMP enable multi-threading OS X, need use compilers supports OpneMP.","code":"➜ clang -fopenmp hello.cpp clang: error: unsupported option '-fopenmp'"},{"path":"https://davidbolin.github.io/ngme2/articles/Installation_and_configuration.html","id":"install-a-openmp-supported-clang-as-default-cc-compiler-","dir":"Articles","previous_headings":"Mac OS X","what":"1. Install a OpenMP supported clang as default C/C++ compiler.","title":"Installation and configuration","text":"’s need install another compiler supports OpenMP. use homebrew installing llvm clang compiler using following scripts. (Check homebrew can just run following command install homebrew.) successful, able see following prompt. make llvm clang default compiler, need update PATH variable, reopen terminal make work: Now able use llvm clang OpenMP support. Let’s test : case, llvm lib include folder already added default clang search path. (can check search path run commands like clang hello.cpp -v, otherwise may need include mannually -L -, can also export system variable suggested, use makefile compile).","code":"/bin/bash -c \"$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/HEAD/install.sh)\" ➜ brew install llvm  ... To use the bundled libc++ please add the following LDFLAGS:   LDFLAGS=\"-L/usr/local/opt/llvm/lib/c++ -Wl,-rpath,/usr/local/opt/llvm/lib/c++\"  llvm is keg-only, which means it was not symlinked into /usr/local, because macOS already provides this software and installing another version in parallel can cause all kinds of trouble.  If you need to have llvm first in your PATH, run:   echo 'export PATH=\"/usr/local/opt/llvm/bin:$PATH\"' >> ~/.zshrc  For compilers to find llvm you may need to set:   export LDFLAGS=\"-L/usr/local/opt/llvm/lib\"   export CPPFLAGS=\"-I/usr/local/opt/llvm/include\" ➜ echo 'export PATH=\"/usr/local/opt/llvm/bin:$PATH\"' >> ~/.zshrc ➜ clang -fopenmp hello.cpp"},{"path":"https://davidbolin.github.io/ngme2/articles/Installation_and_configuration.html","id":"configure-the-r-environment-to-make-use-of-the-new-compiler-","dir":"Articles","previous_headings":"Mac OS X","what":"2. Configure the R environment to make use of the new compiler.","title":"Installation and configuration","text":"Next want use OpenMP R code (maybe exported R function using Rcpp package), make sure R call new compiler, original one. , can mannually set Makeconf file (makefile configuration R) $R_HOME/etc/Makeconf. can check R_HOME address using R.home() R termnial. case, R called compiler still default clang, explicitly replace . Replace configuration lines following (llvm clang installed): Now able use OpenMP facility (multiple chain estimation) ngme2.","code":"R.home() ## [1] \"/Library/Frameworks/R.framework/Resources\" CC = /usr/local/opt/llvm/bin/clang CXX = /usr/local/opt/llvm/bin/clang++ CXX11 = $(CXX) CXX14 = $(CXX) CXX17 = $(CXX) CXX20 = $(CXX) SHLIB_OPENMP_CFLAGS = -fopenmp SHLIB_OPENMP_CXXFLAGS = -fopenmp"},{"path":"https://davidbolin.github.io/ngme2/articles/SPDE-approach.html","id":"gaussian-process-in-geostatistics","dir":"Articles","previous_headings":"","what":"Gaussian process in geostatistics","title":"SPDE approach with non-Gaussian noise","text":"Gaussian process random fields long history, covering different methods representing spatial spatial-temporal dependence structures. Gaussian fields (GF) dominant role spatial statistics especially traditional field geostatistics. common geostatistical model given \\[ Y_i = x(\\mathbf{s}_i) + \\varepsilon_i, \\quad =1,\\ldots,N, \\quad \\varepsilon_i\\sim N(0, \\sigma^2),\\] \\[x(\\mathbf{s}) \\sim GP\\left(\\sum_{k=1}^{n_b} b_k(\\mathbf{s})w_k, c(\\mathbf{s},\\mathbf{s}')\\right),\\] \\(N\\) number spatial observations, \\(GP(m,c)\\) stands Gaussian process mean function \\(m\\) covariance function \\(c\\), \\(n_b\\) number basis functions, \\(\\{b_k(\\cdot)\\}_{k=1}^{n_b}\\) basis functions, \\(w_k\\) weights estimated \\(c(\\cdot,\\cdot)\\) covariance function. popular flexible covariance function random fields \\(\\mathbb{R}^d\\) Matérn covariance function: \\[ c(\\mathbf{s}, \\mathbf{s}') = \\frac{\\sigma^2}{\\Gamma(\\nu)2^{\\nu-1}}(\\kappa \\|\\mathbf{s}-\\mathbf{s}'\\|)^\\nu K_\\nu(\\kappa\\|\\mathbf{s}-\\mathbf{s}'\\|), \\] \\(\\Gamma(\\cdot)\\) Gamma function, \\(K_\\nu(\\cdot)\\) modified Bessel function second kind, \\(\\nu>0\\) controls correlation range \\(\\sigma^2\\) variance. Finally, \\(\\nu>0\\) determines smoothness field. Usually, model parameters estimated via maximum likelihood estimation. main drawback approach computational time needed order perform statistical inference usually scales \\(\\mathcal{O}(N^3)\\).","code":""},{"path":"https://davidbolin.github.io/ngme2/articles/SPDE-approach.html","id":"the-spde-approach-with-gaussian-noise","dir":"Articles","previous_headings":"Gaussian process in geostatistics","what":"The SPDE approach with Gaussian noise","title":"SPDE approach with non-Gaussian noise","text":"well-known (Whittle, 1963) Gaussian process \\(u(\\mathbf{s})\\) Matérn covariance function solves stochastic partial differential equation (SPDE) \\[\\begin{equation}\\label{spde} (\\kappa^2 -\\Delta)^\\beta u = \\mathcal{W}\\quad \\hbox{} \\mathcal{D}, \\end{equation}\\] \\(\\Delta = \\sum_{=1}^d \\frac{\\partial^2}{\\partial_{x_i^2}}\\) Laplacian operator, \\(\\mathcal{W}\\) Gaussian spatial white noise \\(\\mathcal{D}=\\mathbb{R}^d\\), \\(4\\beta = 2\\nu + d\\). Inspired relation Gaussian processes Matérn covariance functions solutions SPDE, Lindgren et al. (2011) constructed computationally efficient Gaussian Markov random field approximations \\(u(\\mathbf{s})\\), domain \\(\\mathcal{D}\\subsetneq \\mathbb{R}^d\\) bounded \\(2\\beta\\\\mathbb{N}\\). approximate solutions SPDE obtained finite element discretization.","code":""},{"path":"https://davidbolin.github.io/ngme2/articles/SPDE-approach.html","id":"finite-element-approximation","dir":"Articles","previous_headings":"Gaussian process in geostatistics","what":"Finite element approximation","title":"SPDE approach with non-Gaussian noise","text":"now provide brief description finite element method used. make description simpler consider nonfractional SPDE given \\[(\\kappa^2 - \\Delta) u(\\mathbf{s}) = \\mathcal{W}(\\mathbf{s}),\\] bounded domain \\(\\mathcal{D}\\) \\(\\mathbb{R}^d\\). Laplacian operator augmented boundary conditions. Usually one considers Dirichlet, process zero boundary \\(\\mathcal{D}\\), Neumann, directional derivarives process normal directions zero boundary \\(\\mathcal{D}\\). equation interpreted following weak sense: every function \\(\\psi(\\mathbf{s})\\) suitable space test functions, following identity holds \\[\\langle \\psi, (\\kappa^2-\\Delta)u\\rangle_{\\mathcal{D}} \\stackrel{d}{=} \\langle \\psi, \\mathcal{W}\\rangle_{\\mathcal{D}},\\] \\(\\stackrel{d}{=}\\) means equality distribution \\(\\langle\\cdot,\\cdot\\rangle_{\\mathcal{D}}\\) standard inner product \\(L_2(\\mathcal{D})\\), \\(\\langle f,g\\rangle_{\\mathcal{D}} = \\int_\\mathcal{D} f(\\mathbf{s})g(\\mathbf{s}) d\\mathbf{s}.\\) finite element method (FEM) consists considering finite dimensional space test functions \\(V_n\\). Galerkin method, consider \\(V_n = {\\rm span}\\{\\varphi_1,\\ldots,\\varphi_n\\}\\), \\(\\varphi_i(\\mathbf{s}), =1,\\ldots, n\\) piecewise linear basis functions obtained triangulation \\(\\mathcal{D}\\). , write approximate solution \\(u\\) \\(u_n\\), \\(u_n\\) written terms basis functions \\[u_n(\\mathbf{s}) = \\sum_{=1}^n w_i \\varphi_i(\\mathbf{s}).\\] thus obtain system linear equations \\[\\left\\langle \\varphi_j, (\\kappa^2 - \\Delta)\\left(\\sum_{=1}^n w_i\\varphi_i\\right)\\right\\rangle_{\\mathcal{D}} \\stackrel{d}{=} \\langle \\varphi_j, \\mathcal{W}\\rangle_{\\mathcal{D}},\\quad\\hbox{} j=1,\\ldots,n.\\] right hand side can shown \\[(\\langle \\varphi_1, \\mathcal{W}\\rangle_{\\mathcal{D}}, \\ldots, \\langle \\varphi_n, \\mathcal{W}\\rangle_{\\mathcal{D}}) \\sim N(0, \\mathbf{C}),\\] \\(\\mathbf{C}\\) \\(n\\times n\\) matrix \\((,j)\\)th entry given \\[\\mathbf{C}_{,j} = \\int_{\\mathcal{D}} \\varphi_i(\\mathbf{s})\\varphi_j(\\mathbf{s}) d\\mathbf{s}.\\] matrix \\(\\mathbf{C}\\) known mass matrix FEM theory. using Green’s first identity, left hand side \\[ \\begin{array}{ccl} \\left\\langle \\varphi_j, (\\kappa^2 - \\Delta)\\left(\\sum_{=1}^n w_i\\varphi_i\\right)\\right\\rangle_{\\mathcal{D}} &=& \\sum_{=1}^n \\langle \\varphi_j, (\\kappa^2 - \\Delta)w_i\\varphi_i\\rangle_{\\mathcal{D}}\\\\ &=& \\sum_{=1}^n (\\kappa^2 \\langle \\varphi_j, \\varphi_i\\rangle_{\\mathcal{D}} + \\langle \\nabla \\varphi_j, \\nabla \\varphi_i\\rangle_{\\mathcal{D}}) w_i, \\quad j=1,\\ldots, n, \\end{array} \\] boundary terms vanish due boundary conditions (Dirichlet Neumann). can rewrite last term matrix form \\[(\\kappa^2 \\mathbf{C} + \\mathbf{G})\\mathbf{w},\\] \\(\\mathbf{w} = (w_1,\\ldots,w_n)\\) \\(\\mathbf{G}\\) \\(n\\times n\\) matrix \\((,j)\\)th entry given \\[\\mathbf{G}_{,j} = \\int_{\\mathcal{D}} \\nabla \\varphi_i(\\mathbf{s})\\nabla\\varphi_j(\\mathbf{s})d\\mathbf{s}.\\] matrix \\(\\mathbf{G}\\) known FEM theory stiffness matrix. Putting everything together, \\[(\\kappa^2 \\mathbf{C} + \\mathbf{G}) \\mathbf{w} \\sim N(0,\\mathbf{C}).\\] Therefore, \\(\\mathbf{w}\\) centered Gaussian variable precision matrix given \\[\\mathbf{Q} = (\\kappa^2 \\mathbf{C}+\\mathbf{G})^\\top \\mathbf{C}^{-1}(\\kappa^2 \\mathbf{C}+\\mathbf{G}).\\]","code":""},{"path":"https://davidbolin.github.io/ngme2/articles/SPDE-approach.html","id":"computational-advantages-of-the-spde-approach","dir":"Articles","previous_headings":"Gaussian process in geostatistics","what":"Computational advantages of the SPDE approach","title":"SPDE approach with non-Gaussian noise","text":"spatial problems, computational cost usually scales \\(\\mathcal{O}(n^{3/2})\\), \\(n\\) number basis functions. compared \\(\\mathcal{O}(N^3)\\) Gaussian random field approach. implies accurate approximations drastically reduces computational cost sampling inference.","code":""},{"path":"https://davidbolin.github.io/ngme2/articles/SPDE-approach.html","id":"the-spde-approach-with-non-gaussian-noise","dir":"Articles","previous_headings":"","what":"The SPDE approach with non-Gaussian noise","title":"SPDE approach with non-Gaussian noise","text":"describe generalize approach non-Gaussian noise. goal now describe SPDE approach noise non-Gaussian. motivation handling non-Gaussian noise comes fact many features handled Gaussian noise. reasons : Skewness; Heavier tails; Jumps sample paths; Asymmetries sample paths.","code":""},{"path":"https://davidbolin.github.io/ngme2/articles/SPDE-approach.html","id":"non-gaussian-matérn-fields","dir":"Articles","previous_headings":"The SPDE approach with non-Gaussian noise","what":"Non-Gaussian Matérn fields","title":"SPDE approach with non-Gaussian noise","text":"idea replace Gaussian white noise \\(\\mathcal{W}\\) SPDE non-Gaussian white noise \\(\\dot{\\mathcal{M}}\\): \\[(\\kappa^2 - \\Delta)^\\beta u = \\dot{\\mathcal{M}}.\\] solution \\(u\\) Matérn covariance function, marginal distributions non-Gaussian. consider setup. precisely, consider \\(V_n = {\\rm span}\\{\\varphi_1,\\ldots,\\varphi_n\\}\\), \\(\\varphi_i(\\mathbf{s}), =1,\\ldots, n\\) piecewise linear basis functions obtained triangulation \\(\\mathcal{D}\\) approximate solution \\(u\\) \\(u_n\\), \\(u_n\\) written terms basis functions \\[u_n(\\mathbf{s}) = \\sum_{=1}^n w_i \\varphi_i(\\mathbf{s}).\\] right-hand side obtain random vector \\[\\mathbf{f} = (\\dot{\\mathcal{M}}(\\varphi_1),\\ldots, \\dot{\\mathcal{M}}(\\varphi_n)),\\] functional \\(\\dot{\\mathcal{M}}\\) given \\[\\dot{\\mathcal{M}}(\\varphi_j) = \\int_{\\mathcal{D}} \\varphi_j(\\mathbf{s}) d\\mathcal{M}(\\mathbf{s}).\\] considering \\(\\mathcal{M}\\) type-G Lévy process, obtain \\(\\mathbf{f}\\) joint distribution easy handle. say Lévy process type G increments can represented location-scale mixtures: \\[\\gamma + \\mu V + \\sigma \\sqrt{V}Z,\\] \\(\\gamma, \\mu\\) parameters, \\(Z\\sim N(0,1)\\) independent \\(V\\), \\(V\\) positive infinitely divisible random variable. Therefore, given vector \\(\\mathbf{V} = (V_1,\\ldots,V_n)\\) independent stochastic variances (case, positive infinitely divisible random variables), obtain \\[\\mathbf{f}|\\mathbf{V} \\sim N(\\gamma + \\mu\\mathbf{V}, \\sigma^2{\\rm diag}(\\mathbf{V})).\\] , consider, instance, non-fractional non-Gaussian SPDE \\[(\\kappa^2 - \\Delta) u = \\dot{\\mathcal{M}},\\] obtain FEM weights \\(\\mathbf{w} = (w_1,\\ldots,w_n)\\) satisfy \\[\\mathbf{w}|\\mathbf{V} \\sim N(\\mathbf{K}^{-1}(\\gamma+\\mu\\mathbf{V}), \\sigma^2\\mathbf{K}^{-1}{\\rm diag}(\\mathbf{V})\\mathbf{K}^{-1}),\\] \\(\\mathbf{K} = \\kappa^2\\mathbf{C}+\\mathbf{G}\\) discretization differential operator.","code":""},{"path":"https://davidbolin.github.io/ngme2/articles/SPDE-approach.html","id":"the-nig-model","dir":"Articles","previous_headings":"The SPDE approach with non-Gaussian noise","what":"The NIG model","title":"SPDE approach with non-Gaussian noise","text":"delve details now considering, example, NIG model. First, say random variable \\(V\\) follows inverse Gaussian distribution parameters \\(\\eta_1\\) \\(\\eta_2\\), denoted \\(V\\sim IG(\\eta_1,\\eta_2)\\) probability density function (pdf) given \\[\\pi(v) = \\frac{\\sqrt{\\eta_2}}{\\sqrt{2\\pi v^3}} \\exp\\left\\{-\\frac{\\eta_1}{2}v - \\frac{\\eta_2}{2v} + \\sqrt{\\eta_1\\eta_2}\\right\\},\\quad \\eta_1,\\eta_2>0.\\] can generate samples inverse Gaussian distributions parameters \\(\\eta_1\\) \\(\\eta_2\\) generating samples generalized inverse Gaussian distribution parameters \\(p=-1/2\\), \\(=\\eta_1\\) \\(b=\\eta_2\\). can use rGIG function generate samples generalized inverse Gaussian distribution. \\(V\\sim IG(\\eta_1,\\eta_2)\\), \\(X = \\gamma +\\mu V + \\sigma \\sqrt{V}Z\\), \\(Z\\sim N(0,1)\\), independent \\(V\\), \\(X\\) follows normal inverse Gaussian (NIG) distribution pdf \\[\\pi(x) = \\frac{e^{\\sqrt{\\eta_1\\eta_2}+\\mu(x-\\gamma)/\\sigma^2}\\sqrt{\\eta_2\\mu^2/\\sigma^2+\\eta_1\\eta_2}}{\\pi\\sqrt{\\eta_2\\sigma^2+(x-\\gamma)^2}} K_1\\left(\\sqrt{(\\eta_2\\sigma^2+(x-\\gamma)^2)(\\mu^2/\\sigma^4+\\eta_1/\\sigma^2)}\\right),\\] \\(K_1\\) modified Bessel function third kind. form, NIG density overparameterized, therefore set \\(\\eta_1=\\eta_2=\\eta\\), results \\(E(V)=1\\). Thus, one parameters, \\(\\mu, \\gamma\\) \\(\\eta\\). NIG model thus assumes stochastic variance \\(V_i\\) follows inverse Gaussian parameters \\(\\eta\\) \\(\\eta h_i^2\\), \\(h_i = \\int_{\\mathcal{D}} \\varphi_i(\\mathbf{s}) d\\mathbf{s}.\\)","code":""},{"path":"https://davidbolin.github.io/ngme2/articles/SPDE-approach.html","id":"prediction","dir":"Articles","previous_headings":"The SPDE approach with non-Gaussian noise","what":"Prediction","title":"SPDE approach with non-Gaussian noise","text":"goal section perform prediction latent field \\(u\\) locations observations. Usually, predictions, one provides mean variance predictive distribution. Let us assume want obtain predictions locations \\(\\widetilde{\\mathbf{s}}_1, \\ldots, \\widetilde{\\mathbf{s}}_p \\\\mathcal{D}\\), \\(p\\\\mathbb{N}\\). Notice \\(j=1,\\ldots,p\\), \\[u_n(\\widetilde{\\mathbf{s}}_j) = \\sum_{=1}^n w_i \\varphi_i(\\widetilde{\\mathbf{s}}_j).\\] Therefore, let \\(\\mathbf{}_p\\) \\(p\\times n\\) matrix whose \\((,j)\\)th entry given \\(\\mathbf{}_{p,ij} = \\varphi_j(\\widetilde{\\mathbf{s}}_i)\\), \\[(u_n(\\widetilde{\\mathbf{s}}_1),\\ldots, u_n(\\widetilde{\\mathbf{s}}_p)) = \\mathbf{}_p\\mathbf{w}.\\] Thus, perform prediction desired means variances \\[E[\\mathbf{}_p \\mathbf{w}  | \\mathbf{Y}]\\quad\\hbox{}\\quad V[\\mathbf{}_p\\mathbf{w}|\\mathbf{Y}],\\] \\(\\mathbf{Y} = (Y_1,\\ldots,Y_N).\\) Now, observe density \\(\\mathbf{w}|\\mathbf{Y}\\) known. , mean variance computed analytically. two ways circumvent situation. based fact even though know density \\(\\mathbf{w}|\\mathbf{Y}\\), know density \\(\\mathbf{V}|\\mathbf{w},\\mathbf{Y}\\) density \\(\\mathbf{w}|\\mathbf{V},\\mathbf{Y}\\). Therefore can use Gibbs sampler sample \\((\\mathbf{w},\\mathbf{V})|\\mathbf{Y}\\). obtain, byproduct, marginal samples \\(\\mathbf{w}|\\mathbf{Y}\\) \\(\\mathbf{V}|\\mathbf{Y}\\). now provide brief presentation Gibbs sampler provide approximations means variances.","code":""},{"path":"https://davidbolin.github.io/ngme2/articles/SPDE-approach.html","id":"gibbs-sampler","dir":"Articles","previous_headings":"The SPDE approach with non-Gaussian noise","what":"Gibbs sampler","title":"SPDE approach with non-Gaussian noise","text":"section, briefly describe Gibbs sampler algorithm use. Let \\(\\mathbf{}\\) \\(N\\times n\\) matrix, whose \\((,j)\\)th entry given \\(\\mathbf{}_{ij} = \\varphi_j(\\mathbf{s}_i)\\). Therefore, \\[(u_n(\\mathbf{s}_1),\\ldots,u_n(\\mathbf{s}_N)) = \\mathbf{}\\mathbf{w},\\] \\[\\mathbf{Y} = \\mathbf{}\\mathbf{w} + \\boldsymbol{\\varepsilon},\\] \\(\\boldsymbol{\\varepsilon} = (\\varepsilon_1,\\ldots,\\varepsilon_N)\\) measurement noise. assumen \\(\\varepsilon\\) Gaussian noise. Therefore, assumption \\[\\mathbf{Y}|\\mathbf{w} \\sim N(\\mathbf{}\\mathbf{w}, \\sigma_\\varepsilon^{2} \\mathbf{}).\\] Also recall \\[\\mathbf{w}|\\mathbf{V} \\sim N(\\mathbf{K}^{-1}(-\\mu \\mathbf{h}+\\mu\\mathbf{V}), \\sigma^2\\mathbf{K}^{-1}{\\rm diag}(\\mathbf{V})\\mathbf{K}^{-1}).\\] Let \\[\\mathbf{m} = \\mathbf{K}^{-1}(-\\mu \\mathbf{h}+\\mu\\mathbf{V})\\quad \\hbox{}\\quad \\mathbf{Q} = \\frac{1}{\\sigma^2}\\mathbf{K}{\\rm diag}(\\mathbf{V})^{-1}\\mathbf{K}.\\] thus follows (see, also, Wallin Bolin (2015) Asar et al. (2020)) \\[\\mathbf{w} | \\mathbf{V}, \\mathbf{Y} \\sim N\\big(\\widetilde{\\mathbf{m}}, \\widetilde{\\mathbf{Q}}^{-1}),\\] \\[\\widetilde{\\mathbf{Q}} = \\mathbf{Q} + \\sigma_\\varepsilon^{-2} \\mathbf{}^\\top\\mathbf{}\\quad\\hbox{}\\quad \\widetilde{\\mathbf{m}} = \\widetilde{\\mathbf{Q}}^{-1}\\big(\\mathbf{Q}\\mathbf{m}+\\sigma_\\varepsilon^{-2}\\mathbf{}^\\top\\mathbf{Y}\\big).\\] compute conditional distribution \\(\\mathbf{V}|\\mathbf{w}, \\mathbf{Y}\\) one can see Wallin Bolin (2015), pp. 879, \\(V_1,\\ldots,V_n\\) conditionally independent given \\(\\mathbf{w}\\). Furthermore, also Proposition 1 Asar et al. (2020)) \\(V\\sim GIG(p,,b)\\), \\(GIG\\) stands generalized inverse Gaussian distribution parameters \\(p, \\) \\(b\\), , every \\(j=1,\\ldots,n\\), \\[V_j|\\mathbf{w},\\mathbf{Y} \\sim GIG\\Bigg(p-0.5, +\\frac{\\mu^2}{\\sigma^2}, b + \\frac{(\\mathbf{K}\\mathbf{w}+\\mathbf{h}\\mu)_j^2}{\\sigma^2}\\Bigg).\\] now position use Gibbs sampling algorithm: Provide initial values \\(\\mathbf{V}^{(0)}\\); Sample \\(\\mathbf{w}^{(1)} | \\mathbf{V}^{(0)},\\mathbf{Y}\\); Sample \\(\\mathbf{V}^{(1)} | \\mathbf{w}^{(1)}, \\mathbf{Y}\\); Continue sequentially sampling \\(\\mathbf{w}^{()}|\\mathbf{V}^{(-1)},\\mathbf{Y}\\), \\(\\mathbf{V}^{()}|\\mathbf{w}^{()}, \\mathbf{Y}\\) \\(=1,\\ldots,k\\). One stop equilibrium reached. obtain evidence equilibrium achieved, best consider one chain, starting different locations, see mixed well. might also useful see autocorrelation plots. Depending starting values, one might consider burn-samples, , one runs chain iterations, saves last position, throw away rest samples, use starting values. important observe samples \\(\\{\\mathbf{w}^{()},\\mathbf{V}^{()}\\}_{=1}^k\\) independent. However, general assumptions, Gibbs sampler provides samples satisfying law large numbers functionals sample. Therefore, one can use samples compute means variances.","code":""},{"path":"https://davidbolin.github.io/ngme2/articles/SPDE-approach.html","id":"estimation","dir":"Articles","previous_headings":"The SPDE approach with non-Gaussian noise","what":"Estimation","title":"SPDE approach with non-Gaussian noise","text":"ngme2, use maximum likelihood estimation via preconditioned stochastic gradient descent. gradient approximated ","code":""},{"path":"https://davidbolin.github.io/ngme2/articles/SPDE-approach.html","id":"standard-mc-approximation-of-the-gradient","dir":"Articles","previous_headings":"The SPDE approach with non-Gaussian noise > Estimation","what":"Standard MC approximation of the gradient","title":"SPDE approach with non-Gaussian noise","text":"context, assume \\(\\mathbf{w}\\) \\(\\mathbf{V}\\) hidden. Therefore, may use Fisher’s identity (Fisher, 1925) latent variable \\((\\mathbf{V},\\mathbf{w})\\) obtain \\[\\nabla_{\\boldsymbol{\\theta}} L({\\boldsymbol{\\theta}}; \\mathbf{Y}) = E_{\\mathbf{V},\\mathbf{w}}[\\nabla_{\\boldsymbol{\\theta}} L({\\boldsymbol{\\theta}}; \\mathbf{Y}, \\mathbf{V}, \\mathbf{w})|\\mathbf{Y}].\\] Thus, idea use samples \\(\\mathbf{V}\\) \\(\\mathbf{w}\\) obtained Gibbs sampler approximate gradient \\[\\nabla_{{\\boldsymbol{\\theta}}}L({\\boldsymbol{\\theta}};\\mathbf{Y}) \\approx \\frac{1}{k} \\sum_{j=1}^k \\nabla_{{\\boldsymbol{\\theta}}} L({\\boldsymbol{\\theta}};\\mathbf{Y},\\mathbf{V}^{(j)}, \\mathbf{w}^{(j)}).\\] end, compute gradients \\(\\nabla_{{\\boldsymbol{\\theta}}} L({\\boldsymbol{\\theta}};\\mathbf{Y},\\mathbf{V}, \\mathbf{w})\\). \\[\\mathbf{Y}|\\mathbf{w} \\sim N(\\mathbf{}\\mathbf{w}, \\sigma_\\varepsilon^{-2} \\mathbf{}),\\] \\[\\mathbf{w}|\\mathbf{V} \\sim N(\\mathbf{K}^{-1}(-\\mu \\mathbf{h}+\\mu\\mathbf{V}), \\sigma^2 \\mathbf{K}^{-1}{\\rm diag}(\\mathbf{V})\\mathbf{K}^{-1})\\] \\(\\mathbf{V}\\) follows GIG distribution every \\(\\), \\(E[V_i]=h_i\\). Therefore, \\[\\begin{array}{ccl} L((\\mu,\\sigma_\\varepsilon); \\mathbf{w}, \\mathbf{V},\\mathbf{Y}) &=& -n\\log(\\sigma_\\varepsilon)-0.5\\sigma_\\varepsilon^{-2} (\\mathbf{Y} - \\mathbf{}\\mathbf{K}^{-1}(-\\mu \\mathbf{h}+\\mu\\mathbf{V}))\\\\ &-&0.5\\sigma_\\varepsilon^{-2}(\\mathbf{}(\\mathbf{w}-\\mathbf{m})^\\top{\\rm diag} (1/(\\sigma^2 V_i)) (\\mathbf{Y} - \\mathbf{}\\mathbf{K}^{-1}(-\\mu \\mathbf{h}+\\mu\\mathbf{V})-\\mathbf{}(\\mathbf{w}-\\mathbf{m})) + const, \\end{array}\\] \\(const\\) depend \\((\\mu,\\sigma)\\).","code":""},{"path":"https://davidbolin.github.io/ngme2/articles/SPDE-approach.html","id":"references","dir":"Articles","previous_headings":"","what":"References","title":"SPDE approach with non-Gaussian noise","text":"Lindgren, F., Rue, H., Lindstrom, J. (2011). explicit link Gaussian fields Gaussian Markov random fields: stochastic partial differential equation approach. Journal Royal Statistical Society: Series B (Statistical Methodology), 73(4):423–498. Whittle, P. (1963). Stochastic-processes several dimensions. Bulletin International Statistical Institute, 40(2):974–994. Wallin, J., Bollin, D. (2015). Geostatistical Modelling Using Non-Gaussian Matérn Fields. Scandinavian Journal Statistics. 42(3):872-890.","code":""},{"path":"https://davidbolin.github.io/ngme2/articles/ngme2.html","id":"introduction","dir":"Articles","previous_headings":"","what":"Introduction","title":"Ngme2 - A new Flexible R Package for Latent non-Gaussian Models","text":"vignette provide brief introduction ngme2 package. ngme2 updated version ngme (https://github.com/davidbolin/ngme), package estimating latent non-Gaussian models. follows 3-layer structure design (general block model, latent process models, noises) specifying whole statistical model. latent process defines different operator structure, block model collects together fixed effects measurement noise.","code":""},{"path":"https://davidbolin.github.io/ngme2/articles/ngme2.html","id":"features","dir":"Articles","previous_headings":"Introduction","what":"1 Features","title":"Ngme2 - A new Flexible R Package for Latent non-Gaussian Models","text":"Support spatial models like Matern model non-Gaussian noise. Support models temporal data like AR1 random walk order 1 2. Support replicates locations. Support prediction unknown locations. Comparing previous version, now supports multiple stochastic processes latent model.","code":""},{"path":"https://davidbolin.github.io/ngme2/articles/ngme2.html","id":"model-framework","dir":"Articles","previous_headings":"Introduction","what":"2 Model Framework","title":"Ngme2 - A new Flexible R Package for Latent non-Gaussian Models","text":"package ngme2 provides methods mixed effect models single response variable case multivariate response case (yet). 1.single response case, following form: \\[ \\begin{aligned} Y = {\\bf X}^{\\top} {\\bf \\beta} + \\sum_j {\\bf }_j W_j({\\bf t}) + \\epsilon. \\end{aligned} \\] , \\(Y\\) response variable, \\({\\bf X}\\) matrix fixed effects explanatory variables, \\({\\bf \\beta}\\) matrix fixed effects coefficients, \\({\\bf }_j\\) observation matrix process, \\(W_j(t_j)\\) specified stochastic process, \\(\\epsilon\\) measurement error. , process \\(W\\) follows \\({\\bf K} W = z\\), \\(z\\) either Gaussian non-Gaussian noise. \\({\\bf K}\\) operator matrix. simple template using core function ngme model single response: , function f modeling stochastic process W Gaussian non-Gaussian noise, discuss later. noise stands measurement noise distribution. case, model Gaussian likelihood. multivariate response case, following form: another template using core function ngme model bivariate response:","code":"ngme(   formula=Y ~ x1 + x2 + f(index, model=\"ar\", noise=\"nig\"),   data=data.frame(Y=Y, x1=x1, x2=x2, index=index),   noise = noise_normal() ) ngme(   formula=Y1 | Y2 ~ x1 + x2 + f(index, model=\"ar\", noise=\"nig\") | f(time, model=\"matern\"),   data=data.frame(Y=Y, x1=x1, x2=x2, index=index, time=time),   family=\"normal\" )"},{"path":"https://davidbolin.github.io/ngme2/articles/ngme2.html","id":"non-gaussian-model","dir":"Articles","previous_headings":"Introduction","what":"3 Non-Gaussian Model","title":"Ngme2 - A new Flexible R Package for Latent non-Gaussian Models","text":"assume non-Gaussian process type-G Lévy process, whose increments can represented location-scale mixtures: \\[\\gamma + \\mu V + \\sigma \\sqrt{V}Z,\\] \\(\\gamma, \\mu, \\sigma\\) parameters, \\(Z\\sim N(0,1)\\) independent \\(V\\), \\(V\\) positive infinitely divisible random variable. results following form, \\(K\\) operator part: \\[ KW|V \\sim N(\\gamma + \\mu V, \\sigma^2 \\, diag(V)), \\] also, \\(\\mu\\) \\(\\sigma\\) can non-stationary. ngme2, focus mainly normal inverse Gaussian (NIG) model. See ?nig details.","code":""},{"path":"https://davidbolin.github.io/ngme2/articles/ngme2.html","id":"parameter-estimation","dir":"Articles","previous_headings":"Introduction","what":"4 Parameter Estimation","title":"Ngme2 - A new Flexible R Package for Latent non-Gaussian Models","text":"Ngme2 maximum likelihood estimation preconditioned stochastic gradient descent. Multiple chains run parallel better convergence checks.","code":""},{"path":[]},{"path":"https://davidbolin.github.io/ngme2/articles/ngme2.html","id":"specify-noise-with-ngme_noise-object","dir":"Articles","previous_headings":"Ngme Model Structure","what":"Specify noise with ngme_noise object","title":"Ngme2 - A new Flexible R Package for Latent non-Gaussian Models","text":"ngme_noise object fundamental structure ngme2. object used specify driving noise stochastic process measurement noise. now support two noises, one normal noise, NIG noise. R class ngme_noise following interface: 3rd example non-stationary NIG noise, \\(\\mu = \\bf B_{\\mu} \\bf \\theta_{\\mu}\\), \\(\\sigma = \\exp(\\bf B_{\\sigma} \\bf \\theta_{\\sigma})\\). construct following noise structure: \\[   - \\mathbf{\\mu} + \\mathbf{\\mu} V + \\mathbf{\\sigma} \\sqrt{V} Z \\] \\(\\mu = \\bf B_{\\mu} \\bf \\theta_{\\mu}\\), \\(\\sigma = \\exp(\\bf B_{\\sigma} \\bf \\theta_{\\sigma})\\). case, can recover gaussian noise setting type=“normal ignoring theta_mu theta_V. can simply use helper function noise_normal(sd=1)","code":"library(ngme2)  noise_normal(sigma = 1)                 # normal noise #> Noise type - normal #> Noise parameters:  #>     sigma = 1 noise_nig(mu = 1, sigma = 2, nu = 1) # nig noise #> Noise type - nig #> Noise parameters:  #>     mu = 1 #>     sigma = 2 #>     nu = 1 noise_nig(            # non-stationary nig noise   B_mu=matrix(c(1:10), ncol=2),   theta_mu = c(1, 2),   B_sigma=matrix(c(1:10), ncol=2),   theta_sigma = c(1,2),   nu = 1) #> Noise type - nig #> Noise parameters:  #>     theta_mu = 1, 2 #>     theta_sigma = 1, 2 #>     nu = 1 ngme_noise(   type,           # the type of noise   theta_mu,       # mu parameter   theta_sigma,    # sigma parameter   theta_V,        # nu parameter   B_mu,           # basis matrix for non-stationary mu   B_sigma         # basis matrix for non-stationary sigma )"},{"path":"https://davidbolin.github.io/ngme2/articles/ngme2.html","id":"specify-stochastic-process-with-f-function","dir":"Articles","previous_headings":"Ngme Model Structure","what":"Specify stochastic process with f function","title":"Ngme2 - A new Flexible R Package for Latent non-Gaussian Models","text":"middle layer stochastic process, R interface, represented f function. process can specified different noise structure. See ?ngme_model_types() details. examples using f function specify ngme_model: One useful model SPDE model Gaussian non-Gaussian noise, see vignette details.","code":"ngme2::f(1:10, model = \"ar1\",   noise = noise_nig(), theta_K = 0.5) #> as(<dgTMatrix>, \"dgCMatrix\") is deprecated since Matrix 1.5-0; do as(., \"CsparseMatrix\") instead #> Ngme model: ar1 #> Model parameters:  #>     alpha = 0.5 #>  #> Noise type - nig #> Noise parameters:  #>     mu = 0 #>     sigma = 1 #>     nu = 1"},{"path":"https://davidbolin.github.io/ngme2/articles/ngme2.html","id":"specifying-latent-models-with-formula-in-ngme","dir":"Articles","previous_headings":"Ngme Model Structure","what":"Specifying latent models with formula in ngme","title":"Ngme2 - A new Flexible R Package for Latent non-Gaussian Models","text":"latent model can specified additively formula argument ngme function together fixed effects. use R formula specify latent model. can specify model using f within formula. example, following formula corresponds model \\[ Y = \\beta_0 + \\beta_1 x_1 + W_1(x_2) + W_2(x_3) + \\epsilon, \\] \\(W_1\\) AR(1) process, \\(W_2\\) random walk 1 process. \\(x_2\\) random effects.. . default, intercept. distribution measurement error \\(\\epsilon\\) given ngme function. entire model can fitted, along specification distribution measurement error ngme function: gives ngme object, three parts: Fixed effects (intercept x1) Measurement noise (normal noise) Latent models (contains 2 models, ar1 rw1) can turn estimation = TRUE start estimating model.","code":"formula <- Y ~ x1 + f(     x2,     model = \"ar1\",     noise = noise_nig(),     theta_K = 0.5   ) + f(     model = model_rw(1:5, order=1, circular = TRUE),     noise = noise_normal()   ) ngme(   formula = formula,   family = noise_normal(sigma = 0.5),   data = data.frame(Y = 1:5, x1 = 2:6, x2 = 3:7),   control = ngme_control(     estimation = FALSE   ) ) #> *** Ngme object *** #>  #> Fixed effects:  #>    beta = -1,  1 #>  #> Measurement noise:  #>   Noise type - normal #>   Noise parameters:  #>       sigma = 0.5 #>  #>  #> Latent models:  #> [[1]] #>   Ngme model: ar1 #>   Model parameters:  #>       alpha = 0.5 #>  #>   Noise type - nig #>   Noise parameters:  #>       mu = 0 #>       sigma = 1 #>       nu = 1 #> [[2]] #>   Ngme model: rw1 #>   Model parameters:  #>       No parameter needed. #>  #>   Noise type - normal #>   Noise parameters:  #>       sigma = 1"},{"path":"https://davidbolin.github.io/ngme2/articles/ngme2.html","id":"a-simple-example---ar1-process-with-nig-noise","dir":"Articles","previous_headings":"","what":"A simple example - AR1 process with nig noise","title":"Ngme2 - A new Flexible R Package for Latent non-Gaussian Models","text":"Now let’s see example AR1 process nig noise. process defined \\[ W_i = \\alpha W_{-1} + \\epsilon_i, \\] , \\(\\epsilon_1, ..,\\epsilon_n\\) iid NIG noise. , easy verify \\[ K{\\bf W} = \\boldsymbol\\epsilon,\\] \\[ K =   \\begin{bmatrix}     \\alpha \\\\     -1 &  \\alpha \\\\     & \\ddots & \\ddots \\\\     & & -1 &  \\alpha   \\end{bmatrix} \\] Now let’s fit model using ngme. can use ngme_control modify control variables ngme. See ?ngme_control optioins. Next can read result directly object. can see, model converges 350 iterations. estimation results close real parameter. can also use traceplot function see estimation traceplot. Parameters AR1 model can also density comparison estimated noise true NIG noise:","code":"n_obs <- 500 sigma_eps <- 0.5 alpha <- 0.5 mu = 2; delta = -mu sigma <- 3 nu <- 1  # First we generate V. V_i follows inverse Gaussian distribution trueV <- ngme2::rig(n_obs, nu, nu, seed = 10)  # Then generate the nig noise noise <- delta + mu*trueV + sigma * sqrt(trueV) * rnorm(n_obs) trueW <- Reduce(function(x,y){y + alpha*x}, noise, accumulate = T) Y = trueW + rnorm(n_obs, mean=0, sd=sigma_eps)  # Add some fixed effects x1 = runif(n_obs) x2 = rexp(n_obs) beta <- c(-3, -1, 2) X <- (model.matrix(Y ~ x1 + x2))  # design matrix Y = as.numeric(Y + X %*% beta) # # Fit the model with the AR1 model ngme_out <- ngme(   Y ~ x1 + x2 + f(     1:n_obs,     model = \"ar1\",     noise = noise_nig(),     theta_K = 0.9  # starting point for the alpha (parameter of K)   ),   data=data.frame(x1=x1, x2=x2, Y=Y),   control = ngme_control(     burnin = 100,     iterations = 1000,     std_lim = 0.4,     gibbs_sample = 5,     n_parallel_chain = 4,     stop_points = 10,     print_check_info = FALSE   ),   seed = 3 ) #> Starting estimation...  #> Total time is (ms): 3712 #> Estimation done! ngme_out #> *** Ngme object *** #>  #> Fixed effects:  #>    beta = -2.91, -1.44,  1.99 #>  #> Measurement noise:  #>   Noise type - normal #>   Noise parameters:  #>       sigma = 0.788 #>  #>  #> Latent models:  #> [[1]] #>   Ngme model: ar1 #>   Model parameters:  #>       alpha = 0.564 #>  #>   Noise type - nig #>   Noise parameters:  #>       mu = 1.86 #>       sigma = 2.82 #>       nu = 0.831 library(ggplot2) library(grid) library(gridExtra) pl <- lapply(c(\"alpha\", \"mu\", \"sigma\", \"nu\"), function(.x)   traceplot(ngme_out, param = .x, f_index = 1)); marrangeGrob(pl, nrow=2, ncol=2) plot(   ngme_out$latents[[1]]$noise,   noise_nig(mu = mu, sigma = sigma, nu = nu) )"},{"path":"https://davidbolin.github.io/ngme2/articles/ngme2.html","id":"paraná-dataset","dir":"Articles","previous_headings":"","what":"Paraná dataset","title":"Ngme2 - A new Flexible R Package for Latent non-Gaussian Models","text":"rainfall data Paraná (Brazil) collected National Water Agency Brazil (Agencia Nacional de Águas, ANA, Portuguese). ANA collects data many locations Brazil, data freely available ANA website (http://www3.ana.gov.br/portal/ANA). briefly illustrate command use, result estimation. Plot data: Mean rainfall Octobor 2012 Paraná","code":"library(INLA) #> Loading required package: Matrix #> Loading required package: foreach #> Loading required package: parallel #> Loading required package: sp #> This is INLA_22.11.22 built 2022-11-22 05:52:45 UTC. #>  - See www.r-inla.org/contact-us for how to get help. #>  - To enable PARDISO sparse library; see inla.pardiso() #>  #> Attaching package: 'INLA' #> The following object is masked from 'package:ngme2': #>  #>     f library(splancs) #>  #> Spatial Point Pattern Analysis Code in S-Plus #>   #>  Version 2 - Spatial and Space-Time analysis library(lattice) library(ggplot2) library(grid) library(gridExtra) library(viridis) #> Loading required package: viridisLite data(PRprec) data(PRborder)  # Create INLA mesh coords <- as.matrix(PRprec[, 1:2]) prdomain <- inla.nonconvex.hull(coords, -0.03, -0.05, resolution = c(100, 100)) prmesh <- inla.mesh.2d(boundary = prdomain, max.edge = c(0.45, 1), cutoff = 0.2)  # monthly mean at each location Y <- rowMeans(PRprec[, 12 + 1:31]) # 2 + Octobor  ind <- !is.na(Y) # non-NA index Y <- Y_mean <- Y[ind] coords <- as.matrix(PRprec[ind, 1:2]) seaDist <- apply(spDists(coords, PRborder[1034:1078, ],   longlat = TRUE ), 1, min) library(ngme2) # leave 0.1 Y as prediction area # n <- length(Y) # ind_pred <- sample(1:n, size = 0.1 * n) # Y_pred <- Y[ind_pred] # Y[ind_pred] <- NA  matern_spde <- model_matern(   loc = coords,   mesh = prmesh )  out <- ngme(   formula = Y ~ 1 +     f(x = inla.group(seaDist), model = \"rw1\", noise = noise_normal()) +     f(model = matern_spde, noise = noise_nig()) +     f(model = matern_spde, noise = noise_normal()),   data = list(     Y = Y   ),   family = noise_nig(),   control = ngme_control(     estimation = T,     iterations = 1000,     n_slope_check = 4,     stop_points = 10,     std_lim = 0.1,     n_parallel_chain = 4,     print_check_info = TRUE   ),   seed = 16 ) #> Starting estimation...  #> begin Constructor of Matern  #> finish Constructor of Matern  #> begin Constructor of Matern  #> finish Constructor of Matern  #> Total time is (ms): 30578 #> Estimation done!  out #> *** Ngme object *** #>  #> Fixed effects:  #>    beta = 9.31 #>  #> Measurement noise:  #>   Noise type - nig #>   Noise parameters:  #>       mu = 0.231 #>       sigma = 1.98 #>       nu = 1.75 #>  #>  #> Latent models:  #> [[1]] #>   Ngme model: rw1 #>   Model parameters:  #>       No parameter needed. #>  #>   Noise type - normal #>   Noise parameters:  #>       sigma = 0.177 #> [[2]] #>   Ngme model: matern #>   Model parameters:  #>       kappa = 4.17 #>  #>   Noise type - nig #>   Noise parameters:  #>       mu = 3.78 #>       sigma = 10.8 #>       nu = 0.164 #> [[3]] #>   Ngme model: matern #>   Model parameters:  #>       kappa = 3.4 #>  #>   Noise type - normal #>   Noise parameters:  #>       sigma = 2.19  # traceplots ## merr, beta traceplot(out, f_index = 0, param = \"sigma\") traceplot(out, f_index = 0, param = \"beta\") ## rw traceplot(out, f_index = 1, param = \"mu\") traceplot(out, f_index = 1, param = \"sigma\") traceplot(out, f_index = 1, param = \"nu\") ## spde traceplot(out, f_index = 2, param = \"kappa\") traceplot(out, f_index = 2, param = \"mu\") traceplot(out, f_index = 2, param = \"sigma\") traceplot(out, f_index = 2, param = \"nu\") ## spde traceplot(out, f_index = 3, param = \"kappa\") traceplot(out, f_index = 3, param = \"sigma\")"},{"path":"https://davidbolin.github.io/ngme2/articles/ngme2.html","id":"prediction","dir":"Articles","previous_headings":"Paraná dataset","what":"Prediction","title":"Ngme2 - A new Flexible R Package for Latent non-Gaussian Models","text":"Model estimation: Estimations model Result optimization trajectory parameters Matern model: Traceplot Matern parameters","code":"nxy <- c(150, 100) projgrid <- rSPDE::rspde.mesh.projector(prmesh,   xlim = range(PRborder[, 1]),   ylim = range(PRborder[, 2]), dims = nxy )  xy.in <- inout(projgrid$lattice$loc, cbind(PRborder[, 1], PRborder[, 2]))  coord.prd <- projgrid$lattice$loc[xy.in, ] plot(coord.prd, type = \"p\", cex = 0.1) lines(PRborder) points(coords[, 1], coords[, 2], pch = 19, cex = 0.5, col = \"red\") seaDist.prd <- apply(spDists(coord.prd,   PRborder[1034:1078, ],   longlat = TRUE ), 1, min)  # construct data n_prd <- nrow(coord.prd) Y2 <- c(Y, rep(NA, n_prd)) seaDist2 <- c(seaDist, seaDist.prd)  matern_spde <- model_matern(   loc = rbind(coords, coord.prd),   mesh = prmesh,   index_NA = is.na(Y2) )  out2 <- ngme(   formula = Y ~ 1 +     f(inla.group(seaDist), model = \"rw1\", noise = noise_normal()) +     f(model = matern_spde, noise = noise_nig()) +     f(model = matern_spde, noise = noise_normal()),   data = list(     Y = Y2,     seaDist = seaDist2   ),   family = noise_nig(),   control = ngme_control(     estimation = F,     iterations = 1000,     n_slope_check = 4,     stop_points = 10,     std_lim = 0.1,     n_parallel_chain = 8,     print_check_info = TRUE   ),   seed = 416,   start = out ) out2 #> *** Ngme object *** #>  #> Fixed effects:  #>    beta = 9.31 #>  #> Measurement noise:  #>   Noise type - nig #>   Noise parameters:  #>       mu = 0.231 #>       sigma = 1.98 #>       nu = 1.75 #>  #>  #> Latent models:  #> [[1]] #>   Ngme model: rw1 #>   Model parameters:  #>       No parameter needed. #>  #>   Noise type - normal #>   Noise parameters:  #>       sigma = 0.177 #> [[2]] #>   Ngme model: matern #>   Model parameters:  #>       kappa = 4.17 #>  #>   Noise type - nig #>   Noise parameters:  #>       mu = 3.78 #>       sigma = 10.8 #>       nu = 0.164 #> [[3]] #>   Ngme model: matern #>   Model parameters:  #>       kappa = 3.4 #>  #>   Noise type - normal #>   Noise parameters:  #>       sigma = 2.19  # Plot prediction lp <- attr(out2, \"prediction\")$lp ggplot() +   geom_point(aes(     x = coord.prd[, 1], y = coord.prd[, 2],     colour = lp[is.na(Y2)]   ), size = 2, alpha = 1) +   geom_point(aes(     x = coords[, 1], y = coords[, 2],     colour = Y_mean   ), size = 2, alpha = 1) +   scale_color_gradientn(colours = viridis(100)) +   geom_path(aes(x = PRborder[, 1], y = PRborder[, 2])) +   geom_path(aes(x = PRborder[1034:1078, 1], y = PRborder[     1034:1078,     2   ]), colour = \"red\")"},{"path":"https://davidbolin.github.io/ngme2/articles/ngme_models.html","id":"ar1-model","dir":"Articles","previous_headings":"","what":"AR(1) model","title":"Ngme2 Models","text":"autoregressive (AR) model specifies output variable depends linearly previous values stochastic term. simplest AR model AR(1) model, given : \\[\\begin{align} X_1 &= \\epsilon_1, \\\\ X_i &= \\alpha X_{-1} + \\epsilon_i, \\; = 2, \\dots , n, \\end{align}\\] , \\(\\epsilon_1, ..,\\epsilon_n\\) either ..d. NIG Gaussian noise. easy verify \\[ K{\\bf X} = \\boldsymbol\\epsilon,\\] \\({\\bf X} = (X_1, \\dots, X_n)\\), \\({\\boldsymbol \\epsilon} = (\\epsilon_1, \\dots, \\epsilon_n)\\), \\[ K =   \\begin{bmatrix}     \\alpha \\\\     -1 &  \\alpha \\\\     & \\ddots & \\ddots \\\\     & & -1 &  \\alpha   \\end{bmatrix}. \\] ngme2 usage specify AR(1) model following: Notice AR model, accept integer values index, otherwise hard interpret. See details.","code":"library(ngme2) year <- c(2021, 2022, 2024, 2025) model_ar1(year) #> as(<dgTMatrix>, \"dgCMatrix\") is deprecated since Matrix 1.5-0; do as(., \"CsparseMatrix\") instead #> Ngme model: ar1 #> Model parameters:  #>     alpha = 0.5 #>  #> Noise type - normal #> Noise parameters:  #>     sigma = 1"},{"path":"https://davidbolin.github.io/ngme2/articles/ngme_models.html","id":"random-walk-model","dir":"Articles","previous_headings":"","what":"Random walk model","title":"Ngme2 Models","text":"random walk random process describes path consists succession random steps. random walk process order 1 given \\[ X_{} - X_{-1} = \\epsilon_i, \\; = 2, \\dots , n, \\] , \\(\\epsilon_1, ..,\\epsilon_n\\) either ..d. NIG Gaussian noise. easy verify \\[ K{\\bf X} = \\boldsymbol\\epsilon,\\] \\({\\bf X} = (X_1, \\dots, X_n)\\), \\({\\boldsymbol \\epsilon} = (\\epsilon_1, \\dots, \\epsilon_n)\\), operator matrix \\[ K =   \\begin{bmatrix}     1 & -1 \\\\       & 1 & -1 \\\\       & & \\ddots & \\ddots \\\\       & & & 1 & -1   \\end{bmatrix}. \\] Notice \\(K\\) constant matrix ((n-1) \\(\\times\\) n). Similarily, random walk process order 2 given \\[ (X_{} - X_{-1}) - (X_{-1} - X_{-2}) = \\epsilon_i, \\; = 2, \\dots , n, \\] operator matrix \\[ K =   \\begin{bmatrix}     1 & -2 & 1 \\\\       & 1 & -2 & 1 \\\\       & & \\ddots & \\ddots & \\ddots \\\\       & & & 1 & -2 & 1   \\end{bmatrix}. \\] ngme2 usage specify random walk model :","code":"x <- rexp(10) model_rw(x, order = 1) #> Ngme model: rw1 #> Model parameters:  #>     No parameter needed. #>  #> Noise type - normal #> Noise parameters:  #>     sigma = 1 model_rw(x, order = 2, circular = TRUE) # the first and last is connected #> Ngme model: rw1 #> Model parameters:  #>     No parameter needed. #>  #> Noise type - normal #> Noise parameters:  #>     sigma = 1"},{"path":"https://davidbolin.github.io/ngme2/articles/ngme_models.html","id":"spde-matérn-model","dir":"Articles","previous_headings":"","what":"SPDE Matérn model","title":"Ngme2 Models","text":"Several popular Gaussian random field models can represented solutions stochastic partial differential equations (SPDEs) form \\[ L^\\beta (\\tau u) = \\mathcal{W}. \\] \\(\\mathcal{W}\\) Gaussian white noise, \\(L\\) second-order differential operator, fractional power \\(\\beta > 0\\) determines smoothness u. See explicit link Gaussian fields Gaussian Markov random fields: stochastic partial differential equation approach details. package aims address non-Gaussian extension SPDE approach model replacing driven noise \\(\\mathcal{W}\\) non-Gaussian noise \\(\\mathcal{M}\\). specificly, type-G Lévy process. increment type-G Lévy process can represented \\[ \\gamma + \\mu V + \\sigma \\sqrt{V}Z, \\] \\(\\gamma, \\mu\\) parameters, \\(Z\\sim N(0,1)\\) independent \\(V\\), \\(V\\) positive infinitely divisible random variable. One example normal inverse Gaussian (NIG) noise. (See vignette(\"SPDE-approach\", package = \"ngme2\") details) ngme2 usage specify spde Matérn model (spatial 2d example):","code":"library(INLA) #> Loading required package: Matrix #> Loading required package: foreach #> Loading required package: parallel #> Loading required package: sp #> This is INLA_22.11.22 built 2022-11-22 05:52:45 UTC. #>  - See www.r-inla.org/contact-us for how to get help. #>  - To enable PARDISO sparse library; see inla.pardiso() #>  #> Attaching package: 'INLA' #> The following object is masked from 'package:ngme2': #>  #>     f data(argo_float) dim(argo_float) #> [1] 274   4 head(argo_float) #>       lat     lon           sal       temp #> 1 -64.078 175.821 -0.0699508100  0.4100305 #> 2 -63.760 162.917 -0.0320931260 -0.2588680 #> 3 -63.732 163.294 -0.0008063143 -0.1151362 #> 4 -63.700 162.568 -0.0209534220 -0.2378965 #> 5 -63.269 169.623  0.0409914840  0.3375048 #> 6 -63.113 171.526  0.0269408910  0.2145556 loc <- argo_float[, 1:2]  # generate a INLA 2d mesh using INLA mesh <- inla.mesh.2d(loc = loc,                     max.edge = c(1, 5),                     cutoff = 0.4,                     offset = c(1,5)) plot(mesh) # tell the model the location and the mesh to work with model_matern(loc = loc, mesh = mesh) #> Ngme model: matern #> Model parameters:  #>     kappa = 1 #>  #> Noise type - normal #> Noise parameters:  #>     sigma = 1"},{"path":"https://davidbolin.github.io/ngme2/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"David Bolin. Author, maintainer. Xiaotian Jin. Author. Alexandre Simas. Author. Jonas Wallin. Author.","code":""},{"path":"https://davidbolin.github.io/ngme2/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Bolin D, Jin X, Simas , Wallin J (2022). ngme2: Latent Mixed Effects Models Flexible Distributions. R package version 0.1.0, https://davidbolin.github.io/ngme2/.","code":"@Manual{,   title = {ngme2: Latent Mixed Effects Models With Flexible Distributions},   author = {David Bolin and Xiaotian Jin and Alexandre Simas and Jonas Wallin},   year = {2022},   note = {R package version 0.1.0},   url = {https://davidbolin.github.io/ngme2/}, }"},{"path":"https://davidbolin.github.io/ngme2/index.html","id":"the-ngme2-package","dir":"","previous_headings":"","what":"Latent Mixed Effects Models With Flexible Distributions","title":"Latent Mixed Effects Models With Flexible Distributions","text":"ngme2 R package used fitting non-gaussian mixed effects models. models fitted using maximum likelihood estimation preconditioned stochastic gradient descent. Basic statistical operations likelihood evaluations kriging predictions also implemented.","code":""},{"path":"https://davidbolin.github.io/ngme2/index.html","id":"introduction","dir":"","previous_headings":"","what":"Introduction","title":"Latent Mixed Effects Models With Flexible Distributions","text":"Several popular Gaussian random field models can represented solutions stochastic partial differential equations (SPDEs) form Lβ(τu) = 𝒲. 𝒲 Gaussian white noise, L second-order differential operator, fractional power β > 0 determines smoothness u. See explicit link Gaussian fields Gaussian Markov random fields: stochastic partial differential equation approach details. package aims address non-Gaussian extension SPDE approach model replacing driven noise 𝒲 non-Gaussian noise ℳ. specificly, type-G Lévy process. increment type-G Lévy process can represented $$ \\gamma + \\mu V + \\sigma \\sqrt{V}Z, $$ γ, μ parameters, Z ∼ N(0,1) independent V, V positive infinitely divisible random variable. One example normal inverse Gaussian (NIG) noise. (See vignette(\"SPDE-approach\", package = \"ngme2\") details)","code":""},{"path":"https://davidbolin.github.io/ngme2/index.html","id":"installation-instructions","dir":"","previous_headings":"","what":"Installation instructions","title":"Latent Mixed Effects Models With Flexible Distributions","text":"development version can installed using command See also Installation Configuration vignette.","code":"remotes::install_github(\"davidbolin/ngme2\", ref = \"devel\")"},{"path":"https://davidbolin.github.io/ngme2/reference/argo_float.html","id":null,"dir":"Reference","previous_headings":"","what":"Argo float dataset — argo_float","title":"Argo float dataset — argo_float","text":"Argo floats measurements.","code":""},{"path":"https://davidbolin.github.io/ngme2/reference/argo_float.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Argo float dataset — argo_float","text":"","code":"data(\"argo_float\")"},{"path":"https://davidbolin.github.io/ngme2/reference/argo_float.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Argo float dataset — argo_float","text":"Data frame containing 274 observations 4 variables. lat Latitude. lon Longitude. sal Salinity. temp Temperature.","code":""},{"path":"https://davidbolin.github.io/ngme2/reference/argo_float.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Argo float dataset — argo_float","text":"Data can obtained Argo float website.","code":""},{"path":"https://davidbolin.github.io/ngme2/reference/argo_float.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Argo float dataset — argo_float","text":"floats pressure case made aluminium 1.3m long 20cm diameter. weigh 40kg. top antenna communicate satellites fix float's position receive data. Also top temperature, salinity pressure sensors.","code":""},{"path":"https://davidbolin.github.io/ngme2/reference/create_noise.html","id":null,"dir":"Reference","previous_headings":"","what":"Create ngme noise with a list — create_noise","title":"Create ngme noise with a list — create_noise","text":"Create ngme noise list","code":""},{"path":"https://davidbolin.github.io/ngme2/reference/create_noise.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create ngme noise with a list — create_noise","text":"","code":"create_noise(x)"},{"path":"https://davidbolin.github.io/ngme2/reference/create_noise.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Create ngme noise with a list — create_noise","text":"x list","code":""},{"path":"https://davidbolin.github.io/ngme2/reference/create_noise.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Create ngme noise with a list — create_noise","text":"list specification ngme","code":""},{"path":"https://davidbolin.github.io/ngme2/reference/f.html","id":null,"dir":"Reference","previous_headings":"","what":"Specifying a latent process model (wrapper function for each model) — f","title":"Specifying a latent process model (wrapper function for each model) — f","text":"Function used defining smooth spatial terms within ngme model formulae. function wrapper function specific submodels. (see ngme_models_types() available models).","code":""},{"path":"https://davidbolin.github.io/ngme2/reference/f.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Specifying a latent process model (wrapper function for each model) — f","text":"","code":"f(   x = NULL,   model = \"ar1\",   replicates = NULL,   noise = noise_normal(),   control = ngme_control_f(),   data = NULL,   A = NULL,   A_pred = NULL,   theta_K = NULL,   W = NULL,   fix_W = NULL,   fix_theta_K = NULL,   index_pred = NULL,   debug = NULL,   index_NA = NULL,   ... )"},{"path":"https://davidbolin.github.io/ngme2/reference/f.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Specifying a latent process model (wrapper function for each model) — f","text":"x symbol numerical value: index covariates build index model 1. string: type model, 2. ngme.spde object replicates Representing replicates noise 1. string: type model, 2. ngme.noise object (can also specified ngme model) control control variables f model data specifed inherit ngme formula Matrix connecting observation mesh A_pred Matrix connecting NA location mesh theta_K Unbounded parameter K W starting value process fix_W stop sampling W fix_theta_K fix estimation theta_K. index_pred index prediction debug Debug mode index_NA Logical vector, .na(response var.) ... additional arguments inherit data ngme function","code":""},{"path":"https://davidbolin.github.io/ngme2/reference/f.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Specifying a latent process model (wrapper function for each model) — f","text":"list latent_in constructing latent model, e.g. , h, C, G, also 1. Information K matrix 2. Information noise 3. Control variables","code":""},{"path":"https://davidbolin.github.io/ngme2/reference/gig.html","id":null,"dir":"Reference","previous_headings":"","what":"The Generalised Inverse-Gaussian (GIG) Distribution — gig","title":"The Generalised Inverse-Gaussian (GIG) Distribution — gig","text":"Density, distribution function, quantile function random generation generalised inverse-Gaussian distribution  parameters p, b.","code":""},{"path":"https://davidbolin.github.io/ngme2/reference/gig.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"The Generalised Inverse-Gaussian (GIG) Distribution — gig","text":"","code":"dgig(x, p, a, b, log = FALSE)  rgig(n, p, a, b, seed = 0)  pgig(q, p, a, b, lower.tail = TRUE, log.p = FALSE)  qgig(prob, p, a, b, lower.tail = TRUE, log.p = FALSE)"},{"path":"https://davidbolin.github.io/ngme2/reference/gig.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"The Generalised Inverse-Gaussian (GIG) Distribution — gig","text":"x, q vector quantiles. p parameter p. , b parameters b. Must positive. log, log.p logical; TRUE, probabilities/densities \\(p\\) returned \\(log(p)\\). n, number observations. seed Seed random generation. lower.tail logical; TRUE, probabilities \\(P[X\\leq x]\\), otherwise, \\(P[X>x]\\). prob vector probabilities.","code":""},{"path":"https://davidbolin.github.io/ngme2/reference/gig.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"The Generalised Inverse-Gaussian (GIG) Distribution — gig","text":"dgig gives density, pgig gives distribution function, qgig gives quantile function, rgig generates random deviates. Invalid arguments result return value NaN, warning. length result determined n rgig.","code":""},{"path":"https://davidbolin.github.io/ngme2/reference/gig.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"The Generalised Inverse-Gaussian (GIG) Distribution — gig","text":"generalised inverse-Gaussian distribution density given  $$f(x; p, , b) = ((/b)^{p/2})/(2K_p(\\sqrt{ab})) x^{p-1} \\exp\\{-(/2)x - (b/2)/x\\},$$  \\(K_p\\) modified Bessel function second kind order \\(p\\),  \\(x>0\\), \\(,b>0\\) \\(p\\\\mathbb{R}\\).  See Jørgensen (1982) details.","code":""},{"path":"https://davidbolin.github.io/ngme2/reference/gig.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"The Generalised Inverse-Gaussian (GIG) Distribution — gig","text":"Jørgensen, Bent (1982). Statistical Properties Generalized Inverse Gaussian Distribution. Lecture Notes Statistics. 9. New York–Berlin: Springer-Verlag. doi:10.1007/978-1-4612-5698-4","code":""},{"path":[]},{"path":"https://davidbolin.github.io/ngme2/reference/gig.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"The Generalised Inverse-Gaussian (GIG) Distribution — gig","text":"","code":"rgig(20, p = 1, a = 1, b = 1) #>  [1] 3.8171859 2.1198644 2.0910914 1.4874450 2.3352563 1.6579091 1.5173998 #>  [8] 3.2793585 1.8110488 1.3908806 8.2572210 2.6266594 0.9722185 4.5074103 #> [15] 5.3613386 0.5613289 1.2120960 2.2377086 2.2648424 2.6112642 pgig(0.4, p = 1, a = 1, b = 1) #> [1] 0.02956016 qgig(0.8, p = 1, a = 1, b = 1) #> [1] 4.055929 plot(function(x){dgig(x, p = 1, a = 1, b = 1)}, main = \"Generalised inverse-Gaussian density\", ylab = \"Probability density\", xlim = c(0,10))"},{"path":"https://davidbolin.github.io/ngme2/reference/ig.html","id":null,"dir":"Reference","previous_headings":"","what":"The Inverse-Gaussian (IG) Distribution — ig","title":"The Inverse-Gaussian (IG) Distribution — ig","text":"Density, distribution function, quantile function random generation inverse-Gaussian distribution  parameters b.","code":""},{"path":"https://davidbolin.github.io/ngme2/reference/ig.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"The Inverse-Gaussian (IG) Distribution — ig","text":"","code":"dig(x, a, b, log = FALSE)  rig(n, a, b, seed = 0)  pig(q, a, b, lower.tail = TRUE, log.p = FALSE)  qig(p, a, b, lower.tail = TRUE, log.p = FALSE)"},{"path":"https://davidbolin.github.io/ngme2/reference/ig.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"The Inverse-Gaussian (IG) Distribution — ig","text":"x, q vector quantiles. , b parameters b. Must positive. log, log.p logical; TRUE, probabilities/densities \\(p\\) returned \\(log(p)\\). n, number observations. seed Seed random generation. lower.tail logical; TRUE, probabilities \\(P[X\\leq x]\\), otherwise, \\(P[X>x]\\). p vector probabilities.","code":""},{"path":"https://davidbolin.github.io/ngme2/reference/ig.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"The Inverse-Gaussian (IG) Distribution — ig","text":"dig gives density, pig gives distribution function, qig gives quantile function, rig generates random deviates. Invalid arguments result return value NaN, warning. length result determined n rig.","code":""},{"path":"https://davidbolin.github.io/ngme2/reference/ig.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"The Inverse-Gaussian (IG) Distribution — ig","text":"inverse-Gaussian distribution density given  $$f(x; , b) = \\frac{\\sqrt{b}}{\\sqrt{2\\pi x^3}}\\exp(  -\\frac{}{2}x -\\frac{b}{2x} + \\sqrt{ab}),$$  \\(x>0\\) \\(,b>0\\). parameterization,  \\(E(X) = \\sqrt{b}/\\sqrt{}\\). See Tweedie (1957a, 1957b)  details.","code":""},{"path":"https://davidbolin.github.io/ngme2/reference/ig.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"The Inverse-Gaussian (IG) Distribution — ig","text":"Tweedie, M. C. K. (1957a). \"Statistical Properties Inverse Gaussian Distributions \". Annals Mathematical Statistics. 28 (2): 362–377. doi:10.1214/aoms/1177706964 Tweedie, M. C. K. (1957b). \"Statistical Properties Inverse Gaussian Distributions II\". Annals Mathematical Statistics. 28 (3): 696–705. doi:10.1214/aoms/1177706881","code":""},{"path":[]},{"path":"https://davidbolin.github.io/ngme2/reference/ig.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"The Inverse-Gaussian (IG) Distribution — ig","text":"","code":"rig(100, a = 1, b = 1) #>   [1] 0.30733943 4.07648666 0.44967873 0.30734999 0.42455107 0.10196020 #>   [7] 0.21944360 0.81842117 0.19641287 0.21207871 0.80629154 0.28736936 #>  [13] 0.62435265 0.79650875 0.61459036 0.31740370 0.21782369 1.06369162 #>  [19] 1.95258327 1.11861529 0.59796221 1.21204256 0.61874332 0.73514739 #>  [25] 1.08752036 0.51699911 0.14540443 0.17505546 0.33493607 0.22796115 #>  [31] 0.49711567 0.08385922 0.66169709 0.34071944 0.73393146 0.40117434 #>  [37] 2.19185195 0.27936565 0.61013610 1.51470658 0.35801444 1.67036824 #>  [43] 0.10366171 0.20533979 0.33207159 2.54999311 0.12320815 0.23872871 #>  [49] 2.05994688 1.13240483 0.20683119 0.56201234 2.08954926 0.69078340 #>  [55] 0.54873584 0.49821448 0.29379627 0.65402440 0.51119877 2.30585164 #>  [61] 0.34517457 1.08481380 0.30289491 3.58055081 2.04300898 0.18344922 #>  [67] 0.41420179 0.98777568 0.54947144 0.69287165 1.06062877 2.27401092 #>  [73] 0.57347088 0.18074700 0.90564507 0.48546371 0.16799385 3.16058325 #>  [79] 1.20122593 0.28886051 0.09583895 6.79991419 0.83441759 0.33005383 #>  [85] 0.28858700 0.45212103 0.23528944 0.25581792 0.52900531 1.21507566 #>  [91] 0.66268071 0.81545724 0.34093433 0.64695124 0.36528540 0.36995332 #>  [97] 2.08832277 0.47241060 0.77807992 5.39999582 pig(0.4, a = 1, b = 1) #> [1] 0.2706137 qig(0.8, a = 1, b = 1) #> [1] 1.447891 plot(function(x){dig(x, a = 1, b = 1)}, main = \"Inverse-Gaussian density\", ylab = \"Probability density\", xlim = c(0,10))"},{"path":"https://davidbolin.github.io/ngme2/reference/igam.html","id":null,"dir":"Reference","previous_headings":"","what":"The Inverse-Gamma (IGam) Distribution — igam","title":"The Inverse-Gamma (IGam) Distribution — igam","text":"Density, distribution function, quantile function random generation inverse-Gamma distribution  parameters b.","code":""},{"path":"https://davidbolin.github.io/ngme2/reference/igam.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"The Inverse-Gamma (IGam) Distribution — igam","text":"","code":"digam(x, a, b, log = FALSE)  rigam(n, a, b)  pigam(q, a, b, lower.tail = TRUE, log.p = FALSE)  qigam(p, a, b, lower.tail = TRUE, log.p = FALSE)"},{"path":"https://davidbolin.github.io/ngme2/reference/igam.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"The Inverse-Gamma (IGam) Distribution — igam","text":"x, q vector quantiles. , b parameters b. Must positive. log, log.p logical; TRUE, probabilities/densities \\(p\\) returned \\(log(p)\\). n, number observations. lower.tail logical; TRUE, probabilities \\(P[X\\leq x]\\), otherwise, \\(P[X>x]\\). p vector probabilities.","code":""},{"path":"https://davidbolin.github.io/ngme2/reference/igam.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"The Inverse-Gamma (IGam) Distribution — igam","text":"digam gives density, pigam gives distribution function, qigam gives quantile function, rigam generates random deviates. Invalid arguments result return value NaN, warning. length result determined n rig.","code":""},{"path":"https://davidbolin.github.io/ngme2/reference/igam.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"The Inverse-Gamma (IGam) Distribution — igam","text":"inverse-Gamma distribution density given  $$f(x; , b) = \\frac{b^}{\\Gamma()}x^{-1}\\exp(  -\\frac{b}{x}),$$  \\(x>0\\) \\(,b>0\\).","code":""},{"path":[]},{"path":"https://davidbolin.github.io/ngme2/reference/igam.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"The Inverse-Gamma (IGam) Distribution — igam","text":"","code":"rigam(100, a = 1, b = 1) #>   [1]  1.8521700  0.8759102  0.2252051  0.2054279  1.0981526  1.7503938 #>   [7]  2.1252146  1.2538408  8.3992950  0.7542987  3.8182703  1.7914845 #>  [13]  1.4331742 14.0172557  3.8608121  1.2378046  5.3964516  2.8255603 #>  [19]  1.5031016  5.1028856  6.2993475  2.2664290  5.1526687  5.3694614 #>  [25]  0.8041541  0.6955427  1.4646293  1.7319020  2.4890292  3.3220544 #>  [31]  0.5808935  0.3233351  1.1665347  1.1896697  1.1332476  0.6005444 #>  [37]  0.3830141  1.6250329 37.3207016  1.2032770  0.9886110  0.6165852 #>  [43]  3.4963562  2.4058730  1.4816440  0.7201599  1.6323478  2.9648383 #>  [49]  2.9353908  1.4346189  2.4138169  1.3718138  5.1624178  0.7801765 #>  [55]  0.7065289  2.5133236 21.0522128  0.2855324  3.3426763  5.4807093 #>  [61]  2.8365879  0.8030388  1.3715024  3.8323400  0.2852342  7.1348823 #>  [67]  0.8113119  0.2342395  0.3375890  0.5744289  3.8996852  0.5461422 #>  [73] 92.6325971  0.7392817  0.7914637  8.1323043  0.6898819 43.1671054 #>  [79]  0.4661292  3.4008822  2.2255182  6.4069684  4.5314368 14.9908299 #>  [85]  0.6268225 12.6690484  2.0572245  5.2459488  0.4377852 60.6844543 #>  [91]  0.8255960  1.2173512  1.2269937  7.3712484  1.5864940  0.6014139 #>  [97]  0.5723565  0.7066109 43.3159307  0.6601007 pigam(0.4, a = 1, b = 1) #> [1] 0.082085 qigam(0.8, a = 1, b = 1) #> [1] 4.48142 plot(function(x){digam(x, a = 1, b = 1)}, main = \"Inverse-Gamma density\", ylab = \"Probability density\", xlim = c(0,10))"},{"path":"https://davidbolin.github.io/ngme2/reference/mean_list.html","id":null,"dir":"Reference","previous_headings":"","what":"taking mean over a list of nested lists — mean_list","title":"taking mean over a list of nested lists — mean_list","text":"taking mean list nested lists","code":""},{"path":"https://davidbolin.github.io/ngme2/reference/mean_list.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"taking mean over a list of nested lists — mean_list","text":"","code":"mean_list(lls)"},{"path":"https://davidbolin.github.io/ngme2/reference/mean_list.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"taking mean over a list of nested lists — mean_list","text":"lls list","code":""},{"path":"https://davidbolin.github.io/ngme2/reference/mean_list.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"taking mean over a list of nested lists — mean_list","text":"list nested lists","code":""},{"path":"https://davidbolin.github.io/ngme2/reference/mean_list.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"taking mean over a list of nested lists — mean_list","text":"","code":"ls <- list(   list(a=1, b=2, t=\"nig\", ll=list(a=1,b=2, w=\"ab\")),   list(a=3, b=5, t=\"nig\", ll=list(a=1,b=6, w=\"ab\")),   list(a=5, b=5, t=\"nig\", ll=list(a=4,b=2, w=\"ab\")) ) mean_list(ls) #> $a #> [1] 3 #>  #> $b #> [1] 4 #>  #> $t #> [1] \"nig\" #>  #> $ll #> $ll$a #> [1] 2 #>  #> $ll$b #> [1] 3.333333 #>  #> $ll$w #> [1] \"ab\" #>  #>"},{"path":"https://davidbolin.github.io/ngme2/reference/model_ar1.html","id":null,"dir":"Reference","previous_headings":"","what":"ngme AR(1) model specification — model_ar1","title":"ngme AR(1) model specification — model_ar1","text":"Generating C, G given index replicates","code":""},{"path":"https://davidbolin.github.io/ngme2/reference/model_ar1.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"ngme AR(1) model specification — model_ar1","text":"","code":"model_ar1(   x,   replicates = NULL,   index_NA = NULL,   data = NULL,   noise = noise_normal(),   alpha = 0.5,   range = c(1, max(index)),   ... )"},{"path":"https://davidbolin.github.io/ngme2/reference/model_ar1.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"ngme AR(1) model specification — model_ar1","text":"x integer vector, time index AR(1) process replicates replicates process index_NA Logical vector, .na(response var.) data data, can specified f(), ngme() noise noise, can specified f() alpha initial value alpha range range mesh ... extra arguments f()","code":""},{"path":"https://davidbolin.github.io/ngme2/reference/model_ar1.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"ngme AR(1) model specification — model_ar1","text":"list specification model","code":""},{"path":"https://davidbolin.github.io/ngme2/reference/model_ar1.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"ngme AR(1) model specification — model_ar1","text":"","code":"model_ar1(c(1:3, 1:3), replicates = c(1,1,1,2,2,2)) #> as(<dgTMatrix>, \"dgCMatrix\") is deprecated since Matrix 1.5-0; do as(., \"CsparseMatrix\") instead #> Ngme model: ar1 #> Model parameters:  #>     alpha = 0.5 #>  #> Noise type - normal #> Noise parameters:  #>     sigma = 1 f(xx, model = \"ar1\", data=list(xx = c(2,4,5)), noise=noise_nig()) #> Ngme model: ar1 #> Model parameters:  #>     alpha = 0.5 #>  #> Noise type - nig #> Noise parameters:  #>     mu = 0 #>     sigma = 1 #>     nu = 1"},{"path":"https://davidbolin.github.io/ngme2/reference/model_matern.html","id":null,"dir":"Reference","previous_headings":"","what":"Create a Matern SPDE model — model_matern","title":"Create a Matern SPDE model — model_matern","text":"Create Matern SPDE model","code":""},{"path":"https://davidbolin.github.io/ngme2/reference/model_matern.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create a Matern SPDE model — model_matern","text":"","code":"model_matern(   loc = NULL,   replicates = NULL,   alpha = 2,   kappa = 1,   theta_kappa = NULL,   B_kappa = NULL,   mesh = NULL,   fem.mesh.matrices = NULL,   d = NULL,   index_NA = NULL,   A = NULL,   A_pred = NULL,   noise = noise_normal(),   ... )"},{"path":"https://davidbolin.github.io/ngme2/reference/model_matern.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Create a Matern SPDE model — model_matern","text":"loc numeric vector (1d) matrix column 2 (2d), location make index replicates replicates process alpha 2 4, SPDE smoothness parameter kappa parameterization kappa^2 C + G, stationary theta_kappa parameterization non-stationary B_kappa bases kappa mesh mesh argument fem.mesh.matrices specify FEM matrices d indicating dimension mesh (together fem.mesh.matrices) index_NA Logical vector, .na(response var.) Matrix connecting observation mesh A_pred Matrix connecting NA location mesh noise 1. string: type model, 2. ngme.noise object ... extra arguments f()","code":""},{"path":"https://davidbolin.github.io/ngme2/reference/model_matern.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Create a Matern SPDE model — model_matern","text":"list (n, C (diagonal), G, B.kappa) constructing operator","code":""},{"path":"https://davidbolin.github.io/ngme2/reference/model_rw.html","id":null,"dir":"Reference","previous_headings":"","what":"ngme model - random walk of order 1 — model_rw","title":"ngme model - random walk of order 1 — model_rw","text":"Generating C, G given index replicates size C G (n-1) * n, size V n-1","code":""},{"path":"https://davidbolin.github.io/ngme2/reference/model_rw.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"ngme model - random walk of order 1 — model_rw","text":"","code":"model_rw(   x,   order = 1,   replicates = NULL,   data = NULL,   circular = FALSE,   index_NA = NULL,   noise = noise_normal(),   ... )"},{"path":"https://davidbolin.github.io/ngme2/reference/model_rw.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"ngme model - random walk of order 1 — model_rw","text":"x numerical vector, covariates build index process order 1 2, order random walk model replicates replicates process data specifed inherit ngme formula circular whether mesh circular, .e. first one connected last index_NA Logical vector, .na(response variable) noise 1. string: type model, 2. ngme.noise object (can also specified ngme model) ... additional arguments","code":""},{"path":"https://davidbolin.github.io/ngme2/reference/model_rw.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"ngme model - random walk of order 1 — model_rw","text":"list","code":""},{"path":"https://davidbolin.github.io/ngme2/reference/model_rw.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"ngme model - random walk of order 1 — model_rw","text":"","code":"r1 <- model_rw(1:7, order = 1, circular = TRUE); r1$C + r1$G #> 6 x 6 sparse Matrix of class \"dgCMatrix\" #>                        #> [1,]  1 -1  .  .  .  . #> [2,]  .  1 -1  .  .  . #> [3,]  .  .  1 -1  .  . #> [4,]  .  .  .  1 -1  . #> [5,]  .  .  .  .  1 -1 #> [6,] -1  .  .  .  .  1 r2 <- model_rw(1:7, order = 1); r2$C + r2$G #> 6 x 7 sparse Matrix of class \"dgCMatrix\" #>                          #> [1,] 1 -1  .  .  .  .  . #> [2,] .  1 -1  .  .  .  . #> [3,] .  .  1 -1  .  .  . #> [4,] .  .  .  1 -1  .  . #> [5,] .  .  .  .  1 -1  . #> [6,] .  .  .  .  .  1 -1"},{"path":"https://davidbolin.github.io/ngme2/reference/ngme.html","id":null,"dir":"Reference","previous_headings":"","what":"Fit an additice linear mixed effect model — ngme","title":"Fit an additice linear mixed effect model — ngme","text":"ngme function performs analysis non-gaussian additive models.  maximum likelihood estimation via stochastic gradient descent.  prediction unknown location can performed leaving response  variable NA. likelihood specified family. model estimation control can setted control using  ngme_control() function, see ?ngme_control details. See ngme_model_types() available models.","code":""},{"path":"https://davidbolin.github.io/ngme2/reference/ngme.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Fit an additice linear mixed effect model — ngme","text":"","code":"ngme(   formula,   data,   control = ngme_control(),   family = \"normal\",   beta = NULL,   seed = NULL,   start = NULL,   debug = FALSE )"},{"path":"https://davidbolin.github.io/ngme2/reference/ngme.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Fit an additice linear mixed effect model — ngme","text":"formula formula data dataframe list providing data (response variable can contain NA value,  NA value columns cause problem) control control variables, see ?ngme.control family likelihood type, measurement noise specification, 1. string 2. ngme noise obejct beta starting value fixed effects seed set seed pesudo random number generator start starting ngme object (usually object last fitting) debug toggle debug mode","code":""},{"path":"https://davidbolin.github.io/ngme2/reference/ngme.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Fit an additice linear mixed effect model — ngme","text":"list outputs contains estimation operator paramters, noise parameters","code":""},{"path":"https://davidbolin.github.io/ngme2/reference/ngme.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Fit an additice linear mixed effect model — ngme","text":"","code":"ngme(  formula = Y ~ x1 + f(    x2,    model = \"ar1\",    noise = noise_nig(),    theta_K = 0.5  ) + f(    model = model_rw(1:5, order=1, circular = TRUE),    noise = noise_normal(),  ),  family = noise_normal(sd = 0.5),  data = data.frame(Y = 1:5, x1 = 2:6, x2 = 3:7),  control = ngme_control(    estimation = FALSE  ) ) #> *** Ngme object *** #>  #> Fixed effects:  #>    beta = -1,  1 #>  #> Measurement noise:  #>   Noise type - normal #>   Noise parameters:  #>       sigma = 1 #>  #>  #> Latent models:  #> [[1]] #>   Ngme model: ar1 #>   Model parameters:  #>       alpha = 0.5 #>  #>   Noise type - nig #>   Noise parameters:  #>       mu = 0 #>       sigma = 1 #>       nu = 1 #> [[2]] #>   Ngme model: rw1 #>   Model parameters:  #>       No parameter needed. #>  #>   Noise type - normal #>   Noise parameters:  #>       sigma = 1"},{"path":"https://davidbolin.github.io/ngme2/reference/ngme2.html","id":null,"dir":"Reference","previous_headings":"","what":"ngme2 — ngme2","title":"ngme2 — ngme2","text":"Inference prediction mixed effects models flexible non-Gaussian Gaussian distributions.","code":""},{"path":"https://davidbolin.github.io/ngme2/reference/ngme2.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"ngme2 — ngme2","text":"David Bolin <davidbolin@gmail.com>","code":""},{"path":"https://davidbolin.github.io/ngme2/reference/ngme_as_sparse.html","id":null,"dir":"Reference","previous_headings":"","what":"Convert sparse matrix into sparse dgCMatrix — ngme_as_sparse","title":"Convert sparse matrix into sparse dgCMatrix — ngme_as_sparse","text":"Convert sparse matrix sparse dgCMatrix","code":""},{"path":"https://davidbolin.github.io/ngme2/reference/ngme_as_sparse.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Convert sparse matrix into sparse dgCMatrix — ngme_as_sparse","text":"","code":"ngme_as_sparse(G)"},{"path":"https://davidbolin.github.io/ngme2/reference/ngme_as_sparse.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Convert sparse matrix into sparse dgCMatrix — ngme_as_sparse","text":"G matrix","code":""},{"path":"https://davidbolin.github.io/ngme2/reference/ngme_as_sparse.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Convert sparse matrix into sparse dgCMatrix — ngme_as_sparse","text":"sparse dgCMatrix","code":""},{"path":"https://davidbolin.github.io/ngme2/reference/ngme_control.html","id":null,"dir":"Reference","previous_headings":"","what":"Generate control specifications for ngme() function. — ngme_control","title":"Generate control specifications for ngme() function. — ngme_control","text":"configurations ngme estimation optimization process.","code":""},{"path":"https://davidbolin.github.io/ngme2/reference/ngme_control.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Generate control specifications for ngme() function. — ngme_control","text":"","code":"ngme_control(   burnin = 100,   iterations = 100,   gibbs_sample = 5,   stepsize = 1,   estimation = TRUE,   n_parallel_chain = 2,   stop_points = 10,   exchange_VW = TRUE,   n_slope_check = 3,   std_lim = 0.1,   trend_lim = 0.05,   print_check_info = TRUE,   opt_beta = TRUE,   fix_beta = FALSE,   max_relative_step = 0.1,   max_absolute_step = 0.5,   reduce_var = FALSE,   reduce_power = 0.75,   threshold = 1e-05,   window_size = 1 )"},{"path":"https://davidbolin.github.io/ngme2/reference/ngme_control.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Generate control specifications for ngme() function. — ngme_control","text":"burnin burn-periods iterations optimizing terations gibbs_sample number gibbs sampels stepsize stepsize estimation estimating parameters n_parallel_chain number parallel chains stop_points number stop points convergence check exchange_VW exchange last V W chian n_slope_check number stop points regression std_lim maximum allowed standard deviation trend_lim maximum allowed slope print_check_info print convergence information opt_beta logical, optimize fixed effect fix_beta logical, fix fixed effect max_relative_step max relative step allowed 1 iteration max_absolute_step max absolute step allowed 1 iteration reduce_var logical, reduce variace reduce_power numerical power reduce level threshold till start reduce variance window_size numerical, length window final estimates","code":""},{"path":"https://davidbolin.github.io/ngme2/reference/ngme_control.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Generate control specifications for ngme() function. — ngme_control","text":"list control variables","code":""},{"path":"https://davidbolin.github.io/ngme2/reference/ngme_control.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Generate control specifications for ngme() function. — ngme_control","text":"enable convergence check, need multiple chains running.  compare trend estimated parameter length  n_slope_check (linear regression) trend_lim.  compare standard devation estimated parameters (different chains)  std_lim.","code":""},{"path":"https://davidbolin.github.io/ngme2/reference/ngme_control_f.html","id":null,"dir":"Reference","previous_headings":"","what":"Generate control specifications for f function — ngme_control_f","title":"Generate control specifications for f function — ngme_control_f","text":"Generate control specifications f function","code":""},{"path":"https://davidbolin.github.io/ngme2/reference/ngme_control_f.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Generate control specifications for f function — ngme_control_f","text":"","code":"ngme_control_f(   numer_grad = FALSE,   use_precond = FALSE,   use_num_hess = TRUE,   eps = 0.01 )"},{"path":"https://davidbolin.github.io/ngme2/reference/ngme_control_f.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Generate control specifications for f function — ngme_control_f","text":"numer_grad whether use numerical gradient use_precond whether use preconditioner use_num_hess whether use numerical hessian eps eps computing numerical gradient","code":""},{"path":"https://davidbolin.github.io/ngme2/reference/ngme_control_f.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Generate control specifications for f function — ngme_control_f","text":"list control variables","code":""},{"path":"https://davidbolin.github.io/ngme2/reference/ngme_model_types.html","id":null,"dir":"Reference","previous_headings":"","what":"Show ngme mdoel types — ngme_model_types","title":"Show ngme mdoel types — ngme_model_types","text":"Show ngme mdoel types","code":""},{"path":"https://davidbolin.github.io/ngme2/reference/ngme_model_types.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Show ngme mdoel types — ngme_model_types","text":"","code":"ngme_model_types()"},{"path":"https://davidbolin.github.io/ngme2/reference/ngme_model_types.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Show ngme mdoel types — ngme_model_types","text":"available types models","code":""},{"path":"https://davidbolin.github.io/ngme2/reference/ngme_noise.html","id":null,"dir":"Reference","previous_headings":"","what":"ngme noise specification — ngme_noise","title":"ngme noise specification — ngme_noise","text":"Function specifying ngme noise. Please use noise_nig noise_normal simpler usage. Use ngme_noise_types() check available types.","code":""},{"path":"https://davidbolin.github.io/ngme2/reference/ngme_noise.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"ngme noise specification — ngme_noise","text":"","code":"ngme_noise(   noise_type,   mu = 0,   sigma = 1,   nu = 1,   n = 1,   theta_mu = NULL,   B_mu = NULL,   theta_sigma = NULL,   B_sigma = NULL,   fix_theta_mu = FALSE,   fix_theta_sigma = FALSE,   fix_theta_V = FALSE,   V = NULL,   fix_V = FALSE,   ... )  noise_normal(   sigma = NULL,   theta_sigma = NULL,   B_sigma = matrix(1, 1, 1),   n = nrow(B_sigma),   ... )  noise_nig(   mu = NULL,   sigma = NULL,   nu = NULL,   n = 1,   V = NULL,   theta_mu = NULL,   theta_sigma = NULL,   B_mu = matrix(1),   B_sigma = matrix(1),   ... )"},{"path":"https://davidbolin.github.io/ngme2/reference/ngme_noise.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"ngme noise specification — ngme_noise","text":"noise_type type noise, \"nig\", \"normal\" mu specify NIG noise parameter mu, see ?nig sigma specify noise parameter sigma, see ?nig nu specify NIG noise parameter nu (nu>0), see ?nig n number noise (= nrow(B_mu) = nrow(B_sigma)) theta_mu specify non-stationary noise using theta_mu B_mu Basis matrix mu (non-stationary) theta_sigma specify non-stationary noise using theta_sigma B_sigma Basis matrix sigma (non-stationary) fix_theta_mu fix parameter theta_mu fix_theta_sigma fix parameter theta_sigma fix_theta_V fix parameter theta_V V start value V fix_V fix sampling V ... additional arguments","code":""},{"path":"https://davidbolin.github.io/ngme2/reference/ngme_noise.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"ngme noise specification — ngme_noise","text":"list specification noise","code":""},{"path":"https://davidbolin.github.io/ngme2/reference/ngme_noise.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"ngme noise specification — ngme_noise","text":"parameterization given ?nig. Moreover, specifying non-stationary mu sigma, $$\\mu = B_{\\mu} \\theta_{\\mu},$$ $$\\sigma = \\exp (B_{\\sigma} \\theta_{\\sigma}),$$","code":""},{"path":"https://davidbolin.github.io/ngme2/reference/ngme_noise.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"ngme noise specification — ngme_noise","text":"","code":"noise_normal(n = 10, sigma = 2) #> Noise type - normal #> Noise parameters:  #>     sigma = 2 noise_nig(mu = 1, sigma = 2, nu = 1, n=10) #> Noise type - nig #> Noise parameters:  #>     mu = 1 #>     sigma = 2 #>     nu = 1"},{"path":"https://davidbolin.github.io/ngme2/reference/ngme_noise_types.html","id":null,"dir":"Reference","previous_headings":"","what":"show ngme noise types — ngme_noise_types","title":"show ngme noise types — ngme_noise_types","text":"show ngme noise types","code":""},{"path":"https://davidbolin.github.io/ngme2/reference/ngme_noise_types.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"show ngme noise types — ngme_noise_types","text":"","code":"ngme_noise_types()"},{"path":"https://davidbolin.github.io/ngme2/reference/ngme_noise_types.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"show ngme noise types — ngme_noise_types","text":"available types noise","code":""},{"path":"https://davidbolin.github.io/ngme2/reference/ngme_parse_formula.html","id":null,"dir":"Reference","previous_headings":"","what":"Parse the formula for ngme function — ngme_parse_formula","title":"Parse the formula for ngme function — ngme_parse_formula","text":"Parse formula ngme function","code":""},{"path":"https://davidbolin.github.io/ngme2/reference/ngme_parse_formula.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Parse the formula for ngme function — ngme_parse_formula","text":"","code":"ngme_parse_formula(gf, data)"},{"path":"https://davidbolin.github.io/ngme2/reference/ngme_parse_formula.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Parse the formula for ngme function — ngme_parse_formula","text":"gf formula data data.frame","code":""},{"path":"https://davidbolin.github.io/ngme2/reference/ngme_parse_formula.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Parse the formula for ngme function — ngme_parse_formula","text":"1. plain formula without f function  2. latents_in - f function","code":""},{"path":"https://davidbolin.github.io/ngme2/reference/ngme_ts_make_A.html","id":null,"dir":"Reference","previous_headings":"","what":"Make observation matrix for time series — ngme_ts_make_A","title":"Make observation matrix for time series — ngme_ts_make_A","text":"Make observation matrix time series","code":""},{"path":"https://davidbolin.github.io/ngme2/reference/ngme_ts_make_A.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Make observation matrix for time series — ngme_ts_make_A","text":"","code":"ngme_ts_make_A(loc, replicates = NULL, range = c(1, max(loc)))"},{"path":"https://davidbolin.github.io/ngme2/reference/ngme_ts_make_A.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Make observation matrix for time series — ngme_ts_make_A","text":"loc integers (sorting, gaps > 1) replicates indicating replicate measure location range range mesh default range=(min(loc), max(loc))","code":""},{"path":"https://davidbolin.github.io/ngme2/reference/ngme_ts_make_A.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Make observation matrix for time series — ngme_ts_make_A","text":"matrix (length(loc) * length(unique(loc)))","code":""},{"path":"https://davidbolin.github.io/ngme2/reference/ngme_ts_make_A.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Make observation matrix for time series — ngme_ts_make_A","text":"","code":"ngme_ts_make_A(c(1, 2, 2), replicates = c(1, 1, 2)) #> 3 x 4 sparse Matrix of class \"dgCMatrix\" #>              #> [1,] 1 . . . #> [2,] . 1 . . #> [3,] . . . 1 ngme_ts_make_A(c(1, 2, 2), range = c(1, 5)) #> 3 x 5 sparse Matrix of class \"dgCMatrix\" #>                #> [1,] 1 . . . . #> [2,] . 1 . . . #> [3,] . 1 . . ."},{"path":"https://davidbolin.github.io/ngme2/reference/nig.html","id":null,"dir":"Reference","previous_headings":"","what":"The Normal Inverse-Gaussian (GIG) Distribution — nig","title":"The Normal Inverse-Gaussian (GIG) Distribution — nig","text":"Density, distribution function, quantile function random generation normal inverse-Gaussian distribution  parameters p, b.","code":""},{"path":"https://davidbolin.github.io/ngme2/reference/nig.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"The Normal Inverse-Gaussian (GIG) Distribution — nig","text":"","code":"dnig(x, delta, mu, nu, sigma, log = FALSE)  rnig(n, delta, mu, nu, sigma, seed = 0)  pnig(q, delta, mu, nu, sigma, lower.tail = TRUE, log.p = FALSE)  qnig(p, delta, mu, nu, sigma, lower.tail = TRUE, log.p = FALSE)"},{"path":"https://davidbolin.github.io/ngme2/reference/nig.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"The Normal Inverse-Gaussian (GIG) Distribution — nig","text":"x, q vector quantiles. delta numeric value location parameter. mu numeric value shift parameter. nu numeric value shape parameter. sigma numeric value scaling parameter. log, log.p logical; TRUE, probabilities/densities \\(p\\) returned \\(log(p)\\). n, number observations. seed Seed random generation. lower.tail logical; TRUE, probabilities \\(P[X\\leq x]\\), otherwise, \\(P[X>x]\\). p vector probabilities.","code":""},{"path":"https://davidbolin.github.io/ngme2/reference/nig.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"The Normal Inverse-Gaussian (GIG) Distribution — nig","text":"dnig gives density, pnig gives distribution function, qnig gives quantile function, rnig generates random deviates. Invalid arguments result return value NaN, warning. length result determined n rnig.","code":""},{"path":"https://davidbolin.github.io/ngme2/reference/nig.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"The Normal Inverse-Gaussian (GIG) Distribution — nig","text":"normal inverse-Gaussian distribution density given  $$f(x; p, , b) =  \\frac{e^{\\nu+\\mu(x-\\delta)/\\sigma^2}\\sqrt{\\nu\\mu^2/\\sigma^2+\\nu^2}}{\\pi\\sqrt{\\nu\\sigma^2+(x-\\delta)^2}}  K_1(\\sqrt{(\\nu\\sigma^2+(x-\\delta)^2)(\\mu^2/\\sigma^4+\\nu/\\sigma^2)}),$$  \\(K_p\\) modified Bessel function second kind order \\(p\\),  \\(x>0\\), \\(\\nu>0\\) \\(\\mu,\\delta, \\sigma\\\\mathbb{R}\\).  See Barndorff-Nielsen (1977, 1978 1997) details.","code":""},{"path":"https://davidbolin.github.io/ngme2/reference/nig.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"The Normal Inverse-Gaussian (GIG) Distribution — nig","text":"Barndorff-Nielsen, O. (1977) Exponentially decreasing distributions logarithm particle size. Proceedings Royal Society London. Series , Mathematical Physical Sciences. Royal Society. 353, 401–409. doi:10.1098/rspa.1977.0041 Barndorff-Nielsen, O. (1978) Hyperbolic Distributions Distributions Hyperbolae, Scandinavian Journal Statistics. 5, 151–157. Barndorff-Nielsen, O. (1997) Normal Inverse Gaussian Distributions Stochastic Volatility Modelling, Scandinavian Journal Statistics. 24, 1-13. doi:10.1111/1467-9469.00045","code":""},{"path":[]},{"path":"https://davidbolin.github.io/ngme2/reference/nig.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"The Normal Inverse-Gaussian (GIG) Distribution — nig","text":"","code":"rnig(100, delta = 0, mu = 5, sigma = 1, nu = 1) #>   [1] 10.45747601  9.31447932  9.04051765  0.58691368  2.29690303  2.62480105 #>   [7]  2.86601590  1.64097327  3.17659347  9.08165462  2.93265802  1.87734190 #>  [13]  1.76001465  8.74600322  4.03105224  2.65170376  3.16256748  0.03454442 #>  [19]  4.73243527  2.34551160  4.64210575  0.82105422  1.18220222  2.35193079 #>  [25]  5.47176214  3.21830449  3.09577688  2.19315984  4.90063237  2.09043975 #>  [31]  2.39007917  3.79454608 21.44155300  6.27645255  2.12991437  1.08445216 #>  [37]  4.48645833  0.37667775  5.66429360  2.46629077 10.85184126  6.67145684 #>  [43]  0.60705309  0.96374740  8.67065239  1.39652492  5.25907487 14.95102812 #>  [49]  1.44488111  6.86768910  0.61836636  6.15651935  8.88714765  3.46720592 #>  [55]  7.32674176  4.23770478  0.49681769  3.10513361  4.50251313  3.74859489 #>  [61]  3.16772102  6.18291408  2.63922174  8.12832066  4.67333486  3.21895311 #>  [67] 11.33616891  5.48551310 10.47917295  3.43323495  2.16262324  5.01940569 #>  [73]  1.48019371  5.80856678  2.32628207  0.97765665  0.58621496  3.11494354 #>  [79]  4.72761018  2.08806790 13.76799599 20.69891525  3.79034169  2.63565590 #>  [85]  5.34862599  1.85998216 11.14139456  1.50574766  4.13309794  0.96424884 #>  [91]  3.64801808  0.64193772  7.47403903  5.27421021  4.66892551  6.66002848 #>  [97]  2.45050579  1.76332272  3.45954445  2.68448636 pnig(0.4, delta = 0, mu = 5, sigma = 1, nu = 1) #> [1] 0.01597497 qnig(0.8, delta = 0, mu = 5, sigma = 1, nu = 1) #> [1] 7.390234 plot(function(x){dnig(x, delta = 0, mu = 5, sigma = 1, nu = 1)}, main = \"Normal inverse-Gaussian density\", ylab = \"Probability density\", xlim = c(0,10))"},{"path":"https://davidbolin.github.io/ngme2/reference/plot.ngme_noise.html","id":null,"dir":"Reference","previous_headings":"","what":"plot the density of noise (for stationary) — plot.ngme_noise","title":"plot the density of noise (for stationary) — plot.ngme_noise","text":"plot density noise (stationary)","code":""},{"path":"https://davidbolin.github.io/ngme2/reference/plot.ngme_noise.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"plot the density of noise (for stationary) — plot.ngme_noise","text":"","code":"# S3 method for ngme_noise plot(x, y = NULL, ...)"},{"path":"https://davidbolin.github.io/ngme2/reference/plot.ngme_noise.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"plot the density of noise (for stationary) — plot.ngme_noise","text":"x ngme_noise y another ngme_noise ... ...","code":""},{"path":"https://davidbolin.github.io/ngme2/reference/plot.ngme_noise.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"plot the density of noise (for stationary) — plot.ngme_noise","text":"plot","code":""},{"path":"https://davidbolin.github.io/ngme2/reference/plot.ngme_noise.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"plot the density of noise (for stationary) — plot.ngme_noise","text":"","code":"plot(noise_nig(mu=1, sigma=2, nu=1))"},{"path":"https://davidbolin.github.io/ngme2/reference/print.ngme.html","id":null,"dir":"Reference","previous_headings":"","what":"Print ngme object — print.ngme","title":"Print ngme object — print.ngme","text":"Print ngme object","code":""},{"path":"https://davidbolin.github.io/ngme2/reference/print.ngme.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Print ngme object — print.ngme","text":"","code":"# S3 method for ngme print(x, ...)"},{"path":"https://davidbolin.github.io/ngme2/reference/print.ngme.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Print ngme object — print.ngme","text":"x ngme object ... ignored","code":""},{"path":"https://davidbolin.github.io/ngme2/reference/print.ngme.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Print ngme object — print.ngme","text":"list (noise specifications)","code":""},{"path":"https://davidbolin.github.io/ngme2/reference/print.ngme_model.html","id":null,"dir":"Reference","previous_headings":"","what":"Print ngme model — print.ngme_model","title":"Print ngme model — print.ngme_model","text":"Print ngme model","code":""},{"path":"https://davidbolin.github.io/ngme2/reference/print.ngme_model.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Print ngme model — print.ngme_model","text":"","code":"# S3 method for ngme_model print(x, padding = 0, ...)"},{"path":"https://davidbolin.github.io/ngme2/reference/print.ngme_model.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Print ngme model — print.ngme_model","text":"x ngme model object padding number white space padding front ... ...","code":""},{"path":"https://davidbolin.github.io/ngme2/reference/print.ngme_model.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Print ngme model — print.ngme_model","text":"list (model specifications)","code":""},{"path":"https://davidbolin.github.io/ngme2/reference/print.ngme_noise.html","id":null,"dir":"Reference","previous_headings":"","what":"Print ngme noise — print.ngme_noise","title":"Print ngme noise — print.ngme_noise","text":"Print ngme noise","code":""},{"path":"https://davidbolin.github.io/ngme2/reference/print.ngme_noise.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Print ngme noise — print.ngme_noise","text":"","code":"# S3 method for ngme_noise print(x, padding = 0, ...)"},{"path":"https://davidbolin.github.io/ngme2/reference/print.ngme_noise.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Print ngme noise — print.ngme_noise","text":"x noise object padding number white space padding front ... ...","code":""},{"path":"https://davidbolin.github.io/ngme2/reference/print.ngme_noise.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Print ngme noise — print.ngme_noise","text":"list (noise specifications)","code":""},{"path":"https://davidbolin.github.io/ngme2/reference/simulate.ngme_model.html","id":null,"dir":"Reference","previous_headings":"","what":"Simulate latent process with noise — simulate.ngme_model","title":"Simulate latent process with noise — simulate.ngme_model","text":"Simulate latent process noise","code":""},{"path":"https://davidbolin.github.io/ngme2/reference/simulate.ngme_model.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Simulate latent process with noise — simulate.ngme_model","text":"","code":"# S3 method for ngme_model simulate(object, nsim = 1, seed = NULL, ...)"},{"path":"https://davidbolin.github.io/ngme2/reference/simulate.ngme_model.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Simulate latent process with noise — simulate.ngme_model","text":"object ngme model specified f() function nsim ignored seed seed ... ignored","code":""},{"path":"https://davidbolin.github.io/ngme2/reference/simulate.ngme_model.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Simulate latent process with noise — simulate.ngme_model","text":"realization latent model","code":""},{"path":"https://davidbolin.github.io/ngme2/reference/simulate.ngme_model.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Simulate latent process with noise — simulate.ngme_model","text":"","code":"B_sigma <- matrix(1:10 / 10, nrow=10) simulate(noise_nig(n = 10, B_sigma =  B_sigma)) #>  [1] -1.0598044  0.3485076  2.4727713  0.3999654  0.2014089 -0.5868434 #>  [7] -0.9860602 -0.4008164  1.4380547 -1.3272183 #> attr(,\"noise\") #> Noise type - nig #> Noise parameters:  #>     mu = 0 #>     sigma = 1 #>     nu = 1 simulate(noise_normal(theta_sigma = 1.5, B_sigma = B_sigma)) #>  [1] -0.08440917  0.47339511  0.23064347 -2.13824842  1.84096895 -1.43283697 #>  [7]  3.44292742 -2.30010966  2.93260253  6.15334823 #> attr(,\"noise\") #> Noise type - normal #> Noise parameters:  #>     sigma = 4.48 simulate(f(1:10, model = \"ar1\", theta_K = 0.4, noise = noise_nig())) #>  [1] -1.7048162 -1.5448182  0.4399346 -0.7192121 -1.1925356 -1.5338967 #>  [7] -0.5382841  1.2218557  0.5881045  1.1083624 #> attr(,\"noise\") #> Noise type - nig #> Noise parameters:  #>     mu = 0 #>     sigma = 1 #>     nu = 1"},{"path":"https://davidbolin.github.io/ngme2/reference/simulate.ngme_noise.html","id":null,"dir":"Reference","previous_headings":"","what":"Simulate ngme noise — simulate.ngme_noise","title":"Simulate ngme noise — simulate.ngme_noise","text":"Simulate ngme noise","code":""},{"path":"https://davidbolin.github.io/ngme2/reference/simulate.ngme_noise.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Simulate ngme noise — simulate.ngme_noise","text":"","code":"# S3 method for ngme_noise simulate(object, nsim = 1, seed = NULL, ...)"},{"path":"https://davidbolin.github.io/ngme2/reference/simulate.ngme_noise.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Simulate ngme noise — simulate.ngme_noise","text":"object ngme noise object nsim ignored seed seed ... ignored","code":""},{"path":"https://davidbolin.github.io/ngme2/reference/simulate.ngme_noise.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Simulate ngme noise — simulate.ngme_noise","text":"realization ngme noise","code":""},{"path":"https://davidbolin.github.io/ngme2/reference/simulate.ngme_noise.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Simulate ngme noise — simulate.ngme_noise","text":"","code":"simulate(noise_normal(sd = 5, n = 10)) #>  [1] -0.9360842 -0.8910483 -0.1967018  0.5927486 -1.3706702 -0.9177288 #>  [7]  1.8616387 -2.0512456  0.1133838 -0.4681682 #> attr(,\"noise\") #> Noise type - normal #> Noise parameters:  #>     sigma = 1"},{"path":"https://davidbolin.github.io/ngme2/reference/traceplot.html","id":null,"dir":"Reference","previous_headings":"","what":"Trace plot of ngme fitting — traceplot","title":"Trace plot of ngme fitting — traceplot","text":"Trace plot ngme fitting","code":""},{"path":"https://davidbolin.github.io/ngme2/reference/traceplot.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Trace plot of ngme fitting — traceplot","text":"","code":"traceplot(ngme, param, f_index = 0, param_index = 1, transform = identity)"},{"path":"https://davidbolin.github.io/ngme2/reference/traceplot.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Trace plot of ngme fitting — traceplot","text":"ngme ngme object param parameter name f_index index process, 0 stands fixed effects measurement noise param_index paramter index non-stationary transform transformation","code":""},{"path":"https://davidbolin.github.io/ngme2/reference/traceplot.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Trace plot of ngme fitting — traceplot","text":"traceplot","code":""},{"path":"https://davidbolin.github.io/ngme2/news/index.html","id":"ngme2-development-version","dir":"Changelog","previous_headings":"","what":"ngme2 (development version)","title":"ngme2 (development version)","text":"First version package","code":""}]
