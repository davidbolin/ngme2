---
title: "Ngme2 SPDE Matern model"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Ngme2 SPDE Matern model}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r setup, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
set.seed(11)
```

In this vignette, we will introduce the SPDE  model a few available models in `ngme2`.

## SPDE Matérn model

Several popular Gaussian random field models can be represented as solutions to stochastic partial differential equations (SPDEs) of the form
$$
L^\beta (\tau u) = \mathcal{W}.
$$
Here $\mathcal{W}$ is a Gaussian white noise, $L$ is a second-order differential operator, the fractional power $\beta > 0$ determines the smoothness of u. See [An explicit link between Gaussian fields and Gaussian Markov random fields: the stochastic partial differential equation approach](https://rss.onlinelibrary.wiley.com/doi/full/10.1111/j.1467-9868.2011.00777.x) for further details.

This package aims to address the non-Gaussian extension to the SPDE approach model by replacing the driven noise $\mathcal{W}$ to be a non-Gaussian noise $\mathcal{M}$.
More specificly, a type-G Lévy process.

The increment of a type-G Lévy process can be represented as
$$
\gamma + \mu V + \sigma \sqrt{V}Z,
$$
where $\gamma, \mu$ are parameters, $Z\sim N(0,1)$ and is independent of $V$, and $V$ is a positive infinitely divisible random variable.

One example is the normal inverse Gaussian (NIG) noise. (See `vignette("SPDE-approach", package = "ngme2")` for more details)

The `ngme2` usage for specify a spde Matérn model is (a spatial 2d example):

```{r}
library(INLA)
data(argo_float)
dim(argo_float)
head(argo_float)
loc <- argo_float[, 1:2]

# generate a INLA 2d mesh using INLA
mesh <- inla.mesh.2d(loc = loc,
                    max.edge = c(1, 5),
                    cutoff = 0.4,
                    offset = c(1,5))
plot(mesh)

# tell the model the location and the mesh to work with
model_matern(loc = loc, mesh = mesh)
```
